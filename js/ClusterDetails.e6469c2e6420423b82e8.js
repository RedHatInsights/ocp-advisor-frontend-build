"use strict";(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[619],{39697:(e,t,r)=>{r.r(t),r.d(t,{default:()=>$});var a=r(93264),n=r.n(a),l=r(36873),i=r(86896),o=r(86362),c=r(30893),s=r(45697),u=r.n(s),m=r(57361),d=r(84564),p=r(31369),f=r(48716),g=r(86350),v=r(7193),h=r(28058),y=r(44034),E=r(43),b=r(88292),Z=r(47778),k=r(56455),O=r(26899),P=r(73845),j=function(e){var t,r,a,l,o=e.clusterId,s=e.clusterData,u=e.displayName,d=(0,i.Z)(),p=u.isUninitialized,f=u.isFetching,g=u.data,v=s.isUninitialized,h=s.isFetching,y=s.data;return n().createElement(m.Grid,{id:"cluster-header",md:12,hasGutter:!0},n().createElement(m.GridItem,null,p||f?n().createElement(k.Z,{size:"sm"}):n().createElement(Z.Title,{size:"2xl",headingLevel:"h1",id:"cluster-header-title",ouiaId:"cluster-name"},g||o)),n().createElement(m.GridItem,null,n().createElement(b.Stack,null,n().createElement(b.StackItem,{id:"cluster-header-uuid"},n().createElement("span",null,"UUID: "),n().createElement("span",null,o||d.formatMessage(c.Z.unknown))),n().createElement(b.StackItem,{id:"cluster-header-last-seen"},n().createElement("span",null,d.formatMessage(c.Z.lastSeen),": "),n().createElement("span",null,v||h?n().createElement(P.F,null):null!=y&&null!==(t=y.report)&&void 0!==t&&null!==(r=t.meta)&&void 0!==r&&r.last_checked_at?n().createElement(O.Z,{date:null==y||null===(a=y.report)||void 0===a||null===(l=a.meta)||void 0===l?void 0:l.last_checked_at,type:"exact"}):d.formatMessage(c.Z.unknown))))))};j.propTypes={clusterId:u().string.isRequired,displayName:u().object.isRequired,clusterData:u().object.isRequired};const _=(0,y.xp)((function(e){var t=e.match.params.clusterId,r=(0,E.u)(t),a=(0,o.th)({id:t,includeDisabled:!1});return n().createElement(j,{clusterId:t,displayName:r,clusterData:a})}));var S=r(4942),w=r(93433),D=r(29439),I=r(44535),M=r(78216),W=r(30097),C=r(42319),R=r(56161),T=r(8045),F=r(48114),x=r(51957),N=r(59303),q=r(22663),z=r(52661);function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){(0,S.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var B=function(e){var t=e.report;return n().createElement("div",{className:"advisor"},n().createElement(q.Z,{appName:"advisor",module:"./AdvisorReportDetails",fallback:n().createElement(z.Z,null),report:G(G({},t),{},{details:t.extra_data,resolution:{resolution:t.resolution}})}))};B.propTypes={report:u().object.isRequired};const U=B;var V=r(90670),L=r(51014);function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){(0,S.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q=function(e){var t,r,l=e.reports,o=(0,i.Z)(),s=(0,a.useState)([]),u=(0,D.Z)(s,2),m=u[0],d=u[1],p=(0,a.useState)({}),f=(0,D.Z)(p,2),g=f[0],v=f[1],h=(0,a.useState)({}),y=(0,D.Z)(h,2),E=y[0],b=y[1],Z=(0,a.useState)(""),k=(0,D.Z)(Z,2),P=k[0],j=k[1],_=(0,a.useState)([]),q=(0,D.Z)(_,2),z=q[0],A=q[1],G=(0,a.useState)(!1),B=(0,D.Z)(G,2),H=B[0],Q=B[1],K=z?z.length/2:0,X=[{title:o.formatMessage(c.Z.description),transforms:[W.sortable]},{title:o.formatMessage(c.Z.added),transforms:[W.sortable,(0,W.cellWidth)(15)]},{title:o.formatMessage(c.Z.totalRisk),transforms:[W.sortable,(0,W.cellWidth)(15)]}],Y=function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=e.flatMap((function(e,l){var i=e,o=e.resolution,c=r.filter((function(e,t){return t%2==0&&e.rule.rule_id===i.rule_id&&e})),s=r.length?!!c.length&&c[0].isOpen:0===l,u=[{rule:i,resolution:o,isOpen:s,cells:[{title:n().createElement("div",null,i.description," ",n().createElement(V.Z,{rule:e}))},{title:n().createElement("div",{key:l},n().createElement(O.Z,{date:i.created_at,type:"relative",tooltipProps:{position:T.TooltipPosition.bottom}}))},{title:n().createElement("div",{key:l,style:{verticalAlign:"top"}},null!=i&&i.likelihood&&null!=i&&i.impact?n().createElement(T.Tooltip,{key:l,position:T.TooltipPosition.bottom,content:n().createElement("span",null,"The ",n().createElement("strong",null,"likelihood")," that this will be a problem is"," ",i.likelihood?N.FV[i.likelihood]:"unknown",". The ",n().createElement("strong",null,"impact")," of the problem would be"," ",i.impact?N.dz[i.impact]:"unknown"," ","if it occurred.")},n().createElement(M.Z,{value:i.total_risk})):n().createElement(M.Z,{value:i.total_risk}))}]},{parent:l,fullWidth:!0,cells:[{title:n().createElement(U,{key:"child-".concat(l),report:e})}]}],m=0===a.length||i.description.toLowerCase().includes(a.toLowerCase()),d=0===Object.keys(t).length||Object.keys(t).map((function(e){var r=t[e],a={created_at:i.created_at,total_risk:i.total_risk,category:i.tags};return"category"===e?a[e].find((function(e){return r.includes(String(N.kT[e]))})):r.find((function(t){return String(t)===String(a[e])}))})).every((function(e){return e}));return m&&d?u:[]}));return l.forEach((function(e,t){return e.parent?e.parent=t-1:null})),l},$=function(e,t){var r=t.length>0?J(J({},E),(0,S.Z)({},e,t)):function(e){var t=J({},E);return delete t[e],t}(e);A(Y(m,r,z,P)),b(r)},ee=[{label:"description",filterValues:{key:"text-filter",onChange:function(e,t){return function(e){var t=Y(m,E,z,e);j(e),A(t)}(t)},value:P}},{label:N.W2.total_risk.title,type:N.W2.total_risk.type,id:N.W2.total_risk.urlParam,value:"checkbox-".concat(N.W2.total_risk.urlParam),filterValues:{key:"".concat(N.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return $(N.W2.total_risk.urlParam,t)},value:E.total_risk,items:N.W2.total_risk.values}},{label:N.W2.category.title,type:N.W2.category.type,id:N.W2.category.urlParam,value:"checkbox-".concat(N.W2.category.urlParam),filterValues:{key:"".concat(N.W2.category.urlParam,"-filter"),onChange:function(e,t){return $(N.W2.category.urlParam,t)},value:E.category,items:N.W2.category.values}}],te={deleteTitle:o.formatMessage(c.Z.resetFilters),filters:(t=Object.entries(E),r=E&&t.length>0?t.map((function(e){var t=N.W2[e[0]],r=Array.isArray(e[1])?e[1].map((function(e){return{name:t.values.find((function(t){return t.value===String(e)})).label,value:e}})):[{name:t.values.find((function(t){return t.value===String(e[1])})).label,value:e[1]}];return{category:(0,C.capitalize)(t.title),chips:r,urlParam:t.urlParam}})):[],P.length>0&&r.push({category:"Description",chips:[{name:P,value:P}]}),r),onDelete:function(e,t,r){r?(A(Y(m,{},z,"")),b({}),j("")):t.map((function(e){"Description"===e.category?(A(Y(m,E,z,"")),j("")):$(e.urlParam,E[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})))}))}};return(0,a.useEffect)((function(){var e=l;d(e),A(Y(e,E,z,P))}),[]),n().createElement("div",{id:"cluster-recs-list-table"},n().createElement(F.Z,{expandAll:{isAllExpanded:H,onClick:function(e,t){Q(t);var r=(0,w.Z)(z);r.map((function(e){Object.prototype.hasOwnProperty.call(e,"isOpen")&&(e.isOpen=t)})),A(r)}},filterConfig:{items:ee,isDisabled:0===m.length},pagination:n().createElement(n().Fragment,null,1===K?"".concat(K," ").concat(o.formatMessage(c.Z.recommendation)):"".concat(K," ").concat(o.formatMessage(c.Z.recommendations))),activeFiltersConfig:0===m.length?void 0:te}),m.length>0?n().createElement(n().Fragment,null,n().createElement(W.Table,{"aria-label":"Cluster recommendations table",ouiaId:"recommendations",onCollapse:function(e,t,r){var a=(0,w.Z)(z);a[t]=J(J({},a[t]),{},{isOpen:r}),A(a)},rows:z,cells:X,sortBy:g,onSort:function(e,t,r){var a={1:"description",2:"created_at",3:"total_risk"},n=function(){return m.concat().sort((function(e,r){return e[a[t]]>r[a[t]]?1:r[a[t]]>e[a[t]]?-1:0}))},l=r===W.SortByDirection.asc?n():n().reverse();d(l),v({index:t,direction:r}),A(Y(l,E,z,P))},variant:W.TableVariant.compact,isStickyHeader:!0},n().createElement(W.TableHeader,null),n().createElement(W.TableBody,null)),0===K&&n().createElement(R.Card,{ouiaId:"empty-state"},n().createElement(R.CardBody,null,n().createElement(L.A0,null)))):n().createElement(R.Card,{ouiaId:"no-recommendations"},n().createElement(R.CardBody,null,n().createElement(x.Z,{icon:I.default,iconClass:"ins-c-insights__check",title:o.formatMessage(c.Z.noRecommendations),text:o.formatMessage(c.Z.noRecommendationsDesc)}))))};Q.propTypes={reports:u().array.isRequired},Q.defaultProps={reports:[]};const K=Q;var X=r(56276),Y=function(e){var t,r=e.cluster,a=e.displayName,l=e.match,o=(0,i.Z)(),s=r.isError,u=r.isUninitialized,y=r.isLoading,E=r.isFetching,b=r.isSuccess,Z=r.data,k=r.error,O=a.data;return n().createElement(n().Fragment,null,n().createElement(f.Z,{className:"pf-m-light ins-inventory-detail"},n().createElement(X.Z,{current:O||l.params.clusterId,match:l}),n().createElement(_,null)),(u||y||E)&&n().createElement(g.Z,{id:"loading-skeleton"},n().createElement(z.Z,null)),s&&(404===(null==k?void 0:k.status)?n().createElement(g.Z,null,n().createElement(x.Z,{title:o.formatMessage(c.Z.noRecsFoundError),text:n().createElement(n().Fragment,null,o.formatMessage(c.Z.noRecsFoundErrorDesc),n().createElement("a",{href:"https://docs.openshift.com/container-platform/latest/support/getting-support.html"}," ","OpenShift documentation.")),icon:p.default,iconStyle:{color:h.RJ.value},variant:"large"})):n().createElement(g.Z,null,n().createElement(x.Z,{title:o.formatMessage(c.Z.noRecsError),text:o.formatMessage(c.Z.noRecsErrorDesc),icon:d.default,iconStyle:{color:v.Q7.value}}))),b&&n().createElement(n().Fragment,null,n().createElement(g.Z,null,n().createElement(n().Fragment,null,n().createElement(m.Grid,{hasGutter:!0},n().createElement(m.GridItem,{span:12},n().createElement(K,{reports:(null==Z||null===(t=Z.report)||void 0===t?void 0:t.data)||[]})))))))};Y.propTypes={cluster:u().object.isRequired,displayName:u().object.isRequired,match:u().object.isRequired};const $=(0,l.Z)((function(e){var t=e.match,r=(0,i.Z)(),l=(0,o.th)({id:t.params.clusterId,includeDisabled:!1}),s=(0,E.u)(t.params.clusterId);return(0,a.useEffect)((function(){l.refetch()}),[t.params.clusterId]),(0,a.useEffect)((function(){if(t.params.clusterId){var e="".concat(t.params.clusterId," - ").concat(r.formatMessage(c.Z.clusters));document.title=r.formatMessage(c.Z.documentTitle,{subnav:e})}}),[t.params.clusterId]),n().createElement(Y,{cluster:l,displayName:s,match:t})}))}}]);
//# sourceMappingURL=../sourcemaps/ClusterDetails.3f5f1e1eef4a9ae025e3e705a2230715.js.map