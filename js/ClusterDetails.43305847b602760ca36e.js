"use strict";(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[619],{39697:(e,t,r)=>{r.r(t),r.d(t,{default:()=>le});var n=r(93264),a=r.n(n),l=r(36873),i=r(86896),o=r(86362),c=r(30893),s=r(45697),u=r.n(s),m=r(57361),d=r(84564),f=r(31369),p=r(48716),v=r(86350),g=r(7193),E=r(28058),y=r(44034),h=r(43),b=r(88292),Z=r(47778),k=r(56455),O=r(26899),P=r(73845),j=function(e){var t,r,n,l,o=e.clusterId,s=e.clusterData,u=e.displayName,d=(0,i.Z)(),f=u.isUninitialized,p=u.isFetching,v=u.data,g=s.isUninitialized,E=s.isFetching,y=s.data;return a().createElement(m.Grid,{id:"cluster-header",md:12,hasGutter:!0},a().createElement(m.GridItem,null,f||p?a().createElement(k.Z,{size:"sm"}):a().createElement(Z.Title,{size:"2xl",headingLevel:"h1",id:"cluster-header-title",ouiaId:"cluster-name"},v||o)),a().createElement(m.GridItem,null,a().createElement(b.Stack,null,a().createElement(b.StackItem,{id:"cluster-header-uuid"},a().createElement("span",null,"UUID: "),a().createElement("span",null,o||d.formatMessage(c.Z.unknown))),a().createElement(b.StackItem,{id:"cluster-header-last-seen"},a().createElement("span",null,d.formatMessage(c.Z.lastSeen),": "),a().createElement("span",null,g||E?a().createElement(P.F,null):null!=y&&null!==(t=y.report)&&void 0!==t&&null!==(r=t.meta)&&void 0!==r&&r.last_checked_at?a().createElement(O.Z,{date:null==y||null===(n=y.report)||void 0===n||null===(l=n.meta)||void 0===l?void 0:l.last_checked_at,type:"exact"}):d.formatMessage(c.Z.unknown))))))};j.propTypes={clusterId:u().string.isRequired,displayName:u().object.isRequired,clusterData:u().object.isRequired};const x=(0,y.xp)((function(e){var t=e.match.params.clusterId,r=(0,h.u)(t),n=(0,o.th)({id:t,includeDisabled:!1});return a().createElement(j,{clusterId:t,displayName:r,clusterData:n})}));var D=r(93433),I=r(4942),_=r(29439),S=r(16530),w=r(88931),R=r(48403),F=r.n(R),T=r(44535),W=r(78216),C=r(30097),M=r(56161),N=r(8045),q=r(48114),A=r(51957),G=r(59303),z=r(22663),B=r(52661);function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){(0,I.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var L=function(e){var t=e.report;return a().createElement("div",{className:"advisor"},a().createElement(z.Z,{appName:"advisor",module:"./AdvisorReportDetails",fallback:a().createElement(B.Z,null),report:V(V({},t),{},{details:t.extra_data,resolution:{resolution:t.resolution}})}))};L.propTypes={report:u().object.isRequired};const H=L;var J=r(90670),Q=r(51014),Y=r(76913),K=r(28672),X=r(48622);function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){(0,I.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var te=function(e){var t=e.reports,r=(0,i.Z)(),l=(0,w.useDispatch)(),o=function(e){return l((0,K.YR)(e))},s=(0,w.useSelector)((function(e){return e.filters.clusterRulesState})),u=(0,n.useState)([]),m=(0,_.Z)(u,2),d=m[0],f=m[1],p=(0,n.useState)([]),v=(0,_.Z)(p,2),g=v[0],E=v[1],y=(0,n.useState)(!1),h=(0,_.Z)(y,2),b=h[0],Z=h[1],k=(0,n.useState)(!0),P=(0,_.Z)(k,2),j=P[0],x=P[1],R=(0,n.useState)(""),z=(0,_.Z)(R,2),B=z[0],U=z[1],V=d.length,L=(0,S.useLocation)().search;(0,n.useEffect)((function(){E(re(d,s.sortIndex,s.sortDirection))}),[d,s.limit,s.offset,s.sortIndex,s.sortDirection]),(0,n.useEffect)((function(){f(te(t,s))}),[t,s]),(0,n.useEffect)((function(){if(L){var e=(0,Y.yG)(L);if(e.sort){var t=(0,Y.Lg)(e.sort[0]);e.sortIndex=G.P1.indexOf(t.name),e.sortDirection=t.direction}e.first&&(U(e.first),delete e.first),o(ee(ee({},s),e))}}),[]);var $,te=function(e,t){return e.filter((function(e){return(0,Y._F)(e,t)})).map((function(e,t){return[{rule:e,isOpen:b,cells:[{title:a().createElement("div",null,(null==e?void 0:e.description)||(null==e?void 0:e.rule_id)," ",a().createElement(J.Z,{rule:e}))},{title:a().createElement("div",{key:t},a().createElement(O.Z,{date:e.created_at,type:"relative",tooltipProps:{position:N.TooltipPosition.bottom}}))},{title:a().createElement("div",{key:t,style:{verticalAlign:"top"}},null!=e&&e.likelihood&&null!=e&&e.impact?a().createElement(N.Tooltip,{key:t,position:N.TooltipPosition.bottom,content:a().createElement("span",null,"The ",a().createElement("strong",null,"likelihood")," that this will be a problem is"," ",e.likelihood?G.FV[e.likelihood]:"unknown",".The ",a().createElement("strong",null,"impact")," of the problem would be"," ",e.impact?G.dz[e.impact]:"unknown"," ","if it occurred.")},a().createElement(W.Z,{value:e.total_risk})):a().createElement(W.Z,{value:e.total_risk}))}]},{fullWidth:!0,cells:[{title:a().createElement(H,{key:"child-".concat(t),report:e})}]}]}))},re=function(e,t,r){var n=(0,D.Z)(e);if(t>=0)n=(0,D.Z)(e).sort((function(e,r){var n=e[0].rule[G.P1[t-1]],a=r[0].rule[G.P1[t-1]];return n>a?1:a>n?-1:0})),r===C.SortByDirection.desc&&n.reverse();else if(B){var a=e.findIndex((function(e){var t=e[0].rule;return t.rule_id.split(".report")[0]===(0,X.Nq)(B)&&t.extra_data.error_key===(0,X.o6)(B)}));-1!==a&&n.unshift(n.splice(a,1)[0])}return n.flatMap((function(e,t){var r=(0,D.Z)(e);return j&&0===t&&(e[0].isOpen=!0),e[1].parent=2*t,r}))},ne=function(e){var t=ee(ee({},s),{},{offset:0});delete t[e],o(ee(ee({},t),"text"===e?{text:""}:{}))},ae=function(e,t){return x(!1),U(""),t.length>0?o(ee(ee({},s),{},{offset:0},(0,I.Z)({},e,t))):ne(e)},le=[{label:"description",filterValues:{key:"text-filter",onChange:function(e,t){return ae("text",t)},value:s.text}},{label:G.W2.total_risk.title,type:G.W2.total_risk.type,id:G.W2.total_risk.urlParam,value:"checkbox-".concat(G.W2.total_risk.urlParam),filterValues:{key:"".concat(G.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return ae(G.W2.total_risk.urlParam,t)},value:s.total_risk,items:G.W2.total_risk.values}},{label:G.W2.category.title,type:G.W2.category.type,id:G.W2.category.urlParam,value:"checkbox-".concat(G.W2.category.urlParam),filterValues:{key:"".concat(G.W2.category.urlParam,"-filter"),onChange:function(e,t){return ae(G.W2.category.urlParam,t)},value:s.category,items:G.W2.category.values}}],ie={deleteTitle:r.formatMessage(c.Z.resetFilters),filters:($=ee({},s),delete $.sortIndex,delete $.sortDirection,delete $.offset,delete $.limit,function(e,t){var r=Object.entries(e);return r.length>0?r.reduce((function(e,r){if(t[r[0]]){var n=t[r[0]],a=Array.isArray(r[1])?r[1].map((function(e){var t=n.values.find((function(t){return t.value===String(e)}));return t?{name:t.text||t.label,value:e}:{name:e,value:e}})):[{name:n.values.find((function(e){return e.value===String(r[1])})).label,value:r[1]}];return[].concat((0,D.Z)(e),[{category:F()(n.title),chips:a,urlParam:n.urlParam}])}return"text"===r[0]?[].concat((0,D.Z)(e),(0,D.Z)(r[1].length>0?[{category:"Name",chips:[{name:r[1],value:r[1]}],urlParam:r[0]}]:[])):e}),[]):[]}($,G.W2)),onDelete:function(e,t,r){r?o(K.OF):t.map((function(e){var t=(0,I.Z)({},e.urlParam,Array.isArray(s[e.urlParam])?s[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?o(ee(ee({},s),t)):ne(e.urlParam)}))}};return a().createElement("div",{id:"cluster-recs-list-table"},a().createElement(q.Z,{expandAll:{isAllExpanded:b,onClick:function(e,t){Z(t),E(g.map((function(e){return ee(ee({},e),{},{isOpen:t})})))}},filterConfig:{items:le,isDisabled:0===d.length},pagination:a().createElement(a().Fragment,null,1===V?"".concat(V," ").concat(r.formatMessage(c.Z.recommendation)):"".concat(V," ").concat(r.formatMessage(c.Z.recommendations))),activeFiltersConfig:0===t.length?void 0:ie}),t.length>0?a().createElement(a().Fragment,null,a().createElement(C.Table,{"aria-label":"Cluster recommendations table",ouiaId:"recommendations",onCollapse:function(e,t,r){var n=(0,D.Z)(g);n[t]=ee(ee({},n[t]),{},{isOpen:r}),E(n)},rows:g,cells:G.d3,sortBy:{index:s.sortIndex,direction:s.sortDirection},onSort:function(e,t,r){return o(ee(ee({},s),{},{sortIndex:t,sortDirection:r}))},variant:C.TableVariant.compact,isStickyHeader:!0},a().createElement(C.TableHeader,null),a().createElement(C.TableBody,null)),0===V&&a().createElement(M.Card,{ouiaId:"empty-state"},a().createElement(M.CardBody,null,a().createElement(Q.A0,null)))):a().createElement(M.Card,{ouiaId:"no-recommendations"},a().createElement(M.CardBody,null,a().createElement(A.Z,{icon:T.default,iconClass:"ins-c-insights__check",title:r.formatMessage(c.Z.noRecommendations),text:r.formatMessage(c.Z.noRecommendationsDesc)}))))};te.propTypes={reports:u().array.isRequired},te.defaultProps={reports:[]};const re=te;var ne=r(56276),ae=function(e){var t,r=e.cluster,n=e.displayName,l=e.match,o=(0,i.Z)(),s=r.isError,u=r.isUninitialized,y=r.isLoading,h=r.isFetching,b=r.isSuccess,Z=r.data,k=r.error,O=n.data;return a().createElement(a().Fragment,null,a().createElement(p.Z,{className:"pf-m-light ins-inventory-detail"},a().createElement(ne.Z,{current:O||l.params.clusterId,match:l}),a().createElement(x,null)),(u||y||h)&&a().createElement(v.Z,{id:"loading-skeleton"},a().createElement(B.Z,null)),s&&(404===(null==k?void 0:k.status)?a().createElement(v.Z,null,a().createElement(A.Z,{title:o.formatMessage(c.Z.noRecsFoundError),text:a().createElement(a().Fragment,null,o.formatMessage(c.Z.noRecsFoundErrorDesc),a().createElement("a",{href:"https://docs.openshift.com/container-platform/latest/support/getting-support.html"}," ","OpenShift documentation.")),icon:f.default,iconStyle:{color:E.RJ.value},variant:"large"})):a().createElement(v.Z,null,a().createElement(A.Z,{title:o.formatMessage(c.Z.noRecsError),text:o.formatMessage(c.Z.noRecsErrorDesc),icon:d.default,iconStyle:{color:g.Q7.value}}))),b&&a().createElement(a().Fragment,null,a().createElement(v.Z,null,a().createElement(a().Fragment,null,a().createElement(m.Grid,{hasGutter:!0},a().createElement(m.GridItem,{span:12},a().createElement(re,{reports:(null==Z||null===(t=Z.report)||void 0===t?void 0:t.data)||[]})))))))};ae.propTypes={cluster:u().object.isRequired,displayName:u().object.isRequired,match:u().object.isRequired};const le=(0,l.Z)((function(e){var t=e.match,r=(0,i.Z)(),l=(0,o.th)({id:t.params.clusterId,includeDisabled:!1}),s=(0,h.u)(t.params.clusterId);return(0,n.useEffect)((function(){l.refetch()}),[t.params.clusterId]),(0,n.useEffect)((function(){if(t.params.clusterId){var e="".concat(t.params.clusterId," - ").concat(r.formatMessage(c.Z.clusters));document.title=r.formatMessage(c.Z.documentTitle,{subnav:e})}}),[t.params.clusterId]),a().createElement(ae,{cluster:l,displayName:s,match:t})}))}}]);
//# sourceMappingURL=../sourcemaps/ClusterDetails.56ac10d53553186078a43bd0394b48a0.js.map