(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[384],{90670:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var a=r(76004),n=r(23218),i=r(45697),l=r.n(i),o=r(28416),s=r.n(o),c=r(86896),u=r(30893),m=function(e){var t=e.rule,r=(0,c.Z)();return s().createElement(s().Fragment,null,t.disabled&&s().createElement(a.Tooltip,{content:r.formatMessage(u.Z.ruleIsDisabledTooltip),position:a.TooltipPosition.right},s().createElement(n.Label,{color:"gray",isCompact:!0},r.formatMessage(u.Z.disabled))))};m.propTypes={rule:l().object};const f=m},73451:(e,t,r)=>{"use strict";r.d(t,{Z:()=>P});var a=r(15861),n=r(70885),i=r(64687),l=r.n(i),o=r(28416),s=r.n(o),c=r(86896),u=r(45697),m=r.n(u),f=r(86706),d=r(6202),p=r(32752),g=r(4853),v=r(23811),b=r(78826),k=r(12282),y=r(71355),h=r(30893),Z=r(77647),_=function(e){var t=e.isModalOpen,r=e.handleModalToggle,i=e.rule,u=e.afterFn,m=e.host,_=e.hosts,P=(0,c.Z)(),E=(0,o.useState)(""),W=(0,n.Z)(E,2),x=W[0],C=W[1],M=(0,o.useState)(!!m),S=(0,n.Z)(M,2),D=S[0],w=S[1],O=(0,o.useState)(_.length>0),j=(0,n.Z)(O,2),T=j[0],I=j[1],A=(0,Z.om)(),R=(0,n.Z)(A,1)[0],F=(0,f.useDispatch)(),L=function(e){return F((0,y.addNotification)(e))},N=function(){var e=(0,a.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=_.map((function(e){return(0,Z.Dg)({uuid:e.id,recId:i.rule_id,justification:x})})),e.next=4,Promise.all(t);case 4:L({variant:"success",dismissable:!0,timeout:!0,title:P.formatMessage(h.Z.recSuccessfullyDisabledForCluster)}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),L({variant:"danger",dismissable:!0,title:P.formatMessage(h.Z.error),description:"".concat(e.t0)});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,a.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!D){e.next=7;break}return e.next=4,(0,Z.Dg)({uuid:m,recId:i.rule_id,justification:x});case 4:L({variant:"success",timeout:!0,dismissable:!0,title:P.formatMessage(h.Z.recSuccessfullyDisabledForCluster)}),e.next=14;break;case 7:if(!T){e.next=11;break}N(),e.next=14;break;case 11:return e.next=13,R({rule_id:i.rule_id,justification:x}).unwrap();case 13:L({variant:"success",timeout:!0,dismissable:!0,title:P.formatMessage(h.Z.recSuccessfullyDisabled)});case 14:C(""),u&&u(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),L({variant:"danger",dismissable:!0,title:P.formatMessage(h.Z.error),description:"".concat(e.t0)});case 21:r(!1);case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();return s().createElement(b.u_,{variant:"small",title:P.formatMessage(h.Z.disableRule),isOpen:t,onClose:function(){r(),C("")},actions:[s().createElement(d.Button,{key:"confirm",variant:"primary",onClick:function(){return V()},ouiaId:"confirm"},P.formatMessage(h.Z.save)),s().createElement(d.Button,{key:"cancel",variant:"link",onClick:function(){r(!1),C("")},ouiaId:"cancel"},P.formatMessage(h.Z.cancel))],ouiaId:"recommendation-disable"},P.formatMessage(h.Z.disableRuleBody),s().createElement(g.l,null,s().createElement(v.c,{fieldId:"blank-form"}),(m||_.length>0)&&s().createElement(v.c,{fieldId:"disable-rule-one-system"},s().createElement(p.Checkbox,{isChecked:D||T,onChange:function(){m?w(!D):I(!T)},label:m?P.formatMessage(h.Z.disableRuleSingleCluster):P.formatMessage(h.Z.disableRuleForClusters),id:"disable-rule-one-system",name:"disable-rule-one-system",ouiaId:"disable-recommendation-one-cluster"})),s().createElement(v.c,{label:P.formatMessage(h.Z.justificationNote),fieldId:"disable-rule-justification"},s().createElement(k.TextInput,{type:"text",id:"disable-rule-justification","aria-describedby":"disable-rule-justification",value:x,onChange:function(e,t){return C(t)},onKeyDown:function(e){return"Enter"===e.key&&(e.preventDefault(),V())}}))))};_.propTypes={isModalOpen:m().bool,rule:m().object,handleModalToggle:m().func,afterFn:m().func,host:m().object,hosts:m().array},_.defaultProps={isModalOpen:!1,rule:{},handleModalToggle:function(){},afterFn:function(){},host:void 0,hosts:[]};const P=_},49246:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>de});var a=r(28416),n=r.n(a),i=r(15861),l=r(42982),o=r(87462),s=r(4942),c=r(70885),u=r(64687),m=r.n(u),f=r(86706),d=r(86896),p=r(62012),g=r(45697),v=r.n(g),b=r(48403),k=r.n(b),y=r(64420),h=r(35981),Z=r(49004),_=r(58027),P=r(13877),E=r(81159),W=r(76004),x=r(8045),C=r(18446),M=r.n(C),S=r(62410),D=r(90693),w=r(90111),O=r.n(w),j=r(71355),T=r(59303),I=r(30893),A=r(28672),R=r(90670),F=r(28186),L=r(5391),N=r(51014),V=r(76913),q=r(73451),B=r(71094),G=r(86362),H=r(68929),U=r.n(H),X=r(23218),z=r(23216),K=r(5569),Q=r(83898),Y=r(82727),J=r(66095),$=r(70798),ee={security:n().createElement(K.ZP,null),service_availability:n().createElement(Y.ZP,null),performance:n().createElement(Q.ZP,null),fault_tolerance:n().createElement(J.ZP,null),best_practice:n().createElement($.ZP,null)},te=function(e){return e.filter((function(e){return Object.keys(T.kT).includes(e)}))},re=function(e){var t=e.tags,r=(0,d.Z)();return n().createElement(z.e,{numLabels:1,isCompact:!0},te(t).map((function(e,t){return n().createElement(X.Label,{key:t,icon:ee[e],variant:"outline",color:"blue",isCompact:!0},r.formatMessage(I.Z[U()(e)]))})))};re.propTypes={tags:v().array.isRequired};const ae=re;var ne=r(58490),ie=r(48622),le=r(52661),oe=r(94174),se=r.n(oe),ce=r(60076);function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fe=function(e){var t=e.query,r=(0,d.Z)(),u=(0,f.useDispatch)(),g=(0,f.useSelector)((function(e){return e.filters.recsListState})),v=t.isError,b=t.isUninitialized,C=t.isFetching,w=t.isSuccess,H=t.data,U=t.refetch,X=(null==H?void 0:H.recommendations)||[],z=g.offset/g.limit+1,K=(0,a.useState)([]),Q=(0,c.Z)(K,2),Y=Q[0],J=Q[1],$=(0,a.useState)([]),ee=(0,c.Z)($,2),re=ee[0],oe=ee[1],ue=(0,a.useState)(!1),fe=(0,c.Z)(ue,2),de=fe[0],pe=fe[1],ge=(0,a.useState)({}),ve=(0,c.Z)(ge,2),be=ve[0],ke=ve[1],ye=(0,a.useState)(!1),he=(0,c.Z)(ye,2),Ze=he[0],_e=he[1],Pe=function(e){return u((0,j.addNotification)(e))},Ee=(0,p.useLocation)().search,We=(0,a.useState)(!0),xe=(0,c.Z)(We,2),Ce=xe[0],Me=xe[1],Se=(0,a.useState)(!1),De=(0,c.Z)(Se,2),we=De[0],Oe=De[1],je=function(e){return u((0,A.Q4)(e))},Te=(null==g?void 0:g.text)||"",Ie=b||C||!we,Ae=v||w&&0===X.length,Re=w&&X.length>0,Fe=X.length>0&&0===Y.length,Le=function(e,t){return(0,V.Lv)(g,je,e,t)};(0,a.useEffect)((function(){oe(qe(Y,g.sortIndex,g.sortDirection)),Oe(!0)}),[Y,g.limit,g.offset,g.sortIndex,g.sortDirection]),(0,a.useEffect)((function(){var e=Ve(X,g);e.length&&e.length<=g.offset&&je(me(me({},g),{},{offset:0})),J(e)}),[H,g.category,g.impact,g.impacting,g.total_risk,g.rule_status,g.likelihood,g.res_risk,Te]),(0,a.useEffect)((function(){if(Ee&&Ce){var e=(0,V.yG)(Ee);if(e.sort){var t=(0,V.Lg)(e.sort);e.sortIndex=T.Ax.indexOf(t.name),e.sortDirection=t.direction}e.offset&&(e.offset=Number(e.offset[0])),e.limit&&(e.limit=Number(e.limit[0])),e.impacting&&!Array.isArray(e.impacting)&&(e.impacting=["".concat(e.impacting)]),je(me(me({},g),e))}Me(!1)}),[]),(0,a.useEffect)((function(){Ce||(0,V.aM)(g,T.Ax)}),[g,Ce]);var Ne,Ve=function(e,t){return Oe(!1),e.filter((function(e){return(0,V._F)(e,t)})).map((function(e,t){return[{isOpen:Ze,rule:e,cells:[{title:n().createElement("span",{key:t},n().createElement(p.Link,{key:t,to:"".concat(ce.G,"/recommendations/").concat(e.rule_id)}," ",(null==e?void 0:e.description)||(null==e?void 0:e.rule_id)," "),n().createElement(R.Z,{rule:e}))},{title:null!=e&&e.publish_date?n().createElement(S.Z,{key:t,date:e.publish_date,variant:"relative"}):r.formatMessage(I.Z.nA)},{title:n().createElement(ae,{key:t,tags:e.tags})},{title:n().createElement("div",{key:t},n().createElement(W.Tooltip,{key:t,position:x.TooltipPosition.bottom,content:r.formatMessage(I.Z.rulesDetailsTotalRiskBody,{risk:T.Nq[e.total_risk]||r.formatMessage(I.Z.undefined),strong:L.f})},null!=e&&e.total_risk?n().createElement(D.Z,{value:e.total_risk,rest:{isCompact:!0}}):r.formatMessage(I.Z.nA)))},{title:se()(null==e?void 0:e.resolution_risk,1,5)?n().createElement(D.Z,{value:e.resolution_risk,rest:{isCompact:!0},text:T.MS[e.resolution_risk],hideIcon:!0}):r.formatMessage(I.Z.nA)},{title:n().createElement("div",{key:t},"".concat(void 0!==(null==e?void 0:e.impacted_clusters_count)?e.impacted_clusters_count.toLocaleString():r.formatMessage(I.Z.nA)))}]},{fullWidth:!0,cells:[{title:n().createElement("section",{className:"pf-l-page__main-section pf-c-page__main-section pf-m-light"},n().createElement(E.K,{hasGutter:!0},n().createElement(ne.Ii,(0,o.Z)({messages:(0,F.k5)(r,ne.TO,(0,F.jL)(r,(0,ie.hw)(e))),product:ne.D1.ocp,rule:(0,ie.hw)(e),isDetailsPage:!1,showViewAffected:!0,linkComponent:p.Link},se()(null==e?void 0:e.resolution_risk,1,5)?{resolutionRisk:null==e?void 0:e.resolution_risk,resolutionRiskDesc:T.wY[null==e?void 0:e.resolution_risk]}:{}))))}]}]}))},qe=function(e,t,r){return(0,l.Z)(e).sort((function(e,a){var n=e[0].rule,i=a[0].rule,l=r===y.SortByDirection.asc?1:-1;switch(t){case T.WC:return n=n.description,i=i.description,n.localeCompare(i)?n.localeCompare(i)*l:0;case T.sA:return(n=new Date(n.publish_date||0))>(i=new Date(i.publish_date||0))?l:i>n?-l:0;case T.UX:return l*te(n.tags)[0].localeCompare(te(i.tags)[0]);case T.MV:return(n=n.total_risk)>(i=i.total_risk)?l:i>n?-l:0;case T.jp:return(n=n.resolution_risk)>(i=i.resolution_risk)?l:i>n?-l:0;case T.kZ:return(n=n.impacted_clusters_count)>(i=i.impacted_clusters_count)?l:i>n?-l:0;default:console.error("Incorrect sorting parameters received")}})).slice(g.limit*(z-1),g.limit*(z-1)+g.limit).flatMap((function(e,t){var r=(0,l.Z)(e);return e[1].parent=2*t,r}))},Be=[{label:r.formatMessage(I.Z.name).toLowerCase(),type:"text",filterValues:{key:"text-filter",onChange:function(e,t){return je(me(me({},g),{},{offset:0,text:t}))},value:Te,placeholder:r.formatMessage(I.Z.filterByName)}},{label:T.W2.total_risk.title,type:T.W2.total_risk.type,id:T.W2.total_risk.urlParam,value:"checkbox-".concat(T.W2.total_risk.urlParam),filterValues:{key:"".concat(T.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return Le(T.W2.total_risk.urlParam,t)},value:g.total_risk,items:T.W2.total_risk.values}},{label:T.W2.impact.title,type:T.W2.impact.type,id:T.W2.impact.urlParam,value:"checkbox-".concat(T.W2.impact.urlParam),filterValues:{key:"".concat(T.W2.impact.urlParam,"-filter"),onChange:function(e,t){return Le(T.W2.impact.urlParam,t)},value:g.impact,items:T.W2.impact.values}},{label:T.W2.likelihood.title,type:T.W2.likelihood.type,id:T.W2.likelihood.urlParam,value:"checkbox-".concat(T.W2.likelihood.urlParam),filterValues:{key:"".concat(T.W2.likelihood.urlParam,"-filter"),onChange:function(e,t){return Le(T.W2.likelihood.urlParam,t)},value:g.likelihood,items:T.W2.likelihood.values}},{label:T.W2.category.title,type:T.W2.category.type,id:T.W2.category.urlParam,value:"checkbox-".concat(T.W2.category.urlParam),filterValues:{key:"".concat(T.W2.category.urlParam,"-filter"),onChange:function(e,t){return Le(T.W2.category.urlParam,t)},value:g.category,items:T.W2.category.values}},{label:T.W2.rule_status.title,type:T.W2.rule_status.type,id:T.W2.rule_status.urlParam,value:"radio-".concat(T.W2.rule_status.urlParam),filterValues:{key:"".concat(T.W2.rule_status.urlParam,"-filter"),onChange:function(e,t){return r=t,je(me(me({},g),{},{rule_status:r,offset:0}));var r},value:"".concat(g.rule_status),items:T.W2.rule_status.values}},{label:T.W2.impacting.title,type:T.W2.impacting.type,id:T.W2.impacting.urlParam,value:"checkbox-".concat(T.W2.impacting.urlParam),filterValues:{key:"".concat(T.W2.impacting.urlParam,"-filter"),onChange:function(e,t){return Le(T.W2.impacting.urlParam,t)},value:g.impacting,items:T.W2.impacting.values}},{label:T.W2.res_risk.title,type:T.W2.res_risk.type,id:T.W2.res_risk.urlParam,value:"checkbox-".concat(T.W2.res_risk.urlParam),filterValues:{key:"".concat(T.W2.res_risk.urlParam,"-filter"),onChange:function(e,t){return Le(T.W2.res_risk.urlParam,t)},value:g.res_risk,items:T.W2.res_risk.values}}],Ge={showDeleteButton:!0,deleteTitle:r.formatMessage(I.Z.resetFilters),filters:(Ne=me({},g),delete Ne.sortIndex,delete Ne.sortDirection,delete Ne.offset,delete Ne.limit,function(e,t){var r=Object.entries(e);return r.length>0?r.reduce((function(e,r){if(t[r[0]]){var a=t[r[0]],n=Array.isArray(r[1])?r[1].map((function(e){var t=a.values.find((function(t){return t.value===String(e)}));return t?{name:t.text||t.label,value:e}:{name:e,value:e}})):[{name:a.values.find((function(e){return e.value===String(r[1])})).label,value:r[1]}];return[].concat((0,l.Z)(e),[{category:k()(a.title),chips:n,urlParam:a.urlParam}])}return"text"===r[0]?[].concat((0,l.Z)(e),(0,l.Z)(r[1].length>0?[{category:"Name",chips:[{name:r[1],value:r[1]}],urlParam:r[0]}]:[])):e}),[]):[]}(Ne,T.W2)),onDelete:function(e,t,r){r?M()(g,A.CH)?U():(0,A.aw)(g,A.CH,je):t.map((function(e){var t,r=(0,s.Z)({},e.urlParam,Array.isArray(g[e.urlParam])?g[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");r[e.urlParam].length>0?je(me(me({},g),r)):(t=e.urlParam,(0,V.oo)(g,je,t))}))}},He=function(){var e=(0,i.Z)(m().mark((function e(t){var a;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=re[t].rule,e.prev=1,a.disabled){e.next=7;break}ke(a),pe(!0),e.next=17;break;case 7:return e.prev=7,e.next=10,(0,B.HG)("".concat(G._n,"/v2/ack/").concat(a.rule_id));case 10:Pe({variant:"success",timeout:!0,dismissable:!0,title:r.formatMessage(I.Z.recSuccessfullyEnabled)}),U(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),Pe({variant:"danger",dismissable:!0,title:r.formatMessage(I.Z.error),description:"".concat(e.t0)});case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(1),Pe({variant:"danger",dismissable:!0,title:a.disabled?r.formatMessage(I.Z.rulesTableErrorEnabled):r.formatMessage(I.Z.rulesTableErrorDisabled),description:"".concat(e.t1)});case 22:case"end":return e.stop()}}),e,null,[[1,19],[7,14]])})));return function(t){return e.apply(this,arguments)}}();return n().createElement("div",{id:"recs-list-table","data-ouia-safe":!Ie},de&&n().createElement(q.Z,{handleModalToggle:pe,isModalOpen:de,rule:be,afterFn:U}),n().createElement(O(),{pagination:{itemCount:Y.length,page:g.offset/g.limit+1,perPage:Number(g.limit),onSetPage:function(e,t){Oe(!1),je(me(me({},g),{},{offset:g.limit*(t-1)}))},onPerPageSelect:function(e,t){Oe(!1),je(me(me({},g),{},{limit:t,offset:0}))},isCompact:!0,ouiaId:"pager"},filterConfig:{items:Be,isDisabled:Ie||Ae},activeFiltersConfig:Ae?void 0:Ge}),n().createElement(h.i,{"aria-label":"Table of recommendations",ouiaId:"recommendations",variant:y.TableVariant.compact,cells:T.XT,rows:Ae||Ie||Fe?[{fullWidth:!0,cells:[{props:{colSpan:T.XT.length+1},title:Ae?n().createElement(N.Te,null):Ie?n().createElement(le.Z,null):n().createElement(N.A0,null)}]}]:Re?re:n().createElement(N.Te,null),onCollapse:function(e,t,r){void 0===t?(_e(r),oe(re.map((function(e){return me(me({},e),{},{isOpen:r})})))):oe(re.map((function(e,a){return a===t?me(me({},e),{},{isOpen:r}):e})))},sortBy:{index:g.sortIndex,direction:g.sortDirection},onSort:function(e,t,r){return Oe(!1),je(me(me({},g),{},{sortIndex:t,sortDirection:r}))},actionResolver:function(e,t){var a,n=t.rowIndex,i=null!=re&&null!==(a=re[n])&&void 0!==a&&a.rule?re[n].rule:null;return n%2==0&&i?i&&!i.disabled?[{title:r.formatMessage(I.Z.disableRule),onClick:function(e,t){return He(t)}}]:[{title:r.formatMessage(I.Z.enableRule),onClick:function(e,t){return He(t)}}]:null},isStickyHeader:!0,ouiaSafe:!Ie,canCollapseAll:!0},n().createElement(Z.x,null),n().createElement(_.R,null)),n().createElement(P.tl,{ouiaId:"pager",itemCount:Y.length,page:g.offset/g.limit+1,perPage:Number(g.limit),onSetPage:function(e,t){return je(me(me({},g),{},{offset:g.limit*(t-1)}))},onPerPageSelect:function(e,t){return je(me(me({},g),{},{limit:t,offset:0}))},widgetId:"pagination-options-menu-bottom",variant:P.aM.bottom}))};fe.propTypes={query:v().shape({isError:v().bool.isRequired,isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,isSuccess:v().bool.isRequired,data:v().object,refetch:v().func})};const de=function(){var e=(0,G.Bs)();return n().createElement(fe,{query:e})}},70347:()=>{},78752:()=>{},24620:()=>{},82014:()=>{},25238:()=>{},53336:()=>{},38299:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/RulesTable.3585bfea97c95735471d79f7449e23ed.js.map