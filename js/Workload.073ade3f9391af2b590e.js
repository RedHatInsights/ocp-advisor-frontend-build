(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[2339],{56276:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var n=a(92950),r=a.n(n),l=a(45697),s=a.n(l),i=a(86896),c=a(62012),o=a(85991),d=a(49489),u=a(30893),m=function(e){var t=e.current,a=(0,i.Z)(),n=(0,c.useLocation)().pathname.split("/");return r().createElement("div",null,r().createElement(o.a,{ouiaId:"detail"},r().createElement(d.g,{className:"breadcrumb-item"},r().createElement(c.Link,{to:"..",relative:"path"},"".concat(a.formatMessage(u.Z.insightsHeader)," ").concat(n[4]))),r().createElement(d.g,{className:"breadcrumb-item",isActive:!0},t)))};m.propTypes={current:s().string};const p=m},49872:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ne});var n=a(92950),r=a.n(n),l=a(89376),s=a(36001),i=a(42057),c=a(29572),o=a(34348),d=a(56276),u=a(49287),m=a(18038),p=a(81159),E=a(34023),f=a(35664),g=a(73845),h=a(62410),v=a(45697),b=a.n(v),y=function(e){var t,a=e.workloadData,n=e.namespaceId,l=e.clusterId,s=a.isUninitialized,i=a.isFetching,c=a.data;return r().createElement(u.r,{id:"workload-header",md:12,hasGutter:!0},r().createElement(m.P,{span:8},r().createElement(o.Dx,{size:"2xl",headingLevel:"h1",id:"cluster-header-title",ouiaId:"cluster-name"},s||i?r().createElement(r().Fragment,null,r().createElement(f.Z,{size:"sm"}),r().createElement(f.Z,{size:"sm"})):r().createElement(r().Fragment,null,r().createElement("p",null,c.cluster.display_name),r().createElement("p",null,c.namespace.name)))),r().createElement(m.P,null,r().createElement(p.K,null,r().createElement(E.v,{id:"workload-header-uuid"},r().createElement("span",null,"Cluster UUID:")," ",r().createElement("span",null,l)," ",r().createElement("span",null,"Namespace UUID:")," ",r().createElement("span",null,n)),r().createElement(E.v,{id:"workload-header-last-seen"},r().createElement("span",null,"Last seen: "),r().createElement("span",null,s||i?r().createElement(g.F,null):null!=c&&null!==(t=c.metadata)&&void 0!==t&&t.last_checked_at?r().createElement(h.Z,{date:c.metadata.last_checked_at,type:"exact"}):r().createElement(r().Fragment,null,"Unknown"))))))};y.propTypes={clusterId:b().string.isRequired,namespaceId:b().string.isRequired,workloadData:b().shape({isUninitialized:b().bool.isRequired,isFetching:b().bool.isRequired,data:b().shape({namespace:b().shape({uuid:b().string,name:b().string}),cluster:b().shape({uuid:b().string,display_name:b().string}),status:b().string})})};var k=a(62012),w=a(86362);const I=function(){var e=(0,k.useParams)(),t=e.namespaceId,a=e.clusterId,n=(0,w.k0)({namespaceId:t,clusterId:a});return r().createElement(y,{workloadData:n,namespaceId:t,clusterId:a})};var C=a(4942),O=a(70885),D=a(15509),P=a(56021),_=a(59303),Z=a(52661),j=a(51014),R=a(90693),T=a(1792),S=a(31369),x=a(61088),q=a(6202),N=a(2095),F=a(85962),U=a(21015),B=a(95061),H=a(84556),L=a(55471),z=a.n(L),A="Object ID",W="Kind",K=function(e){var t=e.more_info,a=e.resolution,n=e.objects;return r().createElement(N.Card,{className:"ins-c-report-details",style:{boxShadow:"none"}},r().createElement(F.CardBody,null,r().createElement(p.K,{className:"ins-c-report-details__cards-stack","widget-type":"InsightsRulesCard",hasGutter:!0},r().createElement(E.v,null,r().createElement(N.Card,{isCompact:!0,isPlain:!0},r().createElement(U.CardHeader,null,r().createElement(T.ZP,{className:"ins-c-report-details__icon"}),r().createElement("strong",null,"Detected issues")),r().createElement(F.CardBody,null,"This should be a reason field and extradata should provide us an array of reasons to list here"))),r().createElement(H.Divider,null),r().createElement(E.v,null,r().createElement(N.Card,{isCompact:!0,isPlain:!0},r().createElement(U.CardHeader,null,r().createElement(x.ZP,{className:"ins-c-report-details__icon"}),r().createElement("strong",null,"Steps to resolve")),r().createElement(F.CardBody,null,r().createElement(z(),{template:a})))),r().createElement(D.Table,{borders:"compactBorderless"},r().createElement(D.Thead,null,r().createElement(D.Tr,null,r().createElement(D.Th,{modifier:"fitContent"},A),r().createElement(D.Th,{modifier:"fitContent"},W))),r().createElement(D.Tbody,null,n.slice(0,3).map((function(e,t){return r().createElement(D.Tr,{key:t},r().createElement(D.Td,{dataLabel:A},e.uid),r().createElement(D.Td,{dataLabel:W},e.kind))})))),r().createElement(q.Button,{variant:"link",isInline:!0},"View all objects"),r().createElement("br",null),r().createElement(U.CardHeader,null,r().createElement("strong",null,"Note:")),r().createElement(F.CardBody,null,"Red Hat avoids gathering and processing namespace and resource names as these may reveal confidential information. Namespaces and resources are identified by their UIDs instead. You can use in-cluster commands like the ones below to translate UIDs of affected resources to their names.",r().createElement(B.d,null,'oc get namespace -o jsonpath={range .items[*]}{.metadata.name}{"\t"}{.metadata.uid}{"\n"}{end}\n  oc -n <namespace> get <resourceKind> -o jsonpath={range .items[*]}{.metadata.name}{"\t"}{.metadata.uid}{"\n"}{end}')),r().createElement(r().Fragment,null,r().createElement(H.Divider,null),r().createElement(E.v,null,r().createElement(N.Card,{isCompact:!0,isPlain:!0},r().createElement(U.CardHeader,null,r().createElement(S.default,{className:"ins-c-report-details__icon"}),r().createElement("strong",null,"Additional info")),r().createElement(F.CardBody,null,t)))))))};const G=K;K.propTypes={extra_data:b().string.isRequired,more_info:b().string.isRequired,resolution:b().string.isRequired,objects:b().arrayOf({kind:b().string,uid:b().string})};var M=a(86706),V=a(28672),J=a(76913),Y=a(29299);function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){(0,C.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $=function(e){var t=e.workload,a=(0,M.useDispatch)(),l=t.isError,s=t.isUninitialized,i=t.isFetching,c=t.isSuccess,o=t.data,d=(null==o?void 0:o.recommendations)||[],u=l,m=c,p=(0,n.useState)(!1),E=(0,O.Z)(p,2),f=E[0],g=E[1],v=(0,n.useState)([]),b=(0,O.Z)(v,2),y=b[0],k=b[1],w=(0,n.useState)([]),I=(0,O.Z)(w,2),T=I[0],S=I[1],x=(0,n.useState)(!1),q=(0,O.Z)(x,2),N=q[0],F=q[1],U=(0,n.useState)(!1),B=(0,O.Z)(U,2),H=B[0],L=B[1],z=(0,n.useState)(!0),A=(0,O.Z)(z,2),W=A[0],K=A[1],Q=s||i||!N,$=(0,M.useSelector)((function(e){return e.filters.workloadsRecsListState})),ee=function(e){return a((0,V.cH)(e))};(0,n.useEffect)((function(){k(re(d,$))}),[o,$]),(0,n.useEffect)((function(){S(ne(y,$.sortIndex,$.sortDirection)),L((0,Y.wW)($)),F(!0)}),[y]);var te,ae=(0,_.PL)($,(function(e,t){return K(!1),(0,J.Lv)($,ee,e,t)})),ne=function(e,t,a){var n=(0,Y.ke)(t,a,e);return(0,Y.l8)(n,W)},re=function(e,t){F(!1);var a=(0,Y.wW)(t);return e.filter((function(e){return!a||(0,J.y4)(e,t)})).map((function(e,t){return[{rule:e,isOpen:f,cells:[{title:e.details},{title:r().createElement("div",{key:t},r().createElement(R.Z,{value:4,rest:{isCompact:!0}}))},{title:e.objects.length},{title:r().createElement("div",{key:t},r().createElement(h.Z,{date:e.modified,type:"relative"}))}]},{cells:[{title:r().createElement(G,{extra_data:e.extra_data,more_info:e.more_info,resolution:e.resolution,objects:e.objects})}]}]}))},le={showDeleteButton:!!H,deleteTitle:"Reset filters",filters:(te=X({},$),delete te.sortIndex,delete te.sortDirection,(0,Y.lM)(te,_.Oq)),onDelete:function(e,t,a){a?(0,V.aw)($,V.J2,ee):t.map((function(e){var t,a=(0,C.Z)({},e.urlParam,Array.isArray($[e.urlParam])?$[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");a[e.urlParam].length>0?ee(X(X({},$),a)):(t=e.urlParam,(0,J.oo)($,ee,t))}))}};return r().createElement("div",{id:"workload-recs-list-table"},r().createElement(P.Z,{filterConfig:{items:ae,isDisabled:Q||u||0===d.length},pagination:r().createElement("span",{className:"pf-u-font-weight-bold"},1===(null==y?void 0:y.length)?"".concat(y.length," Recommendation"):"".concat(y.length," Recommendations")),activeFiltersConfig:Q||u||0===d.length?void 0:le}),r().createElement(D.Table,{"aria-label":"Workload recommendations table",ouiaId:"workload-recommendations",cells:_.x2,ouiaSafe:!Q,onCollapse:function(e,t,a){void 0===t?(g(a),S(T.map((function(e){return X(X({},e),Object.hasOwn(e,"parent")?null:{isOpen:a})})))):S(T.map((function(e,n){return n===t?X(X({},e),{},{isOpen:a}):e})))},rows:u||Q?[{fullWidth:!0,cells:[{props:{colSpan:_.x2.length+1},title:r().createElement(Z.Z,null)}]}]:m?T:r().createElement(j.Te,null),variant:D.TableVariant.compact,isStickyHeader:!0,canCollapseAll:!0,sortBy:{index:$.sortIndex,direction:$.sortDirection},onSort:function(e,t,a){F(!1),K(!1),ee(X(X({},$),{},{sortIndex:t,sortDirection:a}))}},r().createElement(D.TableHeader,null),r().createElement(D.TableBody,null)))};const ee=$;$.propTypes={workload:b().shape({isUninitialized:b().bool.isRequired,isFetching:b().bool.isRequired,isError:b().bool.isRequired,isSuccess:b().bool.isRequired,error:b().object,data:b().shape({namespace:b().shape({uuid:b().string,name:b().string}),cluster:b().shape({uuid:b().string,display_name:b().string}),status:b().string,recommendations:b().arrayOf(b().shape({check:b().string,description:b().string,objects:b().arrayOf(b().shape({kind:b().string,uid:b().string})),remediation:b().string}))})})};var te=function(e){var t,a=e.workload,n=e.namespaceId,u=e.clusterId;return r().createElement(r().Fragment,null,r().createElement(l.Z,{className:"pf-m-light ins-inventory-detail"},r().createElement(s.k,{direction:{default:"column"}},r().createElement(i.B,null,r().createElement(d.Z,{current:"ok"===(null==a||null===(t=a.data)||void 0===t?void 0:t.status)?"".concat(a.data.cluster.display_name," | ").concat(a.data.namespace.name):"".concat(u," | ").concat(n)}),r().createElement(I,null)))),r().createElement(c.NP,null,r().createElement(o.Dx,{className:"pf-u-mb-lg",headingLevel:"h3",size:"2xl"},"Recommendations"),r().createElement(ee,{workload:a})))};te.propTypes={clusterId:b().string.isRequired,namespaceId:b().string.isRequired,workload:b().shape({isUninitialized:b().bool.isRequired,isFetching:b().bool.isRequired,data:b().shape({namespace:b().shape({uuid:b().string,name:b().string}),cluster:b().shape({uuid:b().string,display_name:b().string}),status:b().string})})};var ae=a(55140);const ne=function(){var e=(0,ae.Z)(),t=(0,k.useParams)(),a=t.namespaceId,l=t.clusterId,s=(0,w.k0)({namespaceId:a,clusterId:l});return(0,n.useEffect)((function(){s.refetch()}),[a,l]),(0,n.useEffect)((function(){var t,n,r,i="".concat("ok"===(null==s||null===(t=s.data)||void 0===t?void 0:t.status)?"".concat(null==s||null===(n=s.data)||void 0===n?void 0:n.cluster.display_name," | ").concat(null==s||null===(r=s.data)||void 0===r?void 0:r.namespace.name," - Workloads"):"".concat(l," | ").concat(a," - Workloads"));e.updateDocumentTitle("".concat(i," - OCP Advisor | Red Hat Insights"))}),[s,a,l]),r().createElement(te,{workload:s,namespaceId:a,clusterId:l})}},73845:(e,t,a)=>{"use strict";a.d(t,{F:()=>s});var n=a(92950),r=a.n(n),l=a(24561),s=function(){return r().createElement(l.ZP,{height:20},r().createElement("rect",{x:"0",y:"0",rx:"4",ry:"4",width:"300",height:"20"}))}},58392:()=>{},71644:()=>{},28992:()=>{},92084:()=>{},38299:()=>{},72816:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Workload.64fb8ae5f80d3366057f60aed2b5be3d.js.map