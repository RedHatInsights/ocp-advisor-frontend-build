(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[9420],{67636:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>V});var n=r(92950),a=r.n(n),i=r(86896),l=r(89376),s=r(30893),o=r(86362),c=r(4942),u=r(70885),f=r(45697),m=r.n(f),d=r(86706),v=r(18446),p=r.n(v),g=r(62012),h=r(45578),y=r.n(h),_=r(81249),b=r(15509),E=r(13877),Z=r(76004),P=r(90111),k=r.n(P),S=r(62410),T=r(77572),O=r(28672),x=r(59303),C=r(76913),w=r(52661),D=r(51014),L=r(60076);function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j=function(e){var t=e.query,r=t.isError,l=t.isUninitialized,o=t.isFetching,f=t.isSuccess,m=t.data,v=t.refetch,h=(0,i.Z)(),P=(0,d.useDispatch)(),M=function(e){return P((0,O.$Q)(e))},j=(0,d.useSelector)((function(e){return e.filters.clustersListState})),A=(null==m?void 0:m.data)||[],R=j.offset/j.limit+1,B=(0,n.useState)([]),V=(0,u.Z)(B,2),W=V[0],F=V[1],N=(0,n.useState)([]),q=(0,u.Z)(N,2),H=q[0],G=q[1],z=(0,n.useState)(!1),Q=(0,u.Z)(z,2),U=Q[0],$=Q[1],J=(0,n.useState)(!0),K=(0,u.Z)(J,2),X=K[0],Y=K[1],ee=(0,g.useLocation)().search,te=l||o||!U,re=r,ne=A.length>0&&0===W.length,ae=f,ie=function(e,t){return(0,C.Lv)(j,M,e,t)};(0,n.useEffect)((function(){G(se(W)),$(!0)}),[W,j.limit,j.offset]),(0,n.useEffect)((function(){F(le(A))}),[m,j.text,j.version,j.hits,j.sortDirection,j.sortIndex]),(0,n.useEffect)((function(){if(ee&&X){var e=(0,C.yG)(ee);if(e.sort){var t=(0,C.Lg)(e.sort);e.sortIndex=x.lo.indexOf(t.name),e.sortDirection=t.direction}e.offset&&(e.offset=Number(e.offset[0])),e.limit&&(e.limit=Number(e.limit[0])),e.impacting&&!Array.isArray(e.impacting)&&(e.impacting=["".concat(e.impacting)]),M(I(I({},j),e))}Y(!1)}),[]),(0,n.useEffect)((function(){X||(0,C.aM)(j,x.lo)}),[j,X]);var le=function(e){$(!1);var t=e.filter((function(e){return(0,C.im)(e,j)})).map((function(e,t){var r,n,i,l;void 0===e.cluster_version||""===e.cluster_version||(0,_.valid)((0,_.coerce)(e.cluster_version))||console.error("Cluster version ".concat(e.cluster_version," has invalid format!"));var o=(0,C.WL)(e.cluster_version);return{entity:e,cells:[a().createElement("span",{key:t},a().createElement(g.Link,{to:"".concat(L.G,"/clusters/").concat(e.cluster_id)},e.cluster_name||e.cluster_id)),"0.0.0"===o?h.formatMessage(s.Z.nA):o,e.total_hit_count,(null===(r=e.hits_by_total_risk)||void 0===r?void 0:r[4])||0,(null===(n=e.hits_by_total_risk)||void 0===n?void 0:n[3])||0,(null===(i=e.hits_by_total_risk)||void 0===i?void 0:i[2])||0,(null===(l=e.hits_by_total_risk)||void 0===l?void 0:l[1])||0,a().createElement("span",{key:t},e.last_checked_at?a().createElement(S.Z,{extraTitle:"".concat(h.formatMessage(s.Z.lastSeen),": "),date:e.last_checked_at,variant:"relative"}):a().createElement(Z.Tooltip,{key:t,content:a().createElement("span",null,h.formatMessage(s.Z.lastSeen)+": ",h.formatMessage(s.Z.nA))},a().createElement("span",null,h.formatMessage(s.Z.nA))))]}}));return-1===j.sortIndex?t:t.sort((function(e,t){var r,n,a=j.sortDirection===b.SortByDirection.asc?1:-1;switch(j.sortIndex){case x.v7:return r=e.entity.cluster_name||e.entity.cluster_id,n=t.entity.cluster_name||t.entity.cluster_id,r.localeCompare(n)?r.localeCompare(n)*a:0;case x._s:return(0,C._)((0,C.WL)(e.entity.cluster_version),(0,C.WL)(t.entity.cluster_version),a);case x.CL:return(r=new Date(e.entity.last_checked_at||0))>(n=new Date(t.entity.last_checked_at||0))?a:n>r?-a:0;default:return(r=e.cells[j.sortIndex])>(n=t.cells[j.sortIndex])?a:n>r?-a:0}}))},se=function(e){return e.slice(j.limit*(R-1),j.limit*(R-1)+j.limit)},oe=[{label:h.formatMessage(s.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return M(I(I({},j),{},{offset:0,text:t}))},value:j.text,placeholder:h.formatMessage(s.Z.filterByName)}},{label:h.formatMessage(s.Z.version),placeholder:h.formatMessage(s.Z.filterByVersion),type:T.conditionalFilterType.checkbox,filterValues:{id:"version-filter",key:"version-filter",onChange:function(e,t){return ie("version",t)},value:j.version,items:y()(A.filter((function(e){return void 0!==e.cluster_version&&""!==e.cluster_version})).map((function(e){return{value:(0,C.WL)(e.cluster_version)}})).sort((function(e,t){return(0,C._)((0,C.WL)(e.cluster_version),(0,C.WL)(t.cluster_version),1)})).reverse(),"value")}},{label:x.RT.hits.title,type:x.RT.hits.type,id:x.RT.hits.urlParam,value:"checkbox-".concat(x.RT.hits.urlParam),filterValues:{key:"".concat(x.RT.hits.urlParam,"-filter"),onChange:function(e,t){return ie(x.RT.hits.urlParam,t)},value:j.hits,items:x.RT.hits.values}}],ce={showDeleteButton:!0,deleteTitle:h.formatMessage(s.Z.resetFilters),filters:(0,C.mt)(j,x.RT),onDelete:function(e,t,r){r?p()(j,O.Ly)?v():(0,O.aw)(j,O.Ly,M):t.map((function(e){var t,r=(0,c.Z)({},e.urlParam,Array.isArray(j[e.urlParam])?j[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");r[e.urlParam].length>0?M(I(I({},j),r)):(t=e.urlParam,(0,C.oo)(j,M,t))}))}};return a().createElement(a().Fragment,null,f&&0===A.length?a().createElement(D.ER,null):a().createElement("div",{id:"clusters-list-table","data-ouia-safe":!te},a().createElement(k(),{pagination:{itemCount:W.length,page:R,perPage:j.limit,onSetPage:function(e,t){return $(!1),M(I(I({},j),{},{offset:j.limit*(t-1)}))},onPerPageSelect:function(e,t){return $(!1),M(I(I({},j),{},{limit:t,offset:0}))},isCompact:!0,ouiaId:"pager"},filterConfig:{items:oe},activeFiltersConfig:ce}),a().createElement(b.Table,{"aria-label":"Table of clusters",ouiaId:"clusters",ouiaSafe:!te,variant:b.TableVariant.compact,cells:x.Bg,rows:re||te||ne?[{fullWidth:!0,cells:[{props:{colSpan:x.Bg.length+1},title:re?a().createElement(D.Te,null):te?a().createElement(w.Z,null):a().createElement(D.VA,null)}]}]:ae?H:a().createElement(D.Te,null),sortBy:{index:j.sortIndex,direction:j.sortDirection},onSort:function(e,t,r){$(!1),M(I(I({},j),{},{sortIndex:t,sortDirection:r}))},isStickyHeader:!0},a().createElement(b.TableHeader,null),a().createElement(b.TableBody,null)),a().createElement(E.tl,{ouiaId:"pager",itemCount:W.length,page:j.offset/j.limit+1,perPage:Number(j.limit),onSetPage:function(e,t){return M(I(I({},j),{},{offset:j.limit*(t-1)}))},onPerPageSelect:function(e,t){return M(I(I({},j),{},{limit:t,offset:0}))},widgetId:"pagination-options-menu-bottom",variant:E.aM.bottom})))};j.propTypes={query:m().object.isRequired};const A=function(){var e=(0,o.Oj)();return a().createElement(j,{query:e})};var R=r(34348),B=r(55140);const V=function(){var e=(0,i.Z)();return(0,B.Z)().updateDocumentTitle(e.formatMessage(s.Z.documentTitle,{subnav:e.formatMessage(s.Z.clusters)})),a().createElement(a().Fragment,null,a().createElement(l.Z,{className:"ins-c-clusters-header"},a().createElement(R.Dx,{headingLevel:"h1",ouiaId:"page-header"},"".concat(e.formatMessage(s.Z.insightsHeader)," ").concat(e.formatMessage(s.Z.clusters).toLowerCase()))),a().createElement("section",{className:"pf-l-page__main-section pf-c-page__main-section"},a().createElement(A,null)))}},52661:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(92950),a=r.n(n),i=r(2095),l=r(85962),s=r(24561);const o=function(){return a().createElement(i.Card,{ouiaId:"loading-skeleton"},a().createElement(l.CardBody,null,a().createElement(s.aV,null)))}},80598:()=>{},28992:()=>{},93398:()=>{},46928:()=>{}}]);
//# sourceMappingURL=../sourcemaps/ClustersList.d0c998676bcca4df24a29d1f69ca04e9.js.map