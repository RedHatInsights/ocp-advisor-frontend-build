"use strict";(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[384],{33344:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var a=r(93264),i=r.n(a),n=r(93433),l=r(4942),o=r(29439),c=r(88931),u=r(86896),s=r(16530),m=r(45697),f=r.n(m),d=r(94550),p=r(56161),g=r(18246),v=r(88292),y=r(8045),b=r(62410),P=r(78216),h=r(90111),k=r(59303),W=r(30893),_=r(28672),E=r(31728),Z=r(28186),C=r(52661),S=r(51014),O=r(1990);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){(0,l.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D=function(e){var t=e.query,r=(0,u.Z)(),m=(0,c.useDispatch)(),f=(0,c.useSelector)((function(e){return e.filters.recsListState})),x=t.isError,D=t.isUninitialized,T=t.isFetching,j=t.isSuccess,Q=t.data,I=(null==Q?void 0:Q.recommendations)||[],M=f.offset/f.limit+1,V=(0,a.useState)([]),q=(0,o.Z)(V,2),A=q[0],B=q[1],L=(0,a.useState)([]),F=(0,o.Z)(L,2),N=F[0],R=F[1];(0,a.useEffect)((function(){R(H(A,f.sortIndex,f.sortDirection))}),[A,f.limit,f.offset,f.sortIndex,f.sortDirection]),(0,a.useEffect)((function(){B(z(I,f))}),[Q,f]);var U,z=function(e,t){return e.filter((function(e){return function(e,t){return Object.entries(t).every((function(t){var r=(0,o.Z)(t,2),a=r[0],i=r[1];switch(a){case"text":return e.description.toLowerCase().includes(i.toLowerCase());case k.W2.total_risk.urlParam:return i.includes(String(e.total_risk));case k.W2.category.urlParam:return e.tags.find((function(e){return i.includes(String(k.kT[e]))}));case k.W2.impact.urlParam:return i.includes(String(e.impact));case k.W2.impacting.urlParam:return!(i.length>0)||i.some((function(t){return"true"===t?e.impacted_clusters_count>0:"false"===t?0===e.impacted_clusters_count:void 0}));case k.W2.likelihood.urlParam:return i.includes(String(e.likelihood));case k.W2.rule_status.urlParam:return"all"===i||"disabled"===i&&e.disabled||"enabled"===i&&!e.disabled;default:return!0}}))}(e,t)})).map((function(e,t){return[{isOpen:!1,rule:e,cells:[{title:i().createElement("span",{key:t},i().createElement(s.Link,{key:t,to:"/recommendations/".concat(e.rule_id)}," ",(null==e?void 0:e.description)||(null==e?void 0:e.rule_id)," "),i().createElement(E.Z,{rule:e}))},{title:null!=e&&e.publish_date?i().createElement(b.Z,{key:t,date:e.publish_date,variant:"relative"}):r.formatMessage(W.Z.nA)},{title:i().createElement("div",{key:t},i().createElement(y.Tooltip,{key:t,position:y.TooltipPosition.bottom,content:r.formatMessage(W.Z.rulesDetailsTotalRiskBody,{risk:k.Nq[e.total_risk]||r.formatMessage(W.Z.undefined),strong:function(e){return(0,Z.f)(e)}})},null!=e&&e.total_risk?i().createElement(P.Z,{value:e.total_risk}):r.formatMessage(W.Z.nA)))},{title:i().createElement("div",{key:t},"".concat(void 0!==(null==e?void 0:e.impacted_clusters_count)?e.impacted_clusters_count.toLocaleString():r.formatMessage(W.Z.nA)))}]},{fullWidth:!0,cells:[{title:i().createElement("section",{className:"pf-m-light pf-l-page__main-section pf-c-page__main-section"},i().createElement(v.Stack,{hasGutter:!0},i().createElement(O.Z,{rule:w(w({},e),{},{impact:{impact:e.impact},impacted_clusters_count:void 0}),isDetailsPage:!1})))}]}]}))},H=function(e,t,r){var a=["description","publish_date","total_risk","impacted_clusters_count"],i=(0,n.Z)(e).sort((function(e,r){var i=e[0].rule[a[t-1]],n=r[0].rule[a[t-1]];return i>n?1:n>i?-1:0}));return r===d.SortByDirection.desc&&i.reverse(),i.slice(f.limit*(M-1),f.limit*(M-1)+f.limit).flatMap((function(e,t){var r=(0,n.Z)(e);return e[1].parent=2*t,r}))},G=function(e){var t=w(w({},f),{},{offset:0});delete t[e],m((0,_.Q4)(w(w({},t),"text"===e?{text:""}:{})))},X=function(e,t){t.length>0?m((0,_.Q4)(w(w({},f),{},{offset:0},(0,l.Z)({},e,t)))):G(e)},J=[{label:r.formatMessage(W.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return m((0,_.Q4)(w(w({},f),{},{text:t})))},value:f.text,placeholder:r.formatMessage(W.Z.filterBy)}},{label:k.W2.total_risk.title,type:k.W2.total_risk.type,id:k.W2.total_risk.urlParam,value:"checkbox-".concat(k.W2.total_risk.urlParam),filterValues:{key:"".concat(k.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return X(k.W2.total_risk.urlParam,t)},value:f.total_risk,items:k.W2.total_risk.values}},{label:k.W2.impact.title,type:k.W2.impact.type,id:k.W2.impact.urlParam,value:"checkbox-".concat(k.W2.impact.urlParam),filterValues:{key:"".concat(k.W2.impact.urlParam,"-filter"),onChange:function(e,t){return X(k.W2.impact.urlParam,t)},value:f.impact,items:k.W2.impact.values}},{label:k.W2.likelihood.title,type:k.W2.likelihood.type,id:k.W2.likelihood.urlParam,value:"checkbox-".concat(k.W2.likelihood.urlParam),filterValues:{key:"".concat(k.W2.likelihood.urlParam,"-filter"),onChange:function(e,t){return X(k.W2.likelihood.urlParam,t)},value:f.likelihood,items:k.W2.likelihood.values}},{label:k.W2.category.title,type:k.W2.category.type,id:k.W2.category.urlParam,value:"checkbox-".concat(k.W2.category.urlParam),filterValues:{key:"".concat(k.W2.category.urlParam,"-filter"),onChange:function(e,t){return X(k.W2.category.urlParam,t)},value:f.category,items:k.W2.category.values}},{label:k.W2.rule_status.title,type:k.W2.rule_status.type,id:k.W2.rule_status.urlParam,value:"radio-".concat(k.W2.rule_status.urlParam),filterValues:{key:"".concat(k.W2.rule_status.urlParam,"-filter"),onChange:function(e,t){return r=t,void m((0,_.Q4)(w(w({},f),{},{rule_status:r,offset:0},"enabled"!==r&&{impacting:["false"]})));var r},value:"".concat(f.rule_status),items:k.W2.rule_status.values}},{label:k.W2.impacting.title,type:k.W2.impacting.type,id:k.W2.impacting.urlParam,value:"checkbox-".concat(k.W2.impacting.urlParam),filterValues:{key:"".concat(k.W2.impacting.urlParam,"-filter"),onChange:function(e,t){return X(k.W2.impacting.urlParam,t)},value:f.impacting,items:k.W2.impacting.values}}],K={deleteTitle:r.formatMessage(W.Z.resetFilters),filters:(U=w({},f),delete U.sortIndex,delete U.sortDirection,delete U.offset,delete U.limit,function(e,t){var r=Object.entries(e);return r.length>0?r.reduce((function(e,r){if(t[r[0]]){var a=t[r[0]],i=Array.isArray(r[1])?r[1].map((function(e){var t=a.values.find((function(t){return t.value===String(e)}));return t?{name:t.text||t.label,value:e}:{name:e,value:e}})):[{name:a.values.find((function(e){return e.value===String(r[1])})).label,value:r[1]}];return[].concat((0,n.Z)(e),[{category:(l=a.title,l[0].toUpperCase()+l.substring(1)),chips:i,urlParam:a.urlParam}])}return"text"===r[0]?[].concat((0,n.Z)(e),(0,n.Z)(r[1].length>0?[{category:"Name",chips:[{name:r[1],value:r[1]}],urlParam:r[0]}]:[])):e;var l}),[]):[]}(U,k.W2)),onDelete:function(e,t,r){r?m((0,_.Q4)(_.CH)):t.map((function(e){var t=(0,l.Z)({},e.urlParam,Array.isArray(f[e.urlParam])?f[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");t[e.urlParam].length>0?m((0,_.Q4)(w(w({},f),t))):G(e.urlParam)}))}};return i().createElement("div",{id:"recs-list-table"},i().createElement(h.Z,{pagination:{itemCount:A.length,page:f.offset/f.limit+1,perPage:Number(f.limit),onSetPage:function(e,t){m((0,_.Q4)(w(w({},f),{},{offset:f.limit*(t-1)})))},onPerPageSelect:function(e,t){m((0,_.Q4)(w(w({},f),{},{limit:t,offset:0})))},isCompact:!0},filterConfig:{items:J},activeFiltersConfig:K}),(D||T)&&i().createElement(C.Z,null),(x||j&&0===I.length)&&i().createElement(p.Card,null,i().createElement(p.CardBody,null,i().createElement(S.Te,null))),j&&I.length>0&&i().createElement(i().Fragment,null,i().createElement(d.Table,{"aria-label":"Table of recommendations",ouiaId:"recsListTable",variant:d.TableVariant.compact,cells:k.XT,rows:N,onCollapse:function(e,t,r){var a=(0,n.Z)(N);a[t]=w(w({},a[t]),{},{isOpen:r}),R(a)},sortBy:{index:f.sortIndex,direction:f.sortDirection},onSort:function(e,t,r){m((0,_.Q4)(w(w({},f),{},{sortIndex:t,sortDirection:r})))}},i().createElement(d.TableHeader,null),i().createElement(d.TableBody,null)),I.length>0&&0===A.length&&i().createElement(p.Card,{ouiaId:"empty-recommendations"},i().createElement(p.CardBody,null,i().createElement(S.A0,null)))),i().createElement(g.Pagination,{ouiaId:"recs-list-pagination-bottom",itemCount:A.length,page:f.offset/f.limit+1,perPage:Number(f.limit),onSetPage:function(e,t){m((0,_.Q4)(w(w({},f),{},{offset:f.limit*(t-1)})))},onPerPageSelect:function(e,t){m((0,_.Q4)(w(w({},f),{},{limit:t,offset:0})))},widgetId:"pagination-options-menu-bottom",variant:g.PaginationVariant.bottom}))};D.propTypes={query:f().shape({isError:f().bool.isRequired,isUninitialized:f().bool.isRequired,isFetching:f().bool.isRequired,isSuccess:f().bool.isRequired,data:f().array})};var T=r(86362);const j=function(){var e=(0,T.Bs)();return i().createElement(D,{query:e})}}}]);
//# sourceMappingURL=../sourcemaps/RulesTable.ccc37a5ad0cea3ba5a699f4ceaa5981c.js.map