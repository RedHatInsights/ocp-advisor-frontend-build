(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[9956],{76913:(e,r,t)=>{"use strict";t.d(r,{Lg:()=>P,Lv:()=>S,U1:()=>A,WL:()=>j,_:()=>O,_F:()=>b,aM:()=>C,im:()=>y,mt:()=>w,oo:()=>Z,y4:()=>L,yG:()=>_});var n=t(71002),a=t(45987),o=t(4942),i=t(42982),l=t(70885),u=t(48403),c=t.n(u),s=t(50361),f=t.n(s),d=(t(92950),t(81249)),v=t(59303),m=t(29299);function p(e){var r=function(e,r){if("object"!==(0,n.Z)(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!==(0,n.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===(0,n.Z)(r)?r:String(r)}function g(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?g(Object(t),!0).forEach((function(r){(0,o.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var b=function(e,r){return Object.entries(r).every((function(r){var t=(0,l.Z)(r,2),n=t[0],a=t[1];switch(n){case"text":return e.description.toLowerCase().includes(a.toLowerCase());case v.W2.total_risk.urlParam:return a.includes(String(e.total_risk));case v.W2.category.urlParam:return e.tags.find((function(e){return a.includes(String(v.kT[e]))}));case v.W2.impact.urlParam:return a.includes(String(e.impact));case v.W2.impacting.urlParam:return!(a.length>0)||a.some((function(r){return"true"===r?e.impacted_clusters_count>0:"false"===r?0===e.impacted_clusters_count:void 0}));case v.W2.likelihood.urlParam:return a.includes(String(e.likelihood));case v.W2.rule_status.urlParam:return"all"===a||"disabled"===a&&e.disabled||"enabled"===a&&!e.disabled;case v.W2.res_risk.urlParam:return a.includes(String(e.resolution_risk));default:return!0}}))},y=function(e,r){return Object.entries(r).every((function(r){var t=(0,l.Z)(r,2),n=t[0],a=t[1];switch(n){case"text":return(e.cluster_name||e.cluster_id).toLowerCase().includes(a.toLowerCase());case v.RT.hits.urlParam:return 0===a.length&&parseInt(e.total_hit_count)>0||a.includes("all")||a.some((function(r){return e.hits_by_total_risk[r]>0}));case"version":return 0===a.length||a.includes(j(e.cluster_version));default:return!0}}))},w=function(e,r){var t=f()(e);return delete t.sortIndex,delete t.sortDirection,delete t.sort,delete t.offset,delete t.limit,(null==t?void 0:t.hits)&&0===t.hits.length&&delete t.hits,function(e,r){return Object.entries(e||{}).reduce((function(e,t){var n=(0,l.Z)(t,2),a=n[0],o=n[1];if(r[a]){var u=r[a],s=Array.isArray(o)?o.map((function(e){var r=u.values.find((function(r){return r.value===String(e)}));return r?{name:r.text||r.label,value:e}:{name:e,value:e}})):[{name:u.values.find((function(e){return e.value===String(o)})).label,value:o}];return[].concat((0,i.Z)(e),[{category:c()(u.title),chips:s,urlParam:u.urlParam}])}return"text"===a?[].concat((0,i.Z)(e),(0,i.Z)(o.length>0?[{category:"Name",chips:[{name:o,value:o}],urlParam:a}]:[])):"version"===a?[].concat((0,i.Z)(e),(0,i.Z)(o.length>0?[{category:"Version",chips:o.map((function(e){return{name:e,value:e}})),urlParam:a}]:[])):"namespace_name"===a?[].concat((0,i.Z)(e),(0,i.Z)(o.length>0?[{category:"Namespace name",chips:[{name:o,value:o}],urlParam:a}]:[])):"cluster_name"===a?[].concat((0,i.Z)(e),(0,i.Z)(o.length>0?[{category:"Cluster name",chips:[{name:o,value:o}],urlParam:a}]:[])):void 0}),[])}(t,r)},_=function(e){var r=new URLSearchParams(e);return Array.from(r).reduce((function(e,r){var t=(0,l.Z)(r,2),n=t[0],a=t[1];return h(h({},e),{},(0,o.Z)({},n,["text","first","rule_status","sort","cluster_name","namespace_name"].includes(n)?a:"true"===a||"false"===a?JSON.parse(a):a.split(",")))}),{})},P=function(e){return{name:e.substring(e.startsWith("-")?1:0),direction:e.startsWith("-")?"desc":"asc"}},C=function(){var e,r,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,o=new URL(window.location.origin+window.location.pathname);o.searchParams.set("sort",(e=n.sortIndex,r=a,t=n.sortDirection,["desc","asc"].includes(t)||console.error("Invalid sort parameters (is not asc nor desc)"),"".concat("asc"===t?"":"-").concat(r[e]))),Object.entries(n).forEach((function(e){var r=(0,l.Z)(e,2),t=r[0],n=r[1];return"sortIndex"!==t&&"sortDirection"!==t&&"sort"!==t&&""!==n&&!(Array.isArray(n)&&0===n.length)&&o.searchParams.set(t,n)})),window.history.replaceState(null,null,o.href)},O=function(e,r,t){return t*(0,d.compare)(e,r)},j=function(e){return(0,d.coerce)(void 0!==e&&(0,d.valid)((0,d.coerce)(e))?e:"0.0.0").version},Z=function(e,r,t){var n=h(h({},e),{},{offset:0});n[t],r(h(h({},(0,a.Z)(n,[t].map(p))),"text"===t?{text:""}:"hits"===t?{hits:[]}:"version"===t?{version:[]}:{}))},S=function(e,r,t,n){return n.length>0?r(h(h({},e),{},{offset:0},(0,o.Z)({},t,n))):Z(e,r,t)},A=function(e,r){var t=(0,m.Vs)(e.metadata.hits_by_severity,"general");return Object.entries(r).every((function(n){var a=(0,l.Z)(n,2),o=a[0],i=a[1];switch(o){case"cluster_name":return(e.cluster.display_name||e.cluster.uuid).toLowerCase().includes(i.toLowerCase());case"namespace_name":return(e.namespace.name||e.namespace.uuid).toLowerCase().includes(i.toLowerCase());case"severity":return 0===i.length||(0,m.mR)(t,r.severity);default:return!0}}))},L=function(e,r){return Object.entries(r).some((function(r){var t=(0,l.Z)(r,2),n=t[0],a=t[1];if(0===a.length)return!1;switch(n){case"description":return e.details.toLowerCase().includes(a.toLowerCase());case"object_id":return e.objects.some((function(e){return e.uid.toLowerCase().includes(a.toLowerCase())}));default:return!1}}))}},52661:(e,r,t)=>{"use strict";t.d(r,{Z:()=>u});var n=t(92950),a=t.n(n),o=t(2095),i=t(85962),l=t(24561);const u=function(){return a().createElement(o.Card,{ouiaId:"loading-skeleton"},a().createElement(i.CardBody,null,a().createElement(l.aV,null)))}},29299:(e,r,t)=>{"use strict";t.d(r,{Vs:()=>s,ke:()=>h,l8:()=>b,lM:()=>p,mR:()=>f,og:()=>c,wW:()=>d});var n=t(42982),a=t(70885),o=t(15509),i=t(44439),l=t.n(i);function u(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var c=[{value:"critical",label:"Critical",iconColor:"var(--pf-global--danger-color--100)",textColor:"var(--pf-global--danger-color--100)",hasIcon:!0},{value:"important",label:"Important",iconColor:"var(--pf-global--palette--orange-300)",textColor:"var(--pf-global--palette--orange-400)",hasIcon:!0},{value:"moderate",label:"Moderate",iconColor:"var(--pf-global--warning-color--100)",textColor:"var(--pf-global--warning-color--200)",hasIcon:!0},{value:"low",label:"Low",iconColor:"var(--pf-global--Color--200)",textColor:"var(--pf-global--default-color--300)",hasIcon:!0},{value:"none",label:"Unknown"}],s=function(e,r){var t={1:"low",2:"moderate",3:"important",4:"critical"},n={};if("general"===r||"label"===r)for(var a in e)a in t&&(n[t[a]]=e[a]);else n=t[e];return n},f=function(e,r){var t,n=function(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return u(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?u(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(l)throw o}}}}(r);try{for(n.s();!(t=n.n()).done;)if(e[t.value]>0)return!0}catch(e){n.e(e)}finally{n.f()}},d=function(e){var r=l().cloneDeep(e);return delete r.sortIndex,delete r.sortDirection,delete r.offset,delete r.limit,!!Object.values(r).filter((function(e){return!(0,i.isEmpty)(e)})).length},v=function(e){return(null==e?void 0:e.charAt(0).toUpperCase())+(null==e?void 0:e.slice(1))},m=function(e,r){if(e.values){var t=e.values.find((function(e){return e.value===String(r)}));return t?{name:t.label||t.text,value:r}:{name:r,value:r}}return{name:r,value:r}},p=function(e,r){return Object.entries(e).reduce((function(e,t){var n=(0,a.Z)(t,2),o=n[0],i=n[1];if(r[o]){var l=r[o];if(Array.isArray(i)&&i.length>0||"string"==typeof i&&""!==i.trim()){var u=Array.isArray(i)?i.map((function(e){return m(l,e)})):[m(l,i)];e.push({category:v(l.label),chips:u,urlParam:l.urlParam})}}else"description"!==o&&"object_id"!==o||""===i.trim()||e.push({category:v(o.replace("_"," ")),chips:[{name:i,value:i}],urlParam:o});return e}),[])},g=function(e,r){var t=r[0].rule;switch(e){case 1:return t.details;case 2:return t.total_risk;case 3:return t.objects.length;case 4:return t.modified}},h=function(e,r,t){var a;return e>=1?null===(a=(0,n.Z)(t))||void 0===a?void 0:a.sort((function(t,n){var a=r===o.SortByDirection.asc?1:-1;return g(e,t)>g(e,n)?a:g(e,n)>g(e,t)?-a:0})):(0,n.Z)(t)},b=function(e,r){return e.flatMap((function(e,t){var a=(0,n.Z)(e);return r&&0===t&&(e[0].isOpen=!0),e[1].parent=2*t,a}))}},80598:()=>{}}]);
//# sourceMappingURL=../sourcemaps/9956.a660bfc1c695f9df10158183ad532f74.js.map