"use strict";(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[384],{68149:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var r=a(93433),n=a(4942),i=a(29439),l=a(93264),o=a.n(l),c=a(88931),u=a(86896),s=a(16530),m=a(94550),f=a(56161),p=a(18246),d=a(88292),g=a(8045),v=a(62410),y=a(78216),P=a(90111),k=a(59303),h=a(86362),b=a(30893),W=a(28672),_=a(31728),E=a(52661),Z=a(51014),C=a(1990);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const w=function(){var e=(0,u.Z)(),t=(0,c.useDispatch)(),a=(0,c.useSelector)((function(e){return e.filters.recsListState})),O=(0,h.Bs)(),w=O.isError,x=O.isUninitialized,j=O.isFetching,T=O.isSuccess,D=O.data,M=(null==D?void 0:D.recommendations)||[],Q=a.offset/a.limit+1,A=(0,l.useState)([]),V=(0,i.Z)(A,2),L=V[0],B=V[1],I=(0,l.useState)([]),N=(0,i.Z)(I,2),F=N[0],H=N[1];(0,l.useEffect)((function(){H(z(L))}),[L,a.limit,a.offset]),(0,l.useEffect)((function(){B(q(M,a))}),[D,a]);var U,q=function(t,a){return t.filter((function(e){return function(e,t){return Object.entries(t).every((function(t){var a=(0,i.Z)(t,2),r=a[0],n=a[1];switch(r){case"text":return e.description.toLowerCase().includes(n.toLowerCase());case k.W2.total_risk.urlParam:return n.includes(String(e.total_risk));case k.W2.category.urlParam:return e.tags.find((function(e){return n.includes(String(k.kT[e]))}));case k.W2.impact.urlParam:return n.includes(String(e.impact));case k.W2.impacting.urlParam:return!(n.length>0)||n.some((function(t){return"true"===t?e.impacted_clusters_count>0:"false"===t?0===e.impacted_clusters_count:void 0}));case k.W2.likelihood.urlParam:return n.includes(String(e.likelihood));default:return!0}}))}(e,a)})).sort((function(e,t){return e.total_risk<t.total_risk?1:-1})).map((function(t,a){return[{isOpen:!1,rule:t,cells:[{title:o().createElement("span",{key:a},o().createElement(s.Link,{key:a,to:"/recommendations/".concat(t.rule_id)}," ",(null==t?void 0:t.description)||(null==t?void 0:t.rule_id)," "),o().createElement(_.Z,{rule:t}))},{title:null!=t&&t.publish_date?o().createElement(v.Z,{key:a,date:t.publish_date,variant:"relative"}):e.formatMessage(b.Z.nA)},{title:o().createElement("div",{key:a},o().createElement(g.Tooltip,{key:a,position:g.TooltipPosition.bottom,content:e.formatMessage(b.Z.rulesDetailsTotalRiskBody,{risk:k.Nq[t.total_risk]||e.formatMessage(b.Z.undefined),strong:function(e){return function(e){return o().createElement("strong",null,e)}(e)}})},null!=t&&t.total_risk?o().createElement(y.Z,{value:t.total_risk}):e.formatMessage(b.Z.nA)))},{title:o().createElement("div",{key:a},"".concat(void 0!==(null==t?void 0:t.impacted_clusters_count)?t.impacted_clusters_count.toLocaleString():e.formatMessage(b.Z.nA)))}]},{fullWidth:!0,cells:[{title:o().createElement("section",{className:"pf-m-light pf-l-page__main-section pf-c-page__main-section"},o().createElement(d.Stack,{hasGutter:!0},o().createElement(C.Z,{rule:S(S({},t),{},{impact:{impact:t.impact},impacted_clusters_count:void 0}),isDetailsPage:!1})))}]}]}))},z=function(e){return e.slice(a.limit*(Q-1),a.limit*(Q-1)+a.limit).flatMap((function(e,t){var a=(0,r.Z)(e);return e[1].parent=2*t,a}))},G=function(e){var r=S(S({},a),{},{offset:0});delete r[e],t((0,W.Q4)(S(S({},r),"text"===e?{text:""}:{})))},R=function(e,r){r.length>0?t((0,W.Q4)(S(S({},a),{},{offset:0},(0,n.Z)({},e,r)))):G(e)},X=[{label:e.formatMessage(b.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,r){return t((0,W.Q4)(S(S({},a),{},{text:r})))},value:a.text,placeholder:e.formatMessage(b.Z.filterBy)}},{label:k.W2.total_risk.title,type:k.W2.total_risk.type,id:k.W2.total_risk.urlParam,value:"checkbox-".concat(k.W2.total_risk.urlParam),filterValues:{key:"".concat(k.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return R(k.W2.total_risk.urlParam,t)},value:a.total_risk,items:k.W2.total_risk.values}},{label:k.W2.impact.title,type:k.W2.impact.type,id:k.W2.impact.urlParam,value:"checkbox-".concat(k.W2.impact.urlParam),filterValues:{key:"".concat(k.W2.impact.urlParam,"-filter"),onChange:function(e,t){return R(k.W2.impact.urlParam,t)},value:a.impact,items:k.W2.impact.values}},{label:k.W2.likelihood.title,type:k.W2.likelihood.type,id:k.W2.likelihood.urlParam,value:"checkbox-".concat(k.W2.likelihood.urlParam),filterValues:{key:"".concat(k.W2.likelihood.urlParam,"-filter"),onChange:function(e,t){return R(k.W2.likelihood.urlParam,t)},value:a.likelihood,items:k.W2.likelihood.values}},{label:k.W2.category.title,type:k.W2.category.type,id:k.W2.category.urlParam,value:"checkbox-".concat(k.W2.category.urlParam),filterValues:{key:"".concat(k.W2.category.urlParam,"-filter"),onChange:function(e,t){return R(k.W2.category.urlParam,t)},value:a.category,items:k.W2.category.values}},{label:k.W2.impacting.title,type:k.W2.impacting.type,id:k.W2.impacting.urlParam,value:"checkbox-".concat(k.W2.impacting.urlParam),filterValues:{key:"".concat(k.W2.impacting.urlParam,"-filter"),onChange:function(e,t){return R(k.W2.impacting.urlParam,t)},value:a.impacting,items:k.W2.impacting.values}}],J={deleteTitle:e.formatMessage(b.Z.resetFilters),filters:(U=S({},a),delete U.sortIndex,delete U.sortDirection,delete U.offset,delete U.limit,function(e,t){var a=Object.entries(e);return a.length>0?a.reduce((function(e,a){if(t[a[0]]){var n=t[a[0]],i=Array.isArray(a[1])?a[1].map((function(e){var t=n.values.find((function(t){return t.value===String(e)}));return t?{name:t.text||t.label,value:e}:{name:e,value:e}})):[{name:n.values.find((function(e){return e.value===String(a[1])})).label,value:a[1]}];return[].concat((0,r.Z)(e),[{category:(l=n.title,l[0].toUpperCase()+l.substring(1)),chips:i,urlParam:n.urlParam}])}return"text"===a[0]?[].concat((0,r.Z)(e),(0,r.Z)(a[1].length>0?[{category:"Name",chips:[{name:a[1],value:a[1]}],urlParam:a[0]}]:[])):e;var l}),[]):[]}(U,k.W2)),onDelete:function(e,r,i){i?t((0,W.Q4)(W.CH)):r.map((function(e){var r=(0,n.Z)({},e.urlParam,Array.isArray(a[e.urlParam])?a[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");r[e.urlParam].length>0?t((0,W.Q4)(S(S({},a),r))):G(e.urlParam)}))}};return o().createElement("div",{id:"recs-list-table"},o().createElement(P.Z,{pagination:{itemCount:L.length,page:a.offset/a.limit+1,perPage:Number(a.limit),onSetPage:function(e,r){t((0,W.Q4)(S(S({},a),{},{offset:a.limit*(r-1)})))},onPerPageSelect:function(e,r){t((0,W.Q4)(S(S({},a),{},{limit:r,offset:0})))},isCompact:!0},filterConfig:{items:X},activeFiltersConfig:J}),(x||j)&&o().createElement(E.Z,null),(w||T&&0===M.length)&&o().createElement(f.Card,null,o().createElement(f.CardBody,null,o().createElement(Z.Te,null))),T&&M.length>0&&o().createElement(o().Fragment,null,o().createElement(m.Table,{"aria-label":"Table of recommendations",ouiaId:"recsListTable",variant:m.TableVariant.compact,cells:k.XT,rows:F,onCollapse:function(e,t,a){var n=(0,r.Z)(F);n[t]=S(S({},n[t]),{},{isOpen:a}),H(n)}},o().createElement(m.TableHeader,null),o().createElement(m.TableBody,null)),M.length>0&&0===L.length&&o().createElement(f.Card,{ouiaId:"empty-recommendations"},o().createElement(f.CardBody,null,o().createElement(Z.A0,null)))),o().createElement(p.Pagination,{ouiaId:"recs-list-pagination-bottom",itemCount:L.length,page:a.offset/a.limit+1,perPage:Number(a.limit),onSetPage:function(e,r){t((0,W.Q4)(S(S({},a),{},{offset:a.limit*(r-1)})))},onPerPageSelect:function(e,r){t((0,W.Q4)(S(S({},a),{},{limit:r,offset:0})))},widgetId:"pagination-options-menu-bottom",variant:p.PaginationVariant.bottom}))}}}]);
//# sourceMappingURL=../sourcemaps/RulesTable.87f0fa133c2dcabd51f8230d630c22d0.js.map