"use strict";(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[6488],{83920:(e,t,a)=>{a.d(t,{Z:()=>i});var r=a(28416),l=a.n(r),n=a(67073),s=a(24561);const i=()=>l().createElement(n.Card,{ouiaId:"loading-skeleton"},l().createElement(n.CardBody,null,l().createElement(s.aV,null)))},33016:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var r=a(28416),l=a.n(r),n=a(86896),s=a(63456),i=a(2550),o=a(11042),c=a(45697),m=a.n(c),u=a(77357),d=a(75863),p=a(35981),y=a(49004),f=a(58027),g=a(13877),h=a(81563),v=a(62410),b=a(56800),E=a(38654),k=a(90766),_=a(77572),w=a(86706),P=a(72668),S=a(18446),C=a.n(S),$=a(57642),x=a(91306),D=a(83920),I=a(95431),T=a.n(I),F=a(8780),N=a(94608);const Z=({hits_by_severity:e,basePath:t})=>{const a=(0,N.Vs)(e,"label");return l().createElement("div",{className:"shield-set"},N.og.map(((e,r)=>l().createElement(F.Tooltip,{key:e.value,content:`${e.label} severity`},e.hasIcon&&(0===a[e.value]?l().createElement("a",{className:"disabled-shield nowrap"},l().createElement(T(),{style:{color:"var(--pf-global--disabled-color--200)"}}),l().createElement("span",null,"0")):l().createElement(b.Link,{key:e.value,to:`${t}?total_risk=${N.og[r].indexNumber}`,className:"nowrap"},l().createElement(T(),{style:{color:e.iconColor}}),l().createElement("span",null,a[e.value])))))))};Z.propTypes={hits_by_severity:m().shape({critical:m().number,important:m().number,moderate:m().number,low:m().number}).isRequired,linkTo:m().string,basePath:m().string};const B=Z,L=({query:{isError:e,error:t,isUninitialized:a,isFetching:n,isSuccess:s,data:i,refetch:o}})=>{const c=(0,w.useDispatch)(),m=(0,w.useSelector)((({filters:e})=>e.workloadsListState)),S=i?.workloads||[],I=m.limit,T=Math.floor(m.offset/m.limit)+1,[F,Z]=(0,r.useState)([]),[L,A]=(0,r.useState)([]),[q,V]=(0,r.useState)(!1),[j,M]=(0,r.useState)(!1),[R,W]=(0,r.useState)(!0),z=e=>c((0,P.$4)(e)),G=a||n||!q,U=e,H=0===L.length,J=s,{search:O}=(0,b.useLocation)();(0,r.useEffect)((()=>{A(K(S))}),[i,m.namespace_name,m.cluster_name,m.severity,m.sortDirection,m.sortIndex]),(0,r.useEffect)((()=>{if(O&&R){const e=(0,$.yG)(O);if(e.sort){const t=(0,$.Lg)(e.sort);e.sortIndex=h.Bk.indexOf(t.name),e.sortDirection=t.direction}e.offset&&(e.offset=Number(e.offset[0])),e.limit&&(e.limit=Number(e.limit[0])),e.impacting&&!Array.isArray(e.impacting)&&(e.impacting=[`${e.impacting}`]),z({...m,...e})}W(!1)}),[]),(0,r.useEffect)((()=>{R||(0,$.aM)(m,h.Bk)}),[m,R]),(0,r.useEffect)((()=>{Z(Q(L)),V(!0),M((0,N.wW)(m))}),[L,m.limit,m.offset]);const K=e=>(V(!1),e.filter((e=>(0,$.U1)(e,m))).sort(((e,t)=>{let a,r;const l="asc"===m.sortDirection?1:-1;switch(m.sortIndex){case h._p:return a=e.cluster?.display_name||e.cluster.uuid,r=t.cluster?.display_name||t.cluster.uuid,l*a.localeCompare(r);case h.cl:return a=e.metadata.recommendations||0,r=t.metadata.recommendations||0,a>r?l:r>a?-l:0;case h.Bh:a=e.metadata.hits_by_severity||{1:0,2:0,3:0,4:0},r=t.metadata.hits_by_severity||{1:0,2:0,3:0,4:0};for(let e=4;e>0;e--){if(a[e]>r[e])return l;if(a[e]<r[e])return-l}return 0;case h.Zg:return a=e.metadata.objects||0,r=t.metadata.objects||0,a>r?l:r>a?-l:0;case h.nU:return a=new Date(e.metadata.last_checked_at||0),r=new Date(t.metadata.last_checked_at||0),a>r?l:r>a?-l:0}}))),Q=e=>e.slice(I*(T-1),I*(T-1)+I).map(((e,t)=>({entity:e,cells:[l().createElement("span",{key:t},l().createElement(b.Link,{to:`${E.G}/workloads/${e.cluster.uuid}/${e.namespace.uuid}`},l().createElement("p",{key:`${t}-cluster`},e.cluster.display_name||e.cluster.uuid),l().createElement("p",{key:`${t}-namespace`},e.namespace.name||e.namespace.uuid))),e.metadata.recommendations,l().createElement("span",{key:t},l().createElement(B,{hits_by_severity:e.metadata.hits_by_severity,basePath:`${E.G}/workloads/${e.cluster.uuid}/${e.namespace.uuid}`})),e.metadata.objects,l().createElement("span",{key:t},l().createElement(v.Z,{extraTitle:"Last seen: ",date:e.metadata.last_checked_at,variant:"relative"}))]}))),X=[{label:"Cluster name",type:"text",filterValues:{key:"cluster_name",onChange:(e,t)=>z({...m,offset:0,cluster_name:t}),value:m.cluster_name,placeholder:"Filter by cluster name"}},{label:"Namespace name",type:"text",filterValues:{key:"namespace_name",onChange:(e,t)=>z({...m,offset:0,namespace_name:t}),value:m.namespace_name,placeholder:"Filter by namespace name"}},{label:"Severity",type:_.conditionalFilterType.checkbox,id:h.Fy.severity.urlParam,value:`checkbox-${h.Fy.severity.urlParam}`,filterValues:{key:`${h.Fy.severity.urlParam}-filter`,onChange:(e,t)=>{return"severity",a=t,(0,$.Lv)(m,z,"severity",a);var a},value:m.severity,items:h.Fy.severity.values,placeholder:"Filter by severity"}}],Y={showDeleteButton:j,deleteTitle:"Reset filters",filters:(0,$.mt)(m,h.Fy),onDelete:(e,t,a)=>{a?C()(m,P.Cz)?o():(0,P.aw)(m,P.Cz,z):t.map((e=>{const t={[e.urlParam]:Array.isArray(m[e.urlParam])?m[e.urlParam].filter((t=>String(t)!==String(e.chips[0].value))):""};var a;t[e.urlParam].length>0?z({...m,...t}):(a=e.urlParam,(0,$.oo)(m,z,a))}))}},ee=(e,t)=>{V(!1);const a=t*m.limit-m.limit;z({...m,offset:a})},te=(e,t)=>{t!==m.limit&&(V(!1),z({...m,limit:t,offset:0}))};return e&&404===t.status||s&&0===S.length?l().createElement(x.sl,null):l().createElement("div",{id:"workloads-list-table"},l().createElement(u.Z,{pagination:{itemCount:L.length,page:T,perPage:I,onSetPage:ee,onPerPageSelect:te,isCompact:!0,ouiaId:"pager"},filterConfig:{items:X},activeFiltersConfig:e?{showDeleteButton:!1}:Y}),l().createElement(p.i,{"aria-label":"Table of workloads",ouiaId:"workloads",ouiaSafe:!G,variant:d.B.compact,cells:h.go,rows:U||G||H?[{fullWidth:!0,cells:[{props:{colSpan:h.go.length+1},title:U?l().createElement(x.Te,null):G?l().createElement(D.Z,null):l().createElement(x.DH,null)}]}]:J?F:l().createElement(x.Te,null),isStickyHeader:!0,sortBy:{index:m.sortIndex,direction:m.sortDirection},onSort:(e,t,a)=>{V(!1),z({...m,sortIndex:t,sortDirection:a})}},l().createElement(y.x,null),l().createElement(f.R,null)),l().createElement(k.Pagination,{ouiaId:"pager",itemCount:L.length,page:T,perPage:I,onSetPage:ee,onPerPageSelect:te,onPageInput:ee,widgetId:"pagination-options-menu-bottom",variant:g.aM.bottom}))};L.propTypes={query:m().object.isRequired};const A=()=>{const e=(0,o.mJ)();return l().createElement(L,{query:e})};var q=a(50318),V=a(55140);const j=()=>{const e=(0,n.Z)();return(0,V.Z)().updateDocumentTitle(e.formatMessage(i.Z.documentTitle,{subnav:"Workloads"})),l().createElement(l().Fragment,null,l().createElement(s.Z,{className:"ins-c-clusters-header"},l().createElement(q.Title,{headingLevel:"h1",ouiaId:"page-header"},"Workloads")),l().createElement("section",{className:"pf-l-page__main-section pf-c-page__main-section"},l().createElement(A,null)))}}}]);
//# sourceMappingURL=../sourcemaps/WorkloadsList.78442e78b78ae3fcd9d2ad43cf1ac1fb.js.map