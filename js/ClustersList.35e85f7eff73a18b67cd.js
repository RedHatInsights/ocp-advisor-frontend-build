(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[9420],{67636:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>V});var n=r(92950),a=r.n(n),o=r(86896),i=r(89376),l=r(30893),s=r(86362),c=r(4942),u=r(70885),f=r(45697),m=r.n(f),d=r(86706),v=r(18446),p=r.n(v),g=r(62012),h=r(45578),y=r.n(h),b=r(81249),_=r(15509),w=r(13877),P=r(76004),Z=r(90111),O=r.n(Z),E=r(62410),S=r(77572),C=r(28672),j=r(59303),k=r(76913),x=r(52661),L=r(51014),I=r(60076);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A=function(e){var t=e.query,r=t.isError,i=t.isUninitialized,s=t.isFetching,f=t.isSuccess,m=t.data,v=t.refetch,h=(0,o.Z)(),Z=(0,d.useDispatch)(),D=function(e){return Z((0,C.$Q)(e))},A=(0,d.useSelector)((function(e){return e.filters.clustersListState})),M=(null==m?void 0:m.data)||[],W=A.offset/A.limit+1,R=(0,n.useState)([]),V=(0,u.Z)(R,2),B=V[0],N=V[1],F=(0,n.useState)([]),U=(0,u.Z)(F,2),q=U[0],G=U[1],H=(0,n.useState)(!1),$=(0,u.Z)(H,2),z=$[0],J=$[1],Q=(0,n.useState)(!0),K=(0,u.Z)(Q,2),X=K[0],Y=K[1],ee=(0,g.useLocation)().search,te=i||s||!z,re=r,ne=M.length>0&&0===B.length,ae=f,oe=function(e,t){return(0,k.Lv)(A,D,e,t)};(0,n.useEffect)((function(){G(le(B)),J(!0)}),[B,A.limit,A.offset]),(0,n.useEffect)((function(){N(ie(M))}),[m,A.text,A.version,A.hits,A.sortDirection,A.sortIndex]),(0,n.useEffect)((function(){if(ee&&X){var e=(0,k.yG)(ee);if(e.sort){var t=(0,k.Lg)(e.sort);e.sortIndex=j.lo.indexOf(t.name),e.sortDirection=t.direction}e.offset&&(e.offset=Number(e.offset[0])),e.limit&&(e.limit=Number(e.limit[0])),e.impacting&&!Array.isArray(e.impacting)&&(e.impacting=["".concat(e.impacting)]),D(T(T({},A),e))}Y(!1)}),[]),(0,n.useEffect)((function(){X||(0,k.aM)(A,j.lo)}),[A,X]);var ie=function(e){J(!1);var t=e.filter((function(e){return(0,k.im)(e,A)})).map((function(e,t){var r,n,o,i;void 0===e.cluster_version||""===e.cluster_version||(0,b.valid)((0,b.coerce)(e.cluster_version))||console.error("Cluster version ".concat(e.cluster_version," has invalid format!"));var s=(0,k.WL)(e.cluster_version);return{entity:e,cells:[a().createElement("span",{key:t},a().createElement(g.Link,{to:"".concat(I.G,"/clusters/").concat(e.cluster_id)},e.cluster_name||e.cluster_id)),"0.0.0"===s?h.formatMessage(l.Z.nA):s,e.total_hit_count,(null===(r=e.hits_by_total_risk)||void 0===r?void 0:r[4])||0,(null===(n=e.hits_by_total_risk)||void 0===n?void 0:n[3])||0,(null===(o=e.hits_by_total_risk)||void 0===o?void 0:o[2])||0,(null===(i=e.hits_by_total_risk)||void 0===i?void 0:i[1])||0,a().createElement("span",{key:t},e.last_checked_at?a().createElement(E.Z,{extraTitle:"".concat(h.formatMessage(l.Z.lastSeen),": "),date:e.last_checked_at,variant:"relative"}):a().createElement(P.Tooltip,{key:t,content:a().createElement("span",null,h.formatMessage(l.Z.lastSeen)+": ",h.formatMessage(l.Z.nA))},a().createElement("span",null,h.formatMessage(l.Z.nA))))]}}));return-1===A.sortIndex?t:t.sort((function(e,t){var r,n,a=A.sortDirection===_.SortByDirection.asc?1:-1;switch(A.sortIndex){case j.v7:return r=e.entity.cluster_name||e.entity.cluster_id,n=t.entity.cluster_name||t.entity.cluster_id,r.localeCompare(n)?r.localeCompare(n)*a:0;case j._s:return(0,k._)((0,k.WL)(e.entity.cluster_version),(0,k.WL)(t.entity.cluster_version),a);case j.CL:return(r=new Date(e.entity.last_checked_at||0))>(n=new Date(t.entity.last_checked_at||0))?a:n>r?-a:0;default:return(r=e.cells[A.sortIndex])>(n=t.cells[A.sortIndex])?a:n>r?-a:0}}))},le=function(e){return e.slice(A.limit*(W-1),A.limit*(W-1)+A.limit)},se=[{label:h.formatMessage(l.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return D(T(T({},A),{},{offset:0,text:t}))},value:A.text,placeholder:h.formatMessage(l.Z.filterByName)}},{label:h.formatMessage(l.Z.version),placeholder:h.formatMessage(l.Z.filterByVersion),type:S.conditionalFilterType.checkbox,filterValues:{id:"version-filter",key:"version-filter",onChange:function(e,t){return oe("version",t)},value:A.version,items:y()(M.filter((function(e){return void 0!==e.cluster_version&&""!==e.cluster_version})).map((function(e){return{value:(0,k.WL)(e.cluster_version)}})).sort((function(e,t){return(0,k._)((0,k.WL)(e.cluster_version),(0,k.WL)(t.cluster_version),1)})).reverse(),"value")}},{label:j.RT.hits.title,type:j.RT.hits.type,id:j.RT.hits.urlParam,value:"checkbox-".concat(j.RT.hits.urlParam),filterValues:{key:"".concat(j.RT.hits.urlParam,"-filter"),onChange:function(e,t){return oe(j.RT.hits.urlParam,t)},value:A.hits,items:j.RT.hits.values}}],ce={showDeleteButton:!0,deleteTitle:h.formatMessage(l.Z.resetFilters),filters:(0,k.mt)(A,j.RT),onDelete:function(e,t,r){r?p()(A,C.Ly)?v():(0,C.aw)(A,C.Ly,D):t.map((function(e){var t,r=(0,c.Z)({},e.urlParam,Array.isArray(A[e.urlParam])?A[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");r[e.urlParam].length>0?D(T(T({},A),r)):(t=e.urlParam,(0,k.oo)(A,D,t))}))}};return a().createElement(a().Fragment,null,f&&0===M.length?a().createElement(L.ER,null):a().createElement("div",{id:"clusters-list-table","data-ouia-safe":!te},a().createElement(O(),{pagination:{itemCount:B.length,page:W,perPage:A.limit,onSetPage:function(e,t){return J(!1),D(T(T({},A),{},{offset:A.limit*(t-1)}))},onPerPageSelect:function(e,t){return J(!1),D(T(T({},A),{},{limit:t,offset:0}))},isCompact:!0,ouiaId:"pager"},filterConfig:{items:se},activeFiltersConfig:ce}),a().createElement(_.Table,{"aria-label":"Table of clusters",ouiaId:"clusters",ouiaSafe:!te,variant:_.TableVariant.compact,cells:j.Bg,rows:re||te||ne?[{fullWidth:!0,cells:[{props:{colSpan:j.Bg.length+1},title:re?a().createElement(L.Te,null):te?a().createElement(x.Z,null):a().createElement(L.VA,null)}]}]:ae?q:a().createElement(L.Te,null),sortBy:{index:A.sortIndex,direction:A.sortDirection},onSort:function(e,t,r){J(!1),D(T(T({},A),{},{sortIndex:t,sortDirection:r}))},isStickyHeader:!0},a().createElement(_.TableHeader,null),a().createElement(_.TableBody,null)),a().createElement(w.tl,{ouiaId:"pager",itemCount:B.length,page:A.offset/A.limit+1,perPage:Number(A.limit),onSetPage:function(e,t){return D(T(T({},A),{},{offset:A.limit*(t-1)}))},onPerPageSelect:function(e,t){return D(T(T({},A),{},{limit:t,offset:0}))},widgetId:"pagination-options-menu-bottom",variant:w.aM.bottom})))};A.propTypes={query:m().object.isRequired};const M=function(){var e=(0,s.Oj)();return a().createElement(A,{query:e})};var W=r(34348),R=r(55140);const V=function(){var e=(0,o.Z)();return(0,R.Z)().updateDocumentTitle(e.formatMessage(l.Z.documentTitle,{subnav:e.formatMessage(l.Z.clusters)})),a().createElement(a().Fragment,null,a().createElement(i.Z,{className:"ins-c-clusters-header"},a().createElement(W.Dx,{headingLevel:"h1",ouiaId:"page-header"},"".concat(e.formatMessage(l.Z.insightsHeader)," ").concat(e.formatMessage(l.Z.clusters).toLowerCase()))),a().createElement("section",{className:"pf-l-page__main-section pf-c-page__main-section"},a().createElement(M,null)))}},76913:(e,t,r)=>{"use strict";r.d(t,{Lg:()=>P,Lv:()=>C,U1:()=>j,WL:()=>E,_:()=>O,_F:()=>y,aM:()=>Z,im:()=>b,mt:()=>_,oo:()=>S,yG:()=>w});var n=r(71002),a=r(45987),o=r(4942),i=r(42982),l=r(70885),s=r(48403),c=r.n(s),u=r(50361),f=r.n(u),m=(r(92950),r(81249)),d=r(59303),v=r(29299);function p(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!==(0,n.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===(0,n.Z)(t)?t:String(t)}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y=function(e,t){return Object.entries(t).every((function(t){var r=(0,l.Z)(t,2),n=r[0],a=r[1];switch(n){case"text":return e.description.toLowerCase().includes(a.toLowerCase());case d.W2.total_risk.urlParam:return a.includes(String(e.total_risk));case d.W2.category.urlParam:return e.tags.find((function(e){return a.includes(String(d.kT[e]))}));case d.W2.impact.urlParam:return a.includes(String(e.impact));case d.W2.impacting.urlParam:return!(a.length>0)||a.some((function(t){return"true"===t?e.impacted_clusters_count>0:"false"===t?0===e.impacted_clusters_count:void 0}));case d.W2.likelihood.urlParam:return a.includes(String(e.likelihood));case d.W2.rule_status.urlParam:return"all"===a||"disabled"===a&&e.disabled||"enabled"===a&&!e.disabled;case d.W2.res_risk.urlParam:return a.includes(String(e.resolution_risk));default:return!0}}))},b=function(e,t){return Object.entries(t).every((function(t){var r=(0,l.Z)(t,2),n=r[0],a=r[1];switch(n){case"text":return(e.cluster_name||e.cluster_id).toLowerCase().includes(a.toLowerCase());case d.RT.hits.urlParam:return 0===a.length&&parseInt(e.total_hit_count)>0||a.includes("all")||a.some((function(t){return e.hits_by_total_risk[t]>0}));case"version":return 0===a.length||a.includes(E(e.cluster_version));default:return!0}}))},_=function(e,t){var r=f()(e);return delete r.sortIndex,delete r.sortDirection,delete r.sort,delete r.offset,delete r.limit,(null==r?void 0:r.hits)&&0===r.hits.length&&delete r.hits,function(e,t){return Object.entries(e||{}).reduce((function(e,r){var n=(0,l.Z)(r,2),a=n[0],o=n[1];if(t[a]){var s=t[a],u=Array.isArray(o)?o.map((function(e){var t=s.values.find((function(t){return t.value===String(e)}));return t?{name:t.text||t.label,value:e}:{name:e,value:e}})):[{name:s.values.find((function(e){return e.value===String(o)})).label,value:o}];return[].concat((0,i.Z)(e),[{category:c()(s.title),chips:u,urlParam:s.urlParam}])}return"text"===a?[].concat((0,i.Z)(e),(0,i.Z)(o.length>0?[{category:"Name",chips:[{name:o,value:o}],urlParam:a}]:[])):"version"===a?[].concat((0,i.Z)(e),(0,i.Z)(o.length>0?[{category:"Version",chips:o.map((function(e){return{name:e,value:e}})),urlParam:a}]:[])):"namespace_name"===a?[].concat((0,i.Z)(e),(0,i.Z)(o.length>0?[{category:"Namespace name",chips:[{name:o,value:o}],urlParam:a}]:[])):"cluster_name"===a?[].concat((0,i.Z)(e),(0,i.Z)(o.length>0?[{category:"Cluster name",chips:[{name:o,value:o}],urlParam:a}]:[])):void 0}),[])}(r,t)},w=function(e){var t=new URLSearchParams(e);return Array.from(t).reduce((function(e,t){var r=(0,l.Z)(t,2),n=r[0],a=r[1];return h(h({},e),{},(0,o.Z)({},n,["text","first","rule_status","sort","cluster_name","namespace_name"].includes(n)?a:"true"===a||"false"===a?JSON.parse(a):a.split(",")))}),{})},P=function(e){return{name:e.substring(e.startsWith("-")?1:0),direction:e.startsWith("-")?"desc":"asc"}},Z=function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0,o=new URL(window.location.origin+window.location.pathname);o.searchParams.set("sort",(e=n.sortIndex,t=a,r=n.sortDirection,["desc","asc"].includes(r)||console.error("Invalid sort parameters (is not asc nor desc)"),"".concat("asc"===r?"":"-").concat(t[e]))),Object.entries(n).forEach((function(e){var t=(0,l.Z)(e,2),r=t[0],n=t[1];return"sortIndex"!==r&&"sortDirection"!==r&&"sort"!==r&&""!==n&&!(Array.isArray(n)&&0===n.length)&&o.searchParams.set(r,n)})),window.history.replaceState(null,null,o.href)},O=function(e,t,r){return r*(0,m.compare)(e,t)},E=function(e){return(0,m.coerce)(void 0!==e&&(0,m.valid)((0,m.coerce)(e))?e:"0.0.0").version},S=function(e,t,r){var n=h(h({},e),{},{offset:0});n[r],t(h(h({},(0,a.Z)(n,[r].map(p))),"text"===r?{text:""}:"hits"===r?{hits:[]}:"version"===r?{version:[]}:{}))},C=function(e,t,r,n){return n.length>0?t(h(h({},e),{},{offset:0},(0,o.Z)({},r,n))):S(e,t,r)},j=function(e,t){var r=(0,v.Vs)(e.metadata.hits_by_severity,"general");return Object.entries(t).every((function(n){var a=(0,l.Z)(n,2),o=a[0],i=a[1];switch(o){case"cluster_name":return(e.cluster.display_name||e.cluster.uuid).toLowerCase().includes(i.toLowerCase());case"namespace_name":return(e.namespace.name||e.namespace.uuid).toLowerCase().includes(i.toLowerCase());case"general_severity":return 0===i.length||(0,v.mR)(r,t.general_severity);default:return!0}}))}},52661:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(92950),a=r.n(n),o=r(2095),i=r(85962),l=r(24561);const s=function(){return a().createElement(o.Card,{ouiaId:"loading-skeleton"},a().createElement(i.CardBody,null,a().createElement(l.aV,null)))}},29299:(e,t,r)=>{"use strict";r.d(t,{Vs:()=>l,g0:()=>c,mR:()=>s,og:()=>i});var n=r(44439),a=r.n(n);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i=[{value:"critical",label:"Critical",iconColor:"var(--pf-global--danger-color--100)",textColor:"var(--pf-global--danger-color--100)",hasIcon:!0},{value:"important",label:"Important",iconColor:"var(--pf-global--palette--orange-300)",textColor:"var(--pf-global--palette--orange-400)",hasIcon:!0},{value:"moderate",label:"Moderate",iconColor:"var(--pf-global--warning-color--100)",textColor:"var(--pf-global--warning-color--200)",hasIcon:!0},{value:"low",label:"Low",iconColor:"var(--pf-global--Color--200)",textColor:"var(--pf-global--default-color--300)",hasIcon:!0},{value:"none",label:"Unknown"}],l=function(e,t){var r={1:"low",2:"moderate",3:"important",4:"critical"},n={};if("general"===t||"label"===t)for(var a in e)a in r&&(n[r[a]]=e[a]);else n=r[e];return n},s=function(e,t){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){s=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(s)throw i}}}}(t);try{for(n.s();!(r=n.n()).done;)if(e[r.value]>0)return!0}catch(e){n.e(e)}finally{n.f()}},c=function(e){var t=a().cloneDeep(e);return delete t.sortIndex,delete t.sortDirection,delete t.offset,delete t.limit,Object.values(t).filter((function(e){return!(0,n.isEmpty)(e)}))}},80598:()=>{},28992:()=>{},30187:()=>{},93398:()=>{},46928:()=>{}}]);
//# sourceMappingURL=../sourcemaps/ClustersList.988853ccf79b9e3e62812ff9bd5074e9.js.map