(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[619],{70038:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ye});var l=a(93264),r=a.n(l),n=a(36873),i=a(86896),s=a(86362);const o=(0,a(50049).vU)({documentTitle:{id:"documentTitle",defaultMessage:[{type:1,value:"subnav"},{type:0,value:" - OCP Advisor | Red Hat Insights"}]},clusters:{id:"clusters",defaultMessage:[{type:0,value:"Clusters"}]},added:{id:"added",defaultMessage:[{type:0,value:"Added"}]},loading:{id:"loading",defaultMessage:[{type:0,value:"Loading"}]},lastSeen:{id:"lastSeen",defaultMessage:[{type:0,value:"Last seen"}]},actions:{id:"actions",defaultMessage:[{type:0,value:"Actions"}]},name:{id:"name",defaultMessage:[{type:0,value:"Name"}]},filterBy:{id:"filterBy",defaultMessage:[{type:0,value:"Filter by name"}]},totalRisk:{id:"totalRisk",defaultMessage:[{type:0,value:"Total risk"}]},recommendation:{id:"recommendation",defaultMessage:[{type:0,value:"Recommendation"}]},recommendations:{id:"recommendations",defaultMessage:[{type:0,value:"Recommendations"}]},insightsHeader:{id:"insightsHeader",defaultMessage:[{type:0,value:"Advisor"}]},unknown:{id:"unknown",defaultMessage:[{type:0,value:"Unknown"}]},low:{id:"low",defaultMessage:[{type:0,value:"Low"}]},moderate:{id:"moderate",defaultMessage:[{type:0,value:"Moderate"}]},important:{id:"important",defaultMessage:[{type:0,value:"Important"}]},critical:{id:"critical",defaultMessage:[{type:0,value:"Critical"}]},veryLow:{id:"veryLow",defaultMessage:[{type:0,value:"Very Low"}]},medium:{id:"medium",defaultMessage:[{type:0,value:"Medium"}]},high:{id:"high",defaultMessage:[{type:0,value:"High"}]},serviceAvailability:{id:"serviceAvailability",defaultMessage:[{type:0,value:"Service Availability"}]},performance:{id:"performance",defaultMessage:[{type:0,value:"Performance"}]},faultTolerance:{id:"faultTolerance",defaultMessage:[{type:0,value:"Fault Tolerance"}]},security:{id:"security",defaultMessage:[{type:0,value:"Security"}]},osdEligible:{id:"osdEligible",defaultMessage:[{type:0,value:"OSD Eligible"}]},enabled:{id:"enabled",defaultMessage:[{type:0,value:"Enabled"}]},impact:{id:"impact",defaultMessage:[{type:0,value:"Impact"}]},impactLevel:{id:"impactLevel",defaultMessage:[{type:1,value:"level"},{type:0,value:" impact"}]},impactDescription:{id:"impactDescription",defaultMessage:[{type:0,value:"The impact of the problem would be "},{type:1,value:"level"},{type:0,value:" if it occurred."}]},category:{id:"category",defaultMessage:[{type:0,value:"Category"}]},likelihood:{id:"likelihood",defaultMessage:[{type:0,value:"Likelihood"}]},likelihoodLevel:{id:"likelihoodLevel",defaultMessage:[{type:1,value:"level"},{type:0,value:" likelihood"}]},likelihoodDescription:{id:"likelihoodDescription",defaultMessage:[{type:0,value:"The likelihood that this will be a problem is "},{type:1,value:"level"},{type:0,value:"."}]},all:{id:"all",defaultMessage:[{type:0,value:"All"}]},disabled:{id:"disabled",defaultMessage:[{type:0,value:"Disabled"}]},resetFilters:{id:"resetFilters",defaultMessage:[{type:0,value:"Reset filters"}]},noMatchingRecommendations:{id:"noMatchingRecommendations",defaultMessage:[{type:0,value:"No matching recommendations found"}]},noMatchingRecommendationsDesc:{id:"noMatchingRecommendationsDesc",defaultMessage:[{type:0,value:"This filter criteria matches no recommendations. Try changing your filter settings."}]},noRecommendations:{id:"noRecommendations",defaultMessage:[{type:0,value:"None of your connected systems are affected by any known recommendations."}]},noRecommendationsDesc:{id:"noRecommendationsDesc",defaultMessage:[{type:0,value:"No known recommendations affect this cluster."}]},ruleIsDisabledTooltip:{id:"ruleIsDisabledTooltip",defaultMessage:[{type:0,value:"Indicates this recommendation will not be shown for the cluster."}]}});var c=a(45697),u=a.n(c),m=a(58788),d=a(48794),f=a(48716),p=a(86350),g=a(44034),v=a(43),y=a(56455),b=function(e){var t=e.clusterId,a=e.lastSeen,l=e.displayName,n=(0,i.Z)(),s=l.isUninitialized,c=l.isLoading,u=l.isFetching,d=l.data;return r().createElement(r().Fragment,null,r().createElement(m.Grid,{md:12,hasGutter:!0},r().createElement(m.GridItem,null,s||c||u?r().createElement(y.Z,{size:"sm"}):r().createElement(m.Title,{size:"2xl",headingLevel:"h1"},d||t)),r().createElement(m.GridItem,null,r().createElement(m.Stack,null,r().createElement(m.StackItem,null,r().createElement("span",null,"UUID: "),r().createElement("span",null,t||n.formatMessage(o.unknown))),r().createElement(m.StackItem,null,r().createElement("span",null,n.formatMessage(o.lastSeen),": "),r().createElement("span",null,a||n.formatMessage(o.unknown)))))))};b.propTypes={clusterId:u().string.isRequired,displayName:u().object.isRequired,lastSeen:u().string};const h=(0,g.xp)((function(e){var t,a=e.match.params.clusterId,l=(0,v.u)(a),n=(0,s.y0)(a).data;return r().createElement(b,{clusterId:a,displayName:l,lastSeen:null==n||null===(t=n.report)||void 0===t?void 0:t.lastSeen})}));var M=a(96156),k=a(85061),E=a(28481),Z=a(44535),P=a(26899),_=a(78216),w=a(94550),O=a(57277),S=a(219),T=a(96733),j=a(74183),C=a(86728),D=a(34348),I=function(e){var t=e.className,a=e.children,l=e.icon,n=e.iconClass,i=e.iconStyle,s=e.text,o=e.title,c=e.variant;return r().createElement(S.ub,{className:t,variant:c},"none"!==l&&r().createElement(C.k,{className:n,style:i,icon:l}),r().createElement(D.Title,{headingLevel:"h5",size:"lg"},o),r().createElement(j.B,{style:{marginBottom:"16px"}},s),a)};I.propTypes={children:u().any,icon:u().any,iconClass:u().any,iconStyle:u().any,text:u().any,title:u().string,variant:u().any,className:u().string},I.defaultProps={icon:T.ZP,title:"",variant:S.IQ.full};const R=I;var x=a(82644),L=a(29558),N=a(13976),A=(0,x.Sn)(),F=navigator.language.slice(0,2),B=(0,L.d)({onError:console.error,locale:F},A),G={locale:F},H={1:(0,N.Z)(B.formatMessage(o.low),G),2:(0,N.Z)(B.formatMessage(o.medium),G),3:(0,N.Z)(B.formatMessage(o.high),G),4:(0,N.Z)(B.formatMessage(o.critical),G)},V={1:(0,N.Z)(B.formatMessage(o.low),G),2:(0,N.Z)(B.formatMessage(o.medium),G),3:(0,N.Z)(B.formatMessage(o.high),G),4:(0,N.Z)(B.formatMessage(o.critical),G)},q={1:(0,N.Z)(B.formatMessage(o.low),G),2:(0,N.Z)(B.formatMessage(o.moderate),G),3:(0,N.Z)(B.formatMessage(o.important),G),4:(0,N.Z)(B.formatMessage(o.critical),G)},z={1:(0,N.Z)(B.formatMessage(o.veryLow),G),2:(0,N.Z)(B.formatMessage(o.low),G),3:(0,N.Z)(B.formatMessage(o.moderate),G),4:(0,N.Z)(B.formatMessage(o.high),G)},U={service_availability:1,security:2,fault_tolerance:3,performance:4,osd_eligible:5},W={total_risk:{type:"checkbox",title:"total risk",urlParam:"total_risk",values:[{label:q[4],value:"4"},{label:q[3],value:"3"},{label:q[2],value:"2"},{label:q[1],value:"1"}]},res_risk:{type:"checkbox",title:"risk of change",urlParam:"res_risk",values:[{label:z[4],value:"4"},{label:z[3],value:"3"},{label:z[2],value:"2"},{label:z[1],value:"1"}]},impact:{type:"checkbox",title:"impact",urlParam:"impact",values:[{label:V[4],value:"4"},{label:V[3],value:"3"},{label:V[2],value:"2"},{label:V[1],value:"1"}]},likelihood:{type:"checkbox",title:"likelihood",urlParam:"likelihood",values:[{label:H[4],value:"4"},{label:H[3],value:"3"},{label:H[2],value:"2"},{label:H[1],value:"1"}]},rule_status:{type:"radio",title:"status",urlParam:"rule_status",values:[{label:(0,N.Z)(B.formatMessage(o.all),G),value:"all"},{label:(0,N.Z)(B.formatMessage(o.enabled),G),value:"enabled"},{label:(0,N.Z)(B.formatMessage(o.disabled),G),value:"disabled"}]},category:{type:"checkbox",title:"category",urlParam:"category",values:[{label:(0,N.Z)(B.formatMessage(o.serviceAvailability),G),value:"".concat(U.service_availability)},{label:(0,N.Z)(B.formatMessage(o.performance),G),value:"".concat(U.performance)},{label:(0,N.Z)(B.formatMessage(o.faultTolerance),G),value:"".concat(U.fault_tolerance)},{label:(0,N.Z)(B.formatMessage(o.security),G),value:"".concat(U.security)},{label:(0,N.Z)(B.formatMessage(o.osdEligible),G),value:"".concat(U.osd_eligible)}]}},Q=(0,M.Z)({},W.rule_status.urlParam,"enabled"),J=a(22663);function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(Object(a),!0).forEach((function(t){(0,M.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Y=function(e){var t=e.report;return r().createElement("div",{className:"advisor"},r().createElement(J.Z,{appName:"advisor",module:"./AdvisorReportDetails",report:X(X({},t),{},{details:t.extra_data,resolution:{resolution:t.resolution}})}))};Y.propTypes={report:u().object.isRequired};const $=Y;var ee=a(76004),te=a(23218),ae=function(e){var t=e.rule,a=(0,i.Z)();return r().createElement(r().Fragment,null,t.disabled&&r().createElement(ee.Tooltip,{content:a.formatMessage(o.ruleIsDisabledTooltip),position:ee.TooltipPosition.right},r().createElement(te._,{color:"gray"},a.formatMessage(o.disabled))))};ae.propTypes={rule:u().object};const le=ae;function re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function ne(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?re(Object(a),!0).forEach((function(t){(0,M.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):re(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ie=function(e){var t,a,n=e.reports,s=(0,i.Z)(),c=(0,l.useState)([]),u=(0,E.Z)(c,2),d=u[0],f=u[1],p=(0,l.useState)({}),g=(0,E.Z)(p,2),v=g[0],y=g[1],b=(0,l.useState)(Q),h=(0,E.Z)(b,2),S=h[0],T=h[1],j=(0,l.useState)(""),C=(0,E.Z)(j,2),D=C[0],I=C[1],x=(0,l.useState)(!1),L=(0,E.Z)(x,2),N=L[0],A=L[1],F=(0,l.useState)([]),B=(0,E.Z)(F,2),G=B[0],q=B[1],z=G?G.length/2:0,J=[{title:s.formatMessage(o.name),transforms:[w.sortable]},{title:s.formatMessage(o.added),transforms:[w.sortable,(0,w.cellWidth)(15)]},{title:s.formatMessage(o.totalRisk),transforms:[w.sortable,(0,w.cellWidth)(15)]}],K=function(e,t,a){var l=(0,k.Z)(G);l[t]=ne(ne({},l[t]),{},{isOpen:a}),q(l)},X=function(e){var t="insights-expand-all"===e,a=(0,k.Z)(G);a.map((function(e,a){Object.prototype.hasOwnProperty.call(e,"isOpen")&&(e.isOpen=t,t&&K(0,a,t))})),q(a)},Y=[{label:"Collapse all",onClick:function(){return X("insights-collapse-all")}},{label:"Expand all",onClick:function(){return X("insights-expand-all")}}],ee=function(e,t,a){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=e.flatMap((function(e,n){var i=e,s=e.resolution,o=a.filter((function(e,t){return t%2==0&&e.rule.rule_id===i.rule_id&&e})),c=!!o.length&&o[0].selected,u=a.length?!!o.length&&o[0].isOpen:0===n,d=[{rule:i,resolution:s,isOpen:u,selected:c,cells:[{title:r().createElement("div",null,i.description," ",r().createElement(le,{rule:e}))},{title:r().createElement("div",{key:n},r().createElement(P.Z,{date:i.created_at,type:"relative",tooltipProps:{position:m.TooltipPosition.bottom}}))},{title:r().createElement("div",{key:n,style:{verticalAlign:"top"}},r().createElement(m.Tooltip,{key:n,position:m.TooltipPosition.bottom,content:r().createElement("span",null,"The ",r().createElement("strong",null,"likelihood")," that this will be a problem is"," ",i.likelihood?H[i.likelihood]:"unknown",". The ",r().createElement("strong",null,"impact")," of the problem would be"," ",i.impact?V[i.impact]:"unknown"," if it occurred.")},r().createElement(_.Z,{value:i.total_risk})))}]},{parent:n,fullWidth:!0,cells:[{title:r().createElement($,{key:"child-".concat(n),report:e})}]}],f=0===l.length||i.description.toLowerCase().includes(l.toLowerCase()),p=0===Object.keys(t).length||Object.keys(t).map((function(e){var a=t[e],l={created_at:i.created_at,total_risk:i.total_risk,category:i.tags,rule_status:i.disabled?"disabled":"enabled"};return"category"===e?l[e].find((function(e){return a.includes(String(U[e]))})):"rule_status"===e?"all"===a||l[e]===a:a.find((function(t){return String(t)===String(l[e])}))})).every((function(e){return e}));return f&&p?d:[]}));return n.forEach((function(e,t){return e.parent?e.parent=t-1:null})),n},te=function(e){return e.filter((function(e){return e.selected}))}(G).length,ae=function(e){A(e),q(ee(d,S,G.map((function(t,a){return a%2==0?ne(ne({},t),{},{selected:e}):t})),D))},re={items:[{title:"Select none",onClick:function(){return ae(!1)}},{title:"Select all",onClick:function(){return ae(!0)}}],count:te,checked:N,onSelect:function(){return ae(!N)}},ie=function(e,t){var a=t.length>0?ne(ne({},S),(0,M.Z)({},e,t)):function(e){var t=ne({},S);return delete t[e],t}(e);q(ee(d,a,G,D)),T(a)},se=[{label:"name",filterValues:{key:"text-filter",onChange:function(e,t){return function(e){var t=ee(d,S,G,e);I(e),q(t)}(t)},value:D}},{label:W.total_risk.title,type:W.total_risk.type,id:W.total_risk.urlParam,value:"checkbox-".concat(W.total_risk.urlParam),filterValues:{key:"".concat(W.total_risk.urlParam,"-filter"),onChange:function(e,t){return ie(W.total_risk.urlParam,t)},value:S.total_risk,items:W.total_risk.values}},{label:W.category.title,type:W.category.type,id:W.category.urlParam,value:"checkbox-".concat(W.category.urlParam),filterValues:{key:"".concat(W.category.urlParam,"-filter"),onChange:function(e,t){return ie(W.category.urlParam,t)},value:S.category,items:W.category.values}},{label:W.rule_status.title,type:W.rule_status.type,id:W.rule_status.urlParam,value:"radio-".concat(W.rule_status.urlParam),filterValues:{key:"".concat(W.rule_status.urlParam,"-filter"),onChange:function(e,t){return a=t,l=ne(ne({},S),{},{rule_status:a}),q(ee(d,l,G,D)),void T(l);var a,l},value:S.rule_status,items:W.rule_status.values}}],oe={deleteTitle:s.formatMessage(o.resetFilters),filters:(t=Object.entries(S),a=S&&t.length>0?t.map((function(e){var t=W[e[0]],a=Array.isArray(e[1])?e[1].map((function(e){return{name:t.values.find((function(t){return t.value===String(e)})).label,value:e}})):[{name:t.values.find((function(t){return t.value===String(e[1])})).label,value:e[1]}];return{category:(0,m.capitalize)(t.title),chips:a,urlParam:t.urlParam}})):[],D.length>0&&a.push({category:"Name",chips:[{name:D,value:D}]}),a),onDelete:function(e,t,a){a?(q(ee(d,{},G,"")),T(Q),I("")):t.map((function(e){switch(e.category){case"Name":q(ee(d,S,G,"")),I("");break;case"Status":ie(e.urlParam,[]);break;default:ie(e.urlParam,S[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})))}}))}};return(0,l.useEffect)((function(){var e=n;f(e),q(ee(e,S,G,D))}),[]),r().createElement("div",null,r().createElement(O.Z,{actionsConfig:{actions:Y},bulkSelect:re,filterConfig:{items:se},pagination:r().createElement(r().Fragment,null,1===z?"".concat(z," ").concat(s.formatMessage(o.recommendation)):"".concat(z," ").concat(s.formatMessage(o.recommendations))),activeFiltersConfig:oe}),d.length>0?r().createElement(r().Fragment,null,r().createElement(w.Table,{"aria-label":"Cluster recommendations table",onSelect:function(e,t,a){return q(ee(d,S,G.map((function(e,l){return l===a?ne(ne({},e),{},{selected:t}):e})),D))},onCollapse:K,rows:G,cells:J,sortBy:v,canSelectAll:!1,onSort:function(e,t,a){var l={2:"description",3:"created_at",4:"total_risk"},r=function(){return d.concat().sort((function(e,a){return e[l[t]]>a[l[t]]?1:a[l[t]]>e[l[t]]?-1:0}))},n=a===w.SortByDirection.asc?r():r().reverse();f(n),y({index:t,direction:a}),q(ee(n,S,G,D))},variant:w.TableVariant.compact,isStickyHeader:!0},r().createElement(w.TableHeader,null),r().createElement(w.TableBody,null)),0===z&&r().createElement(m.Card,null,r().createElement(m.CardBody,null,r().createElement(R,{title:s.formatMessage(o.noMatchingRecommendations),text:s.formatMessage(o.noMatchingRecommendationsDesc)})))):r().createElement(m.Card,null,r().createElement(m.CardBody,null,r().createElement(R,{icon:Z.ZP,iconClass:"ins-c-insights__check",title:s.formatMessage(o.noRecommendations),text:s.formatMessage(o.noRecommendationsDesc)}))))};ie.propTypes={reports:u().array.isRequired},ie.defaultProps={reports:[]};const se=ie;var oe=a(85991),ce=a(49489),ue=function(e){var t=e.current,a=e.match,n=(0,i.Z)(),s=(0,l.useState)([]),c=(0,E.Z)(s,2),u=c[0],m=c[1],d=(0,l.useCallback)((function(){var e=[],t=a.url.split("/");e.push({title:"".concat(n.formatMessage(o.insightsHeader)," ").concat(t[1]),navigate:"/".concat(t[1])}),m(e)}),[n,a.params.clusterId,a.url]);return(0,l.useEffect)((function(){d()}),[d,a.params.clusterId,a.url]),r().createElement(r().Fragment,null,u.length>0&&r().createElement(oe.a,{ouiaId:"detail"},u.map((function(e,t){return r().createElement(ce.g,{key:t},r().createElement("span",null,e.title))})),r().createElement(ce.g,{isActive:!0},t)))};ue.propTypes={current:u().string,match:u().object};const me=(0,n.Z)((function(e){var t=e.match,a=e.current;return r().createElement(ue,{current:a,match:t})}));var de=a(2095),fe=a(85962),pe=a(24561);const ge=function(){return r().createElement(de.Zb,null,r().createElement(fe.e,null,r().createElement(pe.aV,null)))};var ve=function(e){var t,a=e.cluster,l=e.match,n=a.isError,i=a.isUninitialized,s=a.isLoading,o=a.isFetching,c=a.isSuccess,u=a.data;return r().createElement(r().Fragment,null,r().createElement(f.Z,{className:"pf-m-light ins-inventory-detail"},r().createElement(me,{current:l.params.clusterId,match:l}),r().createElement(h,null)),r().createElement(p.Z,null,r().createElement(r().Fragment,null,n&&r().createElement(R,{title:"No recommendations available",text:"There was an error fetching recommendations for this cluster. Refresh your page to try again.",icon:d.ZP}),(i||s||o)&&r().createElement(ge,null),c&&r().createElement(m.Grid,{hasGutter:!0},r().createElement(m.GridItem,{span:12},r().createElement(se,{reports:(null==u||null===(t=u.report)||void 0===t?void 0:t.data)||[]}))))))};ve.propTypes={cluster:u().object.isRequired,match:u().object.isRequired};const ye=(0,n.Z)((function(e){var t=e.match,a=(0,i.Z)(),n=(0,s.th)(t.params.clusterId);return(0,l.useEffect)((function(){n.refetch()}),[t.params.clusterId]),(0,l.useEffect)((function(){if(t.params.clusterId){var e="".concat(t.params.clusterId," - ").concat(a.formatMessage(o.clusters));document.title=a.formatMessage(o.documentTitle,{subnav:e})}}),[t.params.clusterId]),r().createElement(ve,{cluster:n,match:t})}))}}]);
//# sourceMappingURL=../sourcemaps/ClusterDetails.e0f9fd477bae4287a2bd.js.map