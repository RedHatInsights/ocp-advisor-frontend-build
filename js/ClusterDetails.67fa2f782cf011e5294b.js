(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[619],{20098:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ee});var r=n(93264),a=n.n(r),l=n(86896),c=n(45697),i=n.n(c),o=n(88931),s=n(58788),u=n(48794),m=n(48716),f=n(86350),p=n(36873),d=n(30893),g=function(e){var t=e.uuid,n=e.lastSeen,r=(0,l.Z)();return a().createElement(a().Fragment,null,a().createElement(s.Grid,{md:12,hasGutter:!0},a().createElement(s.GridItem,null,a().createElement(s.Title,{size:"2xl",headingLevel:"h1"},t)),a().createElement(s.GridItem,null,a().createElement(s.Stack,null,a().createElement(s.StackItem,null,a().createElement("span",null,"UUID: "),a().createElement("span",null,t||r.formatMessage(d.Z.unknown))),a().createElement(s.StackItem,null,a().createElement("span",null,r.formatMessage(d.Z.lastSeen),": "),a().createElement("span",null,n||r.formatMessage(d.Z.unknown)))))))};g.propTypes={uuid:i().string.isRequired,lastSeen:i().string};const h=g;var v=n(96156),E=n(85061),y=n(28481),b=n(24561),k=n(44535),O=n(77669),S=n(26899),Z=n(78216),P=n(94550),j=n(57277),C=n(219),w=n(96733),_=n(74183),T=n(86728),I=n(34348),x=function(e){var t=e.className,n=e.children,r=e.icon,l=e.iconClass,c=e.iconStyle,i=e.text,o=e.title,s=e.variant;return a().createElement(C.ub,{className:t,variant:s},"none"!==r&&a().createElement(T.k,{className:l,style:c,icon:r}),a().createElement(I.Title,{headingLevel:"h5",size:"lg"},o),a().createElement(_.B,{style:{marginBottom:"16px"}},i),n)};x.propTypes={children:i().any,icon:i().any,iconClass:i().any,iconStyle:i().any,text:i().any,title:i().string,variant:i().any,className:i().string},x.defaultProps={icon:w.ZP,title:"",variant:C.IQ.full};const D=x;var N=n(59303),M=n(22663);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,v.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e){var t=e.report;return a().createElement("div",{className:"advisor"},a().createElement(M.Z,{appName:"advisor",module:"./AdvisorReportDetails",report:B(B({},t),{},{details:t.extra_data,resolution:{resolution:t.resolution}})}))};F.propTypes={report:i().object.isRequired};const R=F;function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){(0,v.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=function(e){var t=e.cluster,n=(0,l.Z)(),c=(0,r.useState)([]),i=(0,y.Z)(c,2),o=i[0],u=i[1],m=(0,r.useState)({}),f=(0,y.Z)(m,2),p=f[0],g=f[1],h=(0,r.useState)({}),C=(0,y.Z)(h,2),w=C[0],_=C[1],T=(0,r.useState)(""),I=(0,y.Z)(T,2),x=I[0],M=I[1],W=(0,r.useState)(!1),B=(0,y.Z)(W,2),F=B[0],G=B[1],L=(0,r.useState)([]),z=(0,y.Z)(L,2),A=z[0],q=z[1],H=A?A.length/2:0,U=[{title:n.formatMessage(d.Z.name),transforms:[P.sortable]},{title:n.formatMessage(d.Z.added),transforms:[P.sortable,(0,P.cellWidth)(15)]},{title:n.formatMessage(d.Z.totalRisk),transforms:[P.sortable,(0,P.cellWidth)(15)]}],Q=function(e,t,n){var r=(0,E.Z)(A);r[t]=V(V({},r[t]),{},{isOpen:n}),q(r)},J=function(e){var t="insights-expand-all"===e,n=(0,E.Z)(A);n.map((function(e,n){Object.prototype.hasOwnProperty.call(e,"isOpen")&&(e.isOpen=t,t&&Q(0,n,t))})),q(n)},K=[{label:"Collapse all",onClick:function(){return J("insights-collapse-all")}},{label:"Expand all",onClick:function(){return J("insights-expand-all")}}],X=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=e.flatMap((function(e,l){var c=e,i=e.resolution,o=n.filter((function(e,t){return t%2==0&&e.rule.rule_id===c.rule_id&&e})),u=!!o.length&&o[0].selected,m=n.length?!!o.length&&o[0].isOpen:0===l,f=[{rule:c,resolution:i,isOpen:m,selected:u,cells:[{title:a().createElement("div",null," ",c.description)},{title:a().createElement("div",{key:l},a().createElement(S.Z,{date:c.created_at,type:"relative",tooltipProps:{position:s.TooltipPosition.bottom}}))},{title:a().createElement("div",{key:l,style:{verticalAlign:"top"}},a().createElement(s.Tooltip,{key:l,position:s.TooltipPosition.bottom,content:a().createElement("span",null,"The ",a().createElement("strong",null,"likelihood")," that this will be a problem is"," ",null!=c&&c.likelihood?N.FV[null==c?void 0:c.likelihood]:"unknown",". The ",a().createElement("strong",null,"impact")," of the problem would be"," ",null!=c&&c.impact?N.dz[null==c?void 0:c.impact]:"unknown"," ","if it occurred.")},a().createElement(Z.Z,{value:c.total_risk})))}]},{parent:l,fullWidth:!0,cells:[{title:a().createElement(R,{key:"child-".concat(l),report:e})}]}],p=0===r.length||c.description.toLowerCase().includes(r.toLowerCase()),d=0===Object.keys(t).length||Object.keys(t).map((function(e){var n=t[e],r={created_at:c.created_at,total_risk:c.total_risk,tags:c.tags};return n.find((function(t){return String(t)===String(r[e])}))})).every((function(e){return e}));return p&&d?f:[]}));return l.forEach((function(e,t){return e.parent?e.parent=t-1:null})),l},Y=function(e){return e.filter((function(e){return e.selected}))}(A).length,$=function(e){G(e),q(X(o,w,A.map((function(t,n){return n%2==0?V(V({},t),{},{selected:e}):t})),x))},ee={items:[{title:"Select none",onClick:function(){return $(!1)}},{title:"Select all",onClick:function(){return $(!0)}}],count:Y,checked:F,onSelect:function(){return $(!F)}},te=function(e,t){var n=t.length>0?V(V({},w),(0,v.Z)({},e,t)):function(e){var t=V({},w);return delete t[e],t}(e);q(X(o,n,A,x)),_(n)},ne=[{label:"description",filterValues:{key:"text-filter",onChange:function(e,t){return function(e){var t=X(o,w,A,e);M(e),q(t)}(t)},value:x}},{label:N.W2.total_risk.title,type:N.W2.total_risk.type,id:N.W2.total_risk.urlParam,value:"checkbox-".concat(N.W2.total_risk.urlParam),filterValues:{key:"".concat(N.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return te(N.W2.total_risk.urlParam,t)},value:w.total_risk,items:N.W2.total_risk.values}}],re={deleteTitle:n.formatMessage(d.Z.resetFilters),filters:function(e){var t=Object.entries(e),n=e&&t.length>0?t.map((function(e){var t=N.W2[e[0]],n=e[1].map((function(e){return{name:t.values.find((function(t){return t.value===String(e)})).label,value:e}}));return{category:(0,s.capitalize)(t.title),chips:n,urlParam:t.urlParam}})):[];return x.length>0&&n.push({category:"Name",chips:[{name:x,value:x}]}),n}(w),onDelete:function(e,t,n){n?(q(X(o,{},A,"")),_({}),M("")):t.map((function(e){"Name"===e.category?(q(X(o,w,A,"")),M("")):te(e.urlParam,w[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})))}))}};return(0,r.useEffect)((function(){var e=t.data.report.data;u(e),q(X(e,w,A,x))}),[]),a().createElement("div",null,a().createElement(j.Z,{actionsConfig:{actions:K},bulkSelect:ee,filterConfig:{items:ne},pagination:a().createElement(a().Fragment,null,"".concat(H,1===H?" Recommendation":" Recommendations")),activeFiltersConfig:re}),"pending"===t.fetchStatus&&a().createElement(s.Card,null,a().createElement(s.CardBody,null,a().createElement(b.aV,null))),"fulfilled"===t.fetchStatus&&(o.length>0?a().createElement(a().Fragment,null,a().createElement(P.Table,{"aria-label":"Cluster recommendations table",onSelect:function(e,t,n){return q(X(o,w,A.map((function(e,r){return r===n?V(V({},e),{},{selected:t}):e})),x))},onCollapse:Q,rows:A,cells:U,sortBy:p,canSelectAll:!1,onSort:function(e,t,n){var r={2:"description",3:"created_at",4:"total_risk"},a=function(){return o.concat().sort((function(e,n){return e[r[t]]>n[r[t]]?1:n[r[t]]>e[r[t]]?-1:0}))},l=n===P.SortByDirection.asc?a():a().reverse();u(l),g({index:t,direction:n}),q(X(l,w,A,x))},variant:P.TableVariant.compact,isStickyHeader:!0},a().createElement(P.TableHeader,null),a().createElement(P.TableBody,null)),0===H&&a().createElement(s.Card,null,a().createElement(s.CardBody,null,a().createElement(D,{title:"No matching recommendations found",text:"This filter criteria matches no recommendations. Try changing your filter settings."})))):a().createElement(s.Card,null,a().createElement(s.CardBody,null,a().createElement(D,{icon:k.ZP,iconClass:"ins-c-insights__check",title:"No recommendations",text:"No known recommendations affect this cluster."})))),"rejected"===t.fetchStatus&&a().createElement(s.Card,null,a().createElement(s.CardBody,null,a().createElement(D,{icon:O.ZP,title:"Error getting recommendations",text:"There was an error fetching recommendations for this cluster. Refresh your page to try again."}))))};L.propTypes={cluster:i().object.isRequired};const z=L;var A=n(85991),q=n(49489),H=n(74806),U=function(e){var t=e.current,n=e.match,l=e.intl,c=(0,r.useState)([]),i=(0,y.Z)(c,2),o=i[0],s=i[1],u=(0,r.useCallback)((function(){var e=[],t=n.url.split("/");e.push({title:"".concat(l.formatMessage(d.Z.insightsHeader)," ").concat(t[1]),navigate:"/".concat(t[1])}),s(e)}),[l,n.params.clusterId,n.url]);return(0,r.useEffect)((function(){u()}),[u,n.params.clusterId,n.url]),a().createElement(a().Fragment,null,o.length>0&&a().createElement(A.a,{ouiaId:"detail"},o.map((function(e,t){return a().createElement(q.g,{key:t},a().createElement("span",null,e.title))})),a().createElement(q.g,{isActive:!0},t)))};U.propTypes={current:i().string,match:i().object,intl:i().any};const Q=(0,H.ZP)((0,p.Z)(U));var J=n(99e3),K=n(2095),X=n(85962);const Y=function(){return a().createElement(K.Zb,null,a().createElement(X.e,null,a().createElement(b.aV,null)))};var $=function(e){var t=e.match,n=(0,l.Z)(),c=(0,o.useDispatch)(),i=(0,o.useSelector)((function(e){return e.clusters[t.params.clusterId]}));return(0,r.useEffect)((function(){if(t.params.clusterId){var e="".concat(t.params.clusterId," - ").concat(n.formatMessage(d.Z.clusters));document.title=n.formatMessage(d.Z.documentTitle,{subnav:e})}c((0,J.L)(t.params.clusterId))}),[t.params.clusterId]),a().createElement(a().Fragment,null,a().createElement(m.Z,{className:"pf-m-light ins-inventory-detail"},i&&a().createElement(Q,{current:t.params.clusterId,match:t}),a().createElement(h,{uuid:t.params.clusterId})),a().createElement(f.Z,null,a().createElement(a().Fragment,null,i&&"rejected"===i.fetchStatus&&a().createElement(D,{title:"No recommendations available",text:"There was an error fetching recommendations for this cluster. Refresh your page to try again.",icon:u.ZP}),i&&"pending"===i.fetchStatus&&a().createElement(Y,null),i&&"fulfilled"===i.fetchStatus&&a().createElement(s.Grid,{hasGutter:!0},a().createElement(s.GridItem,{span:12},a().createElement(z,{cluster:i}))))))};$.propTypes={history:i().object,match:i().any};const ee=(0,p.Z)($)}}]);
//# sourceMappingURL=../sourcemaps/ClusterDetails.c3606e366b726799542a.js.map