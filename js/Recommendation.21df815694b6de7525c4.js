"use strict";(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[987],{52772:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ue});var r=n(93264),a=n.n(r),l=n(16530),i=n(86896),c=n(15861),o=n(29439),s=n(87757),u=n.n(s),d=n(88931),m=n(45697),f=n.n(m),p=n(56161),g=n(48716),b=n(39173),v=n(86350),E=n(62410),y=n(23218),h=n(34348),Z=n(71369),O=n(84564),P=n(7193),k=n(84785),w=n(96466),D=n(71355),C=n(6202),j=n(22910),S=n(96823),I=n(80765),x=n(36001),M=n(42057),_=n(56276),F=n(90670),T=n(59303),R=n(30893),N=n(1990),q=n(52661),B=n(4942);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,B.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=n(51957),H=n(86362),U=n(77572),V=n(48114),G=n(92223),J=n(32875),Q=n(7026),W=n(97530),Y=n(17335),K=n(12321),X=n(76),$=n(13877),ee=n(51014),te=n(28672);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,B.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){var t=e.query,n=(0,i.Z)(),c=t.isError,s=t.isUninitialized,u=t.isFetching,m=t.isSuccess,f=t.data,g=void 0===f?[]:f,b=(0,d.useDispatch)(),v=(0,d.useSelector)((function(e){return e.filters.affectedClustersState})),E=function(e){return b((0,te.BC)(e))},y=(0,r.useState)([]),h=(0,o.Z)(y,2),Z=h[0],O=h[1],P=(0,r.useState)([]),k=(0,o.Z)(P,2),w=k[0],D=k[1],C=(0,r.useState)([]),j=(0,o.Z)(C,2),S=j[0],I=j[1],x=v.limit,M=v.offset/v.limit+1,_={items:[{label:"Name",placeholder:"Filter by name",type:U.Yu.text,filterValues:{id:"name-filter",key:"name-filter",onChange:function(e,t){return function(e){var t=re(re({},v),{},{text:e,offset:0});E(t)}(t)},value:v.text}}],isDisabled:c||g&&0===g.length},F=function(e,t){var n=t*v.limit-v.limit;E(re(re({},v),{},{offset:n}))},T=function(e,t){E(re(re({},v),{},{limit:t}))};return(0,r.useEffect)((function(){var e=function(e,t){return e.filter((function(e){return null==e?void 0:e.cluster.includes(t.text)})).sort((function(e,n){return"asc"===t.sortDirection?null==e?void 0:e.cluster.localeCompare(null==n?void 0:n.cluster):null==n?void 0:n.cluster.localeCompare(null==e?void 0:e.cluster)}))}(g,v),t=function(e){return e.slice(x*(M-1),x*(M-1)+x)}(e),n=function(e,t){var n=e,r=n.findIndex((function(e){return"Name"===e.category}));return""===t?n.splice(r):-1===r?n.push({category:"Name",chips:[{name:t}]}):n[r]={category:"Name",chips:[{name:t}]},n}(S,v.text);O(e),D(t),I(n)}),[t,v]),a().createElement("div",{id:"affected-list-table"},a().createElement(V.Z,{filterConfig:_,pagination:{itemCount:Z.length,page:M,perPage:x,onSetPage:F,onPerPageSelect:T},activeFiltersConfig:c||g&&0===g.length?void 0:{filters:S,onDelete:function(){var e=re(re({},v),{},{text:""});E(e)}}}),a().createElement(W.i,{"aria-label":"Table of affected clusters",ouiaId:"affectedClustersTable",variant:"compact",cells:[{title:n.formatMessage(R.Z.name),transforms:[Q.sortable]}],rows:w.map((function(e){return{cells:[a().createElement("span",{key:null==e?void 0:e.cluter},a().createElement(l.Link,{to:"/clusters/".concat(null==e?void 0:e.cluster)},(null==e?void 0:e.cluster_name)||(null==e?void 0:e.cluster)))]}})),sortBy:{index:v.sortIndex,direction:v.sortDirection},onSort:function(e,t,n){E(re(re({},v),{},{sortIndex:t,sortDirection:n}))}},a().createElement(K.x,null),(s||u)&&a().createElement(q.Z,null),c&&a().createElement(p.Card,{id:"error-state-message"},a().createElement(p.CardBody,null,a().createElement(ee.Te,null))),m&&0===g.length&&a().createElement(p.Card,{id:"empty-state-message"},a().createElement(p.CardBody,null,a().createElement(ee.mi,null))),m&&g.length>0&&(Z.length>0?a().createElement(Y.R,null):a().createElement(G.Z,null,a().createElement(X.Bullseye,null,a().createElement(ee.VA,null))))),a().createElement(J.Z,{isFooter:!0,className:"ins-c-inventory__table--toolbar"},a().createElement($.Pagination,{variant:$.PaginationVariant.bottom,itemCount:Z.length,page:M,perPage:x,onSetPage:F,onPerPageSelect:T,onPageInput:F})))};ae.propTypes={query:f().shape({isError:f().bool.isRequired,isUninitialized:f().bool.isRequired,isFetching:f().bool.isRequired,isSuccess:f().bool.isRequired,data:f().array})};const le=function(){var e=(0,H.tf)((0,l.useParams)().recommendationId);return a().createElement(ae,{query:e})};var ie=n(71094),ce=n(73451),oe=function(e){var t=e.rule,n=e.ack,l=e.match,s=(0,i.Z)(),m=(0,d.useDispatch)(),f=function(e){return m((0,D.wN)(e))},B=l.params.recommendationId,L=(0,r.useState)(!1),U=(0,o.Z)(L,2),V=U[0],G=U[1],J=(0,r.useState)(!1),Q=(0,o.Z)(J,2),W=Q[0],Y=Q[1],K=t.isError,X=t.isUninitialized,$=t.isLoading,ee=t.isFetching,te=t.isSuccess,ne=t.data,re=t.refetch,ae=n.data,oe=void 0===ae?{}:ae,se=n.isFetching,ue=n.refetch,de=te?function(e,t){var n,r=(null==e||null===(n=e.error_keys)||void 0===n?void 0:n[function(e){var t;return null===(t=e.split("|"))||void 0===t?void 0:t[1]}(t)])||{},a=z(z(z({},e),r),(null==r?void 0:r.metadata)||(null==e?void 0:e.metadata)||{});return a.impact={impact:a.impact},delete a.metadata,delete a.error_keys,a}(ne.content,B):void 0,me=function(){var e=(0,c.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:re(),ue();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(e){G(e)},pe=function(){var e=(0,c.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,ie.H)("".concat(H._n,"/ack/").concat(t.rule_id,"/"));case 3:f({variant:"success",timeout:!0,dismissable:!0,title:s.formatMessage(R.Z.recSuccessfullyEnabled)}),re(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),fe(!1),f({variant:"danger",dismissable:!0,title:s.formatMessage(R.Z.error),description:"".concat(e.t0)});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return a().createElement(a().Fragment,null,V&&a().createElement(ce.Z,{handleModalToggle:fe,isModalOpen:V,rule:de,afterFn:me}),a().createElement(g.Z,{className:"pageHeaderOverride"},a().createElement(_.Z,{current:(null==de?void 0:de.description)||B})),(X||$||ee)&&a().createElement(v.Z,null,a().createElement(q.Z,null)),K&&a().createElement(v.Z,null,a().createElement(A.Z,{title:s.formatMessage(R.Z.unableToConnect),text:s.formatMessage(R.Z.unableToConnectDesc),icon:O.default,iconStyle:{color:P.Q7.value}})),!(X||$||ee)&&te&&a().createElement(a().Fragment,null,a().createElement(v.Z,{className:"pf-m-light pf-u-pt-sm"},a().createElement(N.Z,{isOpenShift:!0,isDetailsPage:!0,rule:de,header:a().createElement(a().Fragment,null,a().createElement(b.Z,{title:a().createElement(a().Fragment,null,de.description," ",a().createElement(F.Z,{rule:de}))}),a().createElement("p",null,s.formatMessage(R.Z.rulesDetailsPubishdate,{date:a().createElement(E.Z,{date:new Date(de.publish_date),type:"onlyDate"})}),de.tags&&(Array.isArray(de.tags)?a().createElement(Z.LabelGroup,{className:"categoryLabels",numLabels:1},de.tags.reduce((function(e,t){return T.kT[t]&&e.push(a().createElement(y.Label,{key:"label-".concat(t),color:"blue"},T.W2.category.values[T.kT[t]-1].label)),e}),[])):a().createElement(y.Label,null,de.tags)))),onFeedbackChanged:function(){var e=(0,c.Z)(u().mark((function e(t,n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ie.S)("".concat(H._n,"/v2/rating"),{},{rule:t,rating:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},a().createElement(x.k,null,a().createElement(M.B,{align:{default:"alignRight"}},a().createElement(j.Dropdown,{className:"ins-c-rec-details__actions_dropdown",onSelect:function(){return Y(!W)},position:"right",ouiaId:"actions",toggle:a().createElement(I.DropdownToggle,{onToggle:function(e){return Y(e)},toggleIndicator:w.default},s.formatMessage(R.Z.actions)),isOpen:W,dropdownItems:null!=de&&de.disabled?[a().createElement(S.DropdownItem,{key:"link",ouiaId:"enable",onClick:function(){pe(t)}},s.formatMessage(R.Z.enableRule))]:[a().createElement(S.DropdownItem,{key:"link",ouiaId:"disable",onClick:function(){fe(!0)}},s.formatMessage(R.Z.disableRule))]}))))),a().createElement(v.Z,null,a().createElement(a().Fragment,null,(null==de?void 0:de.disabled)&&a().createElement(p.Card,{className:"cardOverride"},a().createElement(p.CardHeader,null,a().createElement(h.Title,{headingLevel:"h4",size:"xl"},a().createElement(k.ZP,{size:"sm"})," ",s.formatMessage(R.Z.ruleIsDisabled))),a().createElement(p.CardBody,null,!se&&a().createElement(a().Fragment,null,s.formatMessage(R.Z.ruleIsDisabledJustification),a().createElement("i",null,oe.justification||s.formatMessage(R.Z.none)),(oe.updated_at||oe.created_at)&&a().createElement("span",null," ",a().createElement(E.Z,{date:new Date(oe.updated_at||oe.created_at),type:"onlyDate"})))),a().createElement(p.CardFooter,null,a().createElement(C.Button,{isInline:!0,variant:"link",onClick:function(){return pe(t)},ouiaId:"rule"},s.formatMessage(R.Z.enableRule)))),!(null!=de&&de.disabled)&&a().createElement(a().Fragment,null,a().createElement(h.Title,{className:"titleOverride",headingLevel:"h3",size:"2xl"},s.formatMessage(R.Z.affectedClusters)),a().createElement(le,null)),(null==de?void 0:de.disabled)&&a().createElement(A.Z,{icon:k.ZP,title:s.formatMessage(R.Z.ruleIsDisabled),text:s.formatMessage(R.Z.ruleIsDisabledBody)})))))};oe.propTypes={rule:f().object.isRequired,ack:f().object.isRequired,match:f().object.isRequired};var se=n(77647);const ue=function(){var e,t,n=(0,i.Z)(),c=(0,H.qv)((0,l.useParams)().recommendationId),o=(0,se.yr)({ruleId:(0,l.useParams)().recommendationId});if(c.isSuccess&&null!==(e=c.data)&&void 0!==e&&null!==(t=e.content)&&void 0!==t&&t.description){var s="".concat(c.data.content.description," - Recommendations");document.title=n.formatMessage(R.Z.documentTitle,{subnav:s})}return(0,r.useEffect)((function(){c.refetch()}),[(0,l.useParams)().recommendationId]),a().createElement(oe,{rule:c,ack:o,match:(0,l.useRouteMatch)()})}}}]);
//# sourceMappingURL=../sourcemaps/Recommendation.d8b50786f676f1baf9479e87ec56e72f.js.map