(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[9843],{76913:(e,r,t)=>{"use strict";t.d(r,{Lg:()=>O,Lv:()=>k,U1:()=>C,WL:()=>Z,_:()=>P,_F:()=>h,aM:()=>_,im:()=>g,mt:()=>w,oo:()=>S,yG:()=>j});var n=t(71002),i=t(45987),a=t(4942),o=t(42982),c=t(70885),u=t(48403),s=t.n(u),l=t(50361),f=t.n(l),d=(t(28416),t(81249)),v=t(59303),m=t(29299);function p(e){var r=function(e,r){if("object"!=(0,n.Z)(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=(0,n.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==(0,n.Z)(r)?r:String(r)}function b(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function y(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?b(Object(t),!0).forEach((function(r){(0,a.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var h=function(e,r){return Object.entries(r).every((function(r){var t=(0,c.Z)(r,2),n=t[0],i=t[1];switch(n){case"text":return e.description.toLowerCase().includes(i.toLowerCase());case v.W2.total_risk.urlParam:return i.includes(String(e.total_risk));case v.W2.category.urlParam:return e.tags.find((function(e){return i.includes(String(v.kT[e]))}));case v.W2.impact.urlParam:return i.includes(String(e.impact));case v.W2.impacting.urlParam:return!(i.length>0)||i.some((function(r){return"true"===r?e.impacted_clusters_count>0:"false"===r?0===e.impacted_clusters_count:void 0}));case v.W2.likelihood.urlParam:return i.includes(String(e.likelihood));case v.W2.rule_status.urlParam:return"all"===i||"disabled"===i&&e.disabled||"enabled"===i&&!e.disabled;case v.W2.res_risk.urlParam:return i.includes(String(e.resolution_risk));default:return!0}}))},g=function(e,r){return Object.entries(r).every((function(r){var t=(0,c.Z)(r,2),n=t[0],i=t[1];switch(n){case"text":return(e.cluster_name||e.cluster_id).toLowerCase().includes(i.toLowerCase());case v.RT.hits.urlParam:return 0===i.length&&parseInt(e.total_hit_count)>0||i.includes("all")||i.some((function(r){return e.hits_by_total_risk[r]>0}));case"version":return 0===i.length||i.includes(Z(e.cluster_version));default:return!0}}))},w=function(e,r){var t=f()(e);return delete t.sortIndex,delete t.sortDirection,delete t.sort,delete t.offset,delete t.limit,(null==t?void 0:t.hits)&&0===t.hits.length&&delete t.hits,function(e,r){return Object.entries(e||{}).reduce((function(e,t){var n=(0,c.Z)(t,2),i=n[0],a=n[1];if(r[i]){var u=r[i],l=Array.isArray(a)?a.map((function(e){var r=u.values.find((function(r){return r.value===String(e)}));return r?{name:r.text||r.label,value:e}:{name:e,value:e}})):[{name:u.values.find((function(e){return e.value===String(a)})).label,value:a}];return[].concat((0,o.Z)(e),[{category:s()(u.title),chips:l,urlParam:u.urlParam}])}return"text"===i?[].concat((0,o.Z)(e),(0,o.Z)(a.length>0?[{category:"Name",chips:[{name:a,value:a}],urlParam:i}]:[])):"version"===i?[].concat((0,o.Z)(e),(0,o.Z)(a.length>0?[{category:"Version",chips:a.map((function(e){return{name:e,value:e}})),urlParam:i}]:[])):"namespace_name"===i?[].concat((0,o.Z)(e),(0,o.Z)(a.length>0?[{category:"Namespace name",chips:[{name:a,value:a}],urlParam:i}]:[])):"cluster_name"===i?[].concat((0,o.Z)(e),(0,o.Z)(a.length>0?[{category:"Cluster name",chips:[{name:a,value:a}],urlParam:i}]:[])):void 0}),[])}(t,r)},j=function(e){var r=new URLSearchParams(e);return Array.from(r).reduce((function(e,r){var t=(0,c.Z)(r,2),n=t[0],i=t[1];return y(y({},e),{},(0,a.Z)({},n,["text","first","rule_status","sort","cluster_name","namespace_name","description","object_id"].includes(n)?i:"true"===i||"false"===i?JSON.parse(i):i.split(",")))}),{})},O=function(e){return{name:e.substring(e.startsWith("-")?1:0),direction:e.startsWith("-")?"desc":"asc",description:e.substring(e.startsWith("-")?1:0),object_id:e.substring(e.startsWith("-")?1:0)}},_=function(){var e,r,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,a=new URL(window.location.origin+window.location.pathname);a.searchParams.set("sort",(e=n.sortIndex,r=i,t=n.sortDirection,["desc","asc"].includes(t)||console.error("Invalid sort parameters (is not asc nor desc)"),"".concat("asc"===t?"":"-").concat(r[e]))),Object.entries(n).forEach((function(e){var r=(0,c.Z)(e,2),t=r[0],n=r[1];return"sortIndex"!==t&&"sortDirection"!==t&&"sort"!==t&&""!==n&&!(Array.isArray(n)&&0===n.length)&&a.searchParams.set(t,n)})),window.history.replaceState(null,null,a.href)},P=function(e,r,t){return t*(0,d.compare)(e,r)},Z=function(e){return(0,d.coerce)(void 0!==e&&(0,d.valid)((0,d.coerce)(e))?e:"0.0.0").version},S=function(e,r,t){var n=y(y({},e),{},{offset:0});n[t],r(y(y({},(0,i.Z)(n,[t].map(p))),"text"===t?{text:""}:"hits"===t?{hits:[]}:"version"===t?{version:[]}:"object_id"===t?{object_id:""}:{}))},k=function(e,r,t,n){return n.length>0?r(y(y({},e),{},{offset:0},(0,a.Z)({},t,n))):S(e,r,t)},C=function(e,r){var t=(0,m.Vs)(e.metadata.hits_by_severity,"general");return Object.entries(r).every((function(n){var i=(0,c.Z)(n,2),a=i[0],o=i[1];switch(a){case"cluster_name":return(e.cluster.display_name||e.cluster.uuid).toLowerCase().includes(o.toLowerCase());case"namespace_name":return(e.namespace.name||e.namespace.uuid).toLowerCase().includes(o.toLowerCase());case"severity":return 0===o.length||(0,m.mR)(t,r.severity);default:return!0}}))}},29299:(e,r,t)=>{"use strict";t.d(r,{Q$:()=>P,Vs:()=>p,ke:()=>O,l8:()=>_,lM:()=>w,mR:()=>b,p5:()=>Z,sI:()=>S,wW:()=>y,y4:()=>k});var n=t(71002),i=t(4942),a=t(45987),o=t(42982),c=t(70885),u=t(64420),s=t(44439),l=t.n(s);function f(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?f(Object(t),!0).forEach((function(r){(0,i.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function v(e){var r=function(e,r){if("object"!=(0,n.Z)(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=(0,n.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==(0,n.Z)(r)?r:String(r)}function m(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var p=function(e,r){var t={1:"low",2:"moderate",3:"important",4:"critical"},n={};if("general"===r||"label"===r)for(var i in e)i in t&&(n[t[i]]=e[i]);else n=t[e];return n},b=function(e,r){var t,n=function(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return m(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?m(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){c=!0,a=e},f:function(){try{o||null==t.return||t.return()}finally{if(c)throw a}}}}(r);try{for(n.s();!(t=n.n()).done;)if(e[t.value]>0)return!0}catch(e){n.e(e)}finally{n.f()}},y=function(e){var r=l().cloneDeep(e);return delete r.sortIndex,delete r.sortDirection,delete r.offset,delete r.limit,delete r.sort,!!Object.values(r).filter((function(e){return!l().isEmpty(e)})).length},h=function(e){return(null==e?void 0:e.charAt(0).toUpperCase())+(null==e?void 0:e.slice(1))},g=function(e,r){if(e.values){var t=e.values.find((function(e){return e.value===String(r)}));return t?{name:t.label||t.text,value:r}:{name:r,value:r}}return{name:r,value:r}},w=function(e,r){return Object.entries(e).reduce((function(e,t){var n=(0,c.Z)(t,2),i=n[0],a=n[1];if(r[i]){var o=r[i];if(Array.isArray(a)&&a.length>0||"string"==typeof a&&""!==a.trim()){var u=Array.isArray(a)?a.map((function(e){return g(o,e)})):[g(o,a)];e.push({category:h(o.label),chips:u,urlParam:o.urlParam})}}else"description"!==i&&"object_id"!==i||""===a.trim()||e.push({category:h(i.replace("_"," ")),chips:[{name:a,value:a}],urlParam:i});return e}),[])},j=function(e,r){var t=r[0].rule;switch(e){case 1:return t.details;case 2:return t.total_risk;case 3:return t.objects.length;case 4:return t.modified}},O=function(e,r,t){var n;return e>=1?null===(n=(0,o.Z)(t))||void 0===n?void 0:n.sort((function(t,n){var i=r===u.SortByDirection.asc?1:-1;return j(e,t)>j(e,n)?i:j(e,n)>j(e,t)?-i:0})):(0,o.Z)(t)},_=function(e,r){return e.flatMap((function(e,t){var n=(0,o.Z)(e);return r&&0===t&&(e[0].isOpen=!0),e[1].parent=2*t,n}))},P=function(e,r){return Object.entries(r).some((function(r){var t=(0,c.Z)(r,2),n=t[0],i=t[1];return"object_id"===n&&e.uid.toLowerCase().includes(i.toLowerCase())}))},Z=function(e,r,t){var n=d({},e);n[t],r(d(d({},(0,a.Z)(n,[t].map(v))),"description"===t?{description:""}:"total_risk"===t?{total_risk:[]}:"object_id"===t?{object_id:""}:{}))},S=function(e,r,t,n){return n.length>0?r(d(d({},e),(0,i.Z)({},t,n))):Z(e,r,t)},k=function(e,r){var t=l().omitBy(l().cloneDeep(r),l().isEmpty);return Object.entries(t).every((function(r){var t=(0,c.Z)(r,2),n=t[0],i=t[1];switch(n){case"description":return i&&e.details.toLowerCase().includes(i.toLowerCase());case"object_id":return i&&e.objects.some((function(e){return e.uid.toLowerCase().includes(i.toLowerCase())}));case"total_risk":return i&&i.includes(String(e.total_risk));default:return!0}}))}},1580:()=>{},94498:()=>{},28992:()=>{},21626:()=>{},91993:()=>{},99624:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},22143:()=>{},97236:()=>{},38024:()=>{},16166:()=>{}}]);
//# sourceMappingURL=../sourcemaps/9843.c0d51c07bc76071d2bab52856b4ba742.js.map