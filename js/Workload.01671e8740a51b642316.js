(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[2339],{56276:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var a=n(28416),r=n.n(a),l=n(45697),i=n.n(l),s=n(86896),c=n(62012),o=n(85991),u=n(49489),d=n(30893),m=function(e){var t=e.current,n=e.workloads,a=(0,s.Z)(),l=(0,c.useLocation)().pathname.split("/");return r().createElement("div",null,r().createElement(o.a,{ouiaId:"detail","data-testid":"breadcrumb-item"},r().createElement(u.g,{className:"breadcrumb-item"},r().createElement(c.Link,{to:n?"../..":"..",relative:"path"},"".concat(a.formatMessage(d.Z.insightsHeader)," ").concat(l[4]))),r().createElement(u.g,{className:"breadcrumb-item",isActive:!0},t)))};m.propTypes={current:i().string,workloads:i().boolean};const p=m},52661:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a=n(28416),r=n.n(a),l=n(2095),i=n(85962),s=n(24561);const c=function(){return r().createElement(l.Card,{ouiaId:"loading-skeleton"},r().createElement(i.CardBody,null,r().createElement(s.aV,null)))}},95808:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>me});var a=n(28416),r=n.n(a),l=n(89376),i=n(36001),s=n(42057),c=n(29572),o=n(34348),u=n(56276),d=n(49287),m=n(18038),p=n(81159),f=n(34023),E=n(35664),g=n(73845),h=n(62410),b=n(45697),v=n.n(b),y=function(e){var t,n,a,l=e.workloadData,i=e.namespaceId,s=e.clusterId,c=l.isUninitialized,u=l.isFetching,b=l.data;return r().createElement(d.r,{id:"workload-header",md:12,hasGutter:!0},r().createElement(m.P,{span:8},r().createElement(o.Dx,{size:"2xl",headingLevel:"h1",id:"workloads-header-title",ouiaId:"workloads-name"},c||u?r().createElement(r().Fragment,null,r().createElement(E.Z,{size:"sm"}),r().createElement(E.Z,{size:"sm"})):r().createElement(r().Fragment,null,r().createElement("p",null,null==b||null===(t=b.cluster)||void 0===t?void 0:t.display_name),r().createElement("p",null,null==b||null===(n=b.namespace)||void 0===n?void 0:n.name)))),r().createElement(m.P,null,r().createElement(p.K,null,r().createElement(f.v,{id:"workload-header-uuid"},r().createElement("span",null,"Cluster UUID:")," ",r().createElement("span",null,s)," ",r().createElement("span",null,"Namespace UUID:")," ",r().createElement("span",null,i)),r().createElement(f.v,{id:"workload-header-last-seen"},r().createElement("span",null,"Last seen: "),r().createElement("span",null,c||u?r().createElement(g.F,null):null!=b&&null!==(a=b.metadata)&&void 0!==a&&a.last_checked_at?r().createElement(h.Z,{date:b.metadata.last_checked_at,type:"exact"}):r().createElement(r().Fragment,null,"Unknown"))))))};y.propTypes={clusterId:v().string.isRequired,namespaceId:v().string.isRequired,workloadData:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,data:v().shape({metadata:v().shape({last_checked_at:v().string}),namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string})})};var k=n(62012),O=n(86362);const w=function(){var e=(0,k.useParams)(),t=e.namespaceId,n=e.clusterId,a=(0,O.k0)({namespaceId:t,clusterId:n});return r().createElement(y,{workloadData:a,namespaceId:t,clusterId:n})};var j=n(4942),P=n(70885),I=n(64420),C=n(35981),S=n(49004),_=n(58027),D=n(56021),Z=n(59303),T=n(52661),R=n(51014),x=n(90693),q=n(1792),M=n(31369),N=n(61088),F=n(6202),A=n(2095),L=n(85962),B=n(21015),U=n(95061),V=n(84556),z=n(21193),H=n(55471),W=n.n(H),G=n(78826),J=n(86706),K=n(28672),Q=n(76913),Y=n(13877),$=n(29299);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){(0,j.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=function(e){var t,n=e.objects||[],l=(0,J.useDispatch)(),i=(0,a.useState)(!1),s=(0,P.Z)(i,2),c=s[0],o=s[1],u=(0,a.useState)([]),d=(0,P.Z)(u,2),m=d[0],p=d[1],f=(0,a.useState)([]),E=(0,P.Z)(f,2),g=E[0],h=E[1],b=(0,a.useState)(!1),v=(0,P.Z)(b,2),y=v[0],k=v[1],O=(0,J.useSelector)((function(e){return e.filters.workloadsObjectsListState})),w=Math.floor(O.offset/O.limit)+1,C=O.limit,S=function(e){return l((0,K.u2)(e))},_=g.length>0,x=!y,q=[{label:"Object ID",type:"text",filterValues:{key:"object_id",onChange:function(e,t){return S(ee(ee({},O),{},{offset:0,object_id:t}))},value:O.object_id,placeholder:"Filter by Object ID"}}],M={showDeleteButton:c,deleteTitle:"Reset filters",filters:(t=ee({},O),delete t.sortIndex,delete t.sortDirection,(0,$.lM)(t,{label:"Object ID",type:"text",title:"object ID",urlParam:"object_id"})),onDelete:function(e,t,n){n?(0,K.aw)(O,K.kG,S):t.map((function(e){var t,n=(0,j.Z)({},e.urlParam,Array.isArray(O[e.urlParam])?O[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");n[e.urlParam].length>0?S(ee(ee({},O),n)):(t=e.urlParam,(0,Q.oo)(O,S,t))}))}};(0,a.useEffect)((function(){p(function(e,t){return e.filter((function(e){return(0,$.Q$)(e,t)}))}(n,O))}),[n,O]),(0,a.useEffect)((function(){h(m.slice(C*(w-1),C*(w-1)+C)),o((0,$.wW)(O)),k(!0)}),[m,O.limit,O.offset]);var N=function(e,t){var n=t*O.limit-O.limit;S(ee(ee({},O),{},{offset:n}))},F=function(e,t){t!==O.limit&&S(ee(ee({},O),{},{limit:t,offset:0}))};return r().createElement("div",{id:"objects-list-table"},r().createElement(D.Z,{pagination:{page:w,perPage:C,onSetPage:N,onPerPageSelect:F,isCompact:!0,ouiaId:"pager",itemCount:m.length},filterConfig:{items:q},activeFiltersConfig:M}),x?r().createElement(T.Z,null):_?r().createElement("div",null,r().createElement(I.Table,{"aria-label":"Cell widths",variant:"compact"},r().createElement(I.Thead,null,r().createElement(I.Tr,null,r().createElement(I.Th,{width:60},Z.VM.object),r().createElement(I.Th,{width:30},Z.VM.kind))),r().createElement(I.Tbody,null,null==g?void 0:g.map((function(e,t){return r().createElement(I.Tr,{key:t},r().createElement(I.Td,{dataLabel:Z.VM.object},e.uid),r().createElement(I.Td,{dataLabel:Z.VM.kind},e.kind))})))),g.length>0?r().createElement(Y.tl,{ouiaId:"pager",itemCount:m.length,page:w,perPage:C,onSetPage:N,onPerPageSelect:F,onPageInput:N,widgetId:"pagination-options-menu-bottom",variant:Y.aM.bottom}):r().createElement(Y.tl,{itemCount:0,perPage:!0,page:!0,onSetPage:!0,onPerPageSelect:!0,isDisabled:!0})):r().createElement(R.Ke,null))};te.propTypes={objects:v().arrayOf(v().shape({kind:v().string,uid:v().string}))};var ne=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,a=e.objects;return r().createElement(G.u_,{isOpen:t,onClose:function(){return n(!1)},variant:"medium",title:"Objects"},r().createElement(te,{objects:a}))};const ae=ne;ne.propTypes={isModalOpen:v().bool,setIsModalOpen:v().func,objects:v().arrayOf(v().shape({kind:v().string,uid:v().string}))};var re=function(e){var t=e.more_info,n=e.resolution,l=e.objects,i=e.namespaceName,s=e.reason,c=e.extra_data,o=Array.isArray(l)&&l.length>0,u=(0,a.useState)(!1),d=(0,P.Z)(u,2),m=d[0],E=d[1];return r().createElement(A.Card,{className:"ins-c-report-details",style:{boxShadow:"none"}},r().createElement(L.CardBody,null,r().createElement(ae,{isModalOpen:m,setIsModalOpen:E,objects:l}),r().createElement(p.K,{className:"ins-c-report-details__cards-stack","widget-type":"InsightsRulesCard",hasGutter:!0},r().createElement(f.v,null,r().createElement(A.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(z.J,null,r().createElement(q.ZP,{className:"ins-c-report-details__icon"})),r().createElement("strong",null,"Detected issues")),r().createElement(L.CardBody,null,r().createElement(W(),{template:s,definitions:c})))),r().createElement(V.iz,null),r().createElement(f.v,null,r().createElement(A.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(z.J,null,r().createElement(N.ZP,{className:"ins-c-report-details__icon"})),r().createElement("strong",null,"Steps to resolve")),r().createElement(L.CardBody,null,r().createElement(W(),{template:n,definitions:c})))),o&&r().createElement(I.Table,{borders:"compactBorderless","aria-label":"Objects table"},r().createElement(I.Thead,null,r().createElement(I.Tr,null,r().createElement(I.Th,{modifier:"fitContent"},Z.VM.object),r().createElement(I.Th,{modifier:"fitContent"},Z.VM.kind))),r().createElement(I.Tbody,null,l.slice(0,3).map((function(e,t){return r().createElement(I.Tr,{key:t},r().createElement(I.Td,{dataLabel:Z.VM.object},e.uid),r().createElement(I.Td,{dataLabel:Z.VM.kind},e.kind))})))),o&&r().createElement(f.v,null,r().createElement(F.Button,{variant:"link",isInline:!0,onClick:function(){return E(!0)}},"View all objects")),r().createElement("br",null),!i&&r().createElement(r().Fragment,null,r().createElement(B.CardHeader,null,r().createElement("strong",null,"Note:")),r().createElement(L.CardBody,null,"Red Hat avoids gathering and processing namespace and resource names as these may reveal confidential information. Namespaces and resources are identified by their UIDs instead. You can use in-cluster commands like the ones below to translate UIDs of affected resources to their names.",r().createElement(U.d,null,r().createElement(W(),{template:'oc get namespace -o jsonpath={range .items[*]}{.metadata.name}{"\t"}{.metadata.uid}{"\n"}{end}\n  oc -n <namespace> get <resourceKind> -o jsonpath={range .items[*]}{.metadata.name}{"\t"}{.metadata.uid}{"\n"}{end}',definitions:c})))),r().createElement(r().Fragment,null,r().createElement(V.iz,null),r().createElement(f.v,null,r().createElement(A.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(z.J,null,r().createElement(M.default,{className:"ins-c-report-details__icon"})),r().createElement("strong",null,"Additional info")),r().createElement(L.CardBody,null,r().createElement(W(),{template:t,definitions:c}))))))))};const le=re;function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,j.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}re.propTypes={more_info:v().string.isRequired,resolution:v().string.isRequired,objects:v().arrayOf({kind:v().string,uid:v().string}),extra_data:v().shape({check_name:v().string.isRequired,check_url:v().string.isRequired}),namespaceName:v().string.isRequired,reason:v().string.isRequired};var ce=function(e){var t=e.workload,n=e.namespaceName,l=(0,J.useDispatch)(),i=t.isError,s=t.isUninitialized,c=t.isFetching,o=t.isSuccess,u=t.data,d=(null==u?void 0:u.recommendations)||[],m=i,p=o,f=p&&0===d.length,E=(0,a.useState)(!1),g=(0,P.Z)(E,2),b=g[0],v=g[1],y=(0,a.useState)([]),O=(0,P.Z)(y,2),w=O[0],q=O[1],M=(0,a.useState)(!0),N=(0,P.Z)(M,2),F=N[0],A=N[1],L=(0,a.useState)([]),B=(0,P.Z)(L,2),U=B[0],V=B[1],z=(0,a.useState)(!1),H=(0,P.Z)(z,2),W=H[0],G=H[1],Y=(0,a.useState)(!1),X=(0,P.Z)(Y,2),ee=X[0],te=X[1],ne=(0,a.useState)(!0),ae=(0,P.Z)(ne,2),re=ae[0],ie=ae[1],ce=s||c||!W,oe=(0,k.useLocation)().search,ue=(0,J.useSelector)((function(e){return e.filters.workloadsRecsListState})),de=0===w.length,me=function(e){return l((0,K.cH)(e))};(0,a.useEffect)((function(){q(ge(d,ue))}),[u,ue]),(0,a.useEffect)((function(){V(Ee(w,ue.sortIndex,ue.sortDirection)),te((0,$.wW)(ue)),G(!0)}),[w]);var pe=(0,Z.PL)(ue,(function(e,t){ie(!1),(0,$.sI)(ue,me,e,t)}));(0,a.useEffect)((function(){if(oe&&F){var e=(0,Q.yG)(oe);if(e.sort){var t=(0,Q.Lg)(e.sort);e.sortIndex=Z.Db.indexOf(t.description),e.sortDirection=t.direction}e.total_risk&&!Array.isArray(e.total_risk)&&(e.total_risk=["".concat(e.total_risk)]),me(se(se({},ue),e))}A(!1)}),[]),(0,a.useEffect)((function(){F||(0,Q.aM)(ue,Z.Db)}),[ue,F]);var fe,Ee=function(e,t,n){var a=(0,$.ke)(t,n,e);return(0,$.l8)(a,re)},ge=function(e,t){G(!1);var a=(0,$.wW)(t),l=new Set(U.filter((function(e){return null==e?void 0:e.isOpen})).map((function(e){var t;return null==e||null===(t=e.rule)||void 0===t?void 0:t.details})));return e.filter((function(e){return!a||(0,$.y4)(e,t)})).map((function(e,t){return[{rule:e,isOpen:b||(null==l?void 0:l.has(null==e?void 0:e.details)),cells:[{title:e.details},{title:r().createElement("div",{key:t},r().createElement(x.Z,{value:e.total_risk,rest:{isCompact:!0}}))},{title:e.objects.length},{title:r().createElement("div",{key:t},r().createElement(h.Z,{date:e.modified,type:"relative"}))}]},{cells:[{title:r().createElement(le,{more_info:e.more_info,resolution:e.resolution,objects:e.objects,namespaceName:n,reason:e.reason,extra_data:e.extra_data})}],fullWidth:!0}]}))},he={showDeleteButton:ee,deleteTitle:"Reset filters",filters:(fe=se({},ue),delete fe.sortIndex,delete fe.sortDirection,(0,$.lM)(fe,Z.Oq)),onDelete:function(e,t,n){n?(0,K.aw)(ue,K.J2,me):t.map((function(e){var t,n=(0,j.Z)({},e.urlParam,Array.isArray(ue[e.urlParam])?ue[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");n[e.urlParam].length>0?me(se(se({},ue),n)):(t=e.urlParam,(0,$.p5)(ue,me,t))}))}};return r().createElement("div",{id:"workload-recs-list-table"},r().createElement(D.Z,{filterConfig:{items:pe,isDisabled:ce||m||f||0===d.length},pagination:r().createElement("span",{className:"pf-u-font-weight-bold"},1===(null==w?void 0:w.length)?"".concat(w.length," Recommendation"):"".concat(w.length," Recommendations")),activeFiltersConfig:ce||m||f||0===d.length?void 0:he}),r().createElement(C.i,{"aria-label":"Workload recommendations table",ouiaId:"workload-recommendations",cells:Z.x2,ouiaSafe:!ce,onCollapse:function(e,t,n){void 0===t?(v(n),V(U.map((function(e){return se(se({},e),Object.hasOwn(e,"parent")?null:{isOpen:n})})))):V(U.map((function(e,a){return a===t?se(se({},e),{},{isOpen:n}):e})))},rows:m||ce||f||de?[{fullWidth:!0,cells:[{props:{colSpan:Z.x2.length+1},title:m?r().createElement(R.fe,null):ce?r().createElement(T.Z,null):de?r().createElement(R.Be,null):r().createElement(R.So,null)}]}]:p?U:r().createElement(R.Te,null),variant:I.TableVariant.compact,isStickyHeader:!0,canCollapseAll:!0,sortBy:{index:ue.sortIndex,direction:ue.sortDirection},onSort:function(e,t,n){G(!1),ie(!1),me(se(se({},ue),{},{sortIndex:t,sortDirection:n}))}},r().createElement(S.x,null),r().createElement(_.R,null)))};const oe=ce;ce.propTypes={workload:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,isError:v().bool.isRequired,isSuccess:v().bool.isRequired,error:v().object,data:v().shape({namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string,recommendations:v().arrayOf(v().shape({check:v().string,description:v().string,objects:v().arrayOf(v().shape({kind:v().string,uid:v().string})),remediation:v().string}))})}),namespaceName:v().string.isRequired};var ue=function(e){var t,n,a=e.workload,d=e.namespaceId,m=e.clusterId;return r().createElement(r().Fragment,null,r().createElement(l.Z,{className:"pf-m-light ins-inventory-detail"},r().createElement(i.k,{direction:{default:"column"}},r().createElement(s.B,null,r().createElement(u.Z,{current:"ok"===(null==a||null===(t=a.data)||void 0===t?void 0:t.status)?"".concat(a.data.cluster.display_name," | ").concat(a.data.namespace.name):"".concat(m," | ").concat(d),workloads:"true"}),r().createElement(w,null)))),r().createElement(c.NP,null,r().createElement(o.Dx,{className:"pf-u-mb-lg",headingLevel:"h3",size:"2xl"},"Recommendations"),r().createElement(oe,{workload:a,namespaceName:null==a||null===(n=a.data)||void 0===n||null===(n=n.namespace)||void 0===n?void 0:n.name})))};ue.propTypes={clusterId:v().string.isRequired,namespaceId:v().string.isRequired,workload:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,data:v().shape({namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string})})};var de=n(55140);const me=function(){var e=(0,de.Z)(),t=(0,k.useParams)(),n=t.namespaceId,l=t.clusterId,i=(0,O.k0)({namespaceId:n,clusterId:l});return(0,a.useEffect)((function(){i.refetch()}),[n,l]),(0,a.useEffect)((function(){var t,a,r,s="".concat("ok"===(null==i||null===(t=i.data)||void 0===t?void 0:t.status)?"".concat(null==i||null===(a=i.data)||void 0===a?void 0:a.cluster.display_name," | ").concat(null==i||null===(r=i.data)||void 0===r?void 0:r.namespace.name," - Workloads"):"".concat(l," | ").concat(n," - Workloads"));e.updateDocumentTitle("".concat(s," - OCP Advisor | Red Hat Insights"))}),[i,n,l]),r().createElement(ue,{workload:i,namespaceId:n,clusterId:l})}},73845:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});var a=n(28416),r=n.n(a),l=n(24561),i=function(){return r().createElement(l.ZP,{height:20},r().createElement("rect",{x:"0",y:"0",rx:"4",ry:"4",width:"300",height:"20"}))}},70347:()=>{},71644:()=>{},24620:()=>{},82014:()=>{},25238:()=>{},92084:()=>{},53336:()=>{},314:()=>{},38299:()=>{},72816:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Workload.ea374061c03c5d48259f9c6ce2809e63.js.map