"use strict";(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[913],{76913:(e,t,r)=>{r.d(t,{_F:()=>g,im:()=>y,io:()=>k,mt:()=>O,yG:()=>P,Lg:()=>w,Ds:()=>Z});var n=r(4942),a=r(93433),i=r(29439),u=r(93264),c=r.n(u),s=r(16530),l=r(48403),o=r.n(l),d=r(50361),f=r.n(d),m=r(8045),v=r(62410),_=r(59303),p=r(30893);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var g=function(e,t){return Object.entries(t).every((function(t){var r=(0,i.Z)(t,2),n=r[0],a=r[1];switch(n){case"text":return e.description.toLowerCase().includes(a.toLowerCase());case _.W2.total_risk.urlParam:return a.includes(String(e.total_risk));case _.W2.category.urlParam:return e.tags.find((function(e){return a.includes(String(_.kT[e]))}));case _.W2.impact.urlParam:return a.includes(String(e.impact));case _.W2.impacting.urlParam:return!(a.length>0)||a.some((function(t){return"true"===t?e.impacted_clusters_count>0:"false"===t?0===e.impacted_clusters_count:void 0}));case _.W2.likelihood.urlParam:return a.includes(String(e.likelihood));case _.W2.rule_status.urlParam:return"all"===a||"disabled"===a&&e.disabled||"enabled"===a&&!e.disabled;default:return!0}}))},y=function(e,t){return Object.entries(t).every((function(t){var r=(0,i.Z)(t,2),n=r[0],a=r[1];switch(n){case"text":return(e.cluster_name||e.cluster_id).toLowerCase().includes(a.toLowerCase());case _.RT.hits.urlParam:return 0===a.length&&parseInt(e.total_hit_count)>0||a.includes("all")||a.some((function(t){return e.hits_by_total_risk[t-1]>0}));default:return!0}}))},k=function(e){return e.map((function(e,t){var r,n,a,i;return{cluster:e,cells:[c().createElement("span",{key:t},c().createElement(s.Link,{to:"clusters/".concat(e.cluster_id)},e.cluster_name||e.cluster_id)),e.total_hit_count,(null===(r=e.hits_by_total_risk)||void 0===r?void 0:r[3])||0,(null===(n=e.hits_by_total_risk)||void 0===n?void 0:n[2])||0,(null===(a=e.hits_by_total_risk)||void 0===a?void 0:a[1])||0,(null===(i=e.hits_by_total_risk)||void 0===i?void 0:i[0])||0,c().createElement("span",{key:t},e.last_checked_at?c().createElement(v.Z,{extraTitle:"".concat(_.NW.formatMessage(p.Z.lastSeen),": "),date:e.last_checked_at,variant:"relative"}):c().createElement(m.Tooltip,{key:t,content:c().createElement("span",null,_.NW.formatMessage(p.Z.lastSeen)+": ",_.NW.formatMessage(p.Z.nA))},c().createElement("span",null,_.NW.formatMessage(p.Z.nA))))]}}))},O=function(e,t){var r=f()(e);return delete r.sortIndex,delete r.sortDirection,delete r.offset,delete r.limit,(null==r?void 0:r.hits)&&0===r.hits.length&&delete r.hits,function(e,t){return Object.entries(e||{}).reduce((function(e,r){var n=(0,i.Z)(r,2),u=n[0],c=n[1];if(t[u]){var s=t[u],l=Array.isArray(c)?c.map((function(e){var t=s.values.find((function(t){return t.value===String(e)}));return t?{name:t.text||t.label,value:e}:{name:e,value:e}})):[{name:s.values.find((function(e){return e.value===String(c)})).label,value:c}];return[].concat((0,a.Z)(e),[{category:o()(s.title),chips:l,urlParam:s.urlParam}])}if("text"===u)return[].concat((0,a.Z)(e),(0,a.Z)(c.length>0?[{category:"Name",chips:[{name:c,value:c}],urlParam:u}]:[]))}),[])}(r,t)},P=function(e){var t=new URLSearchParams(e);return Array.from(t).reduce((function(e,t){var r=(0,i.Z)(t,2),a=r[0],u=r[1];return b(b({},e),{},(0,n.Z)({},a,"text"===a?u:"true"===u||"false"===u?JSON.parse(u):u.split(",")))}),{})},w=function(e){return{name:e.substring(e.startsWith("-")?1:0),direction:e.startsWith("-")?"desc":"asc"}},Z=function(e,t){var r=(0,u.useState)(e),n=(0,i.Z)(r,2),a=n[0],c=n[1];return(0,u.useEffect)((function(){var r=setTimeout((function(){c(e)}),t);return function(){clearTimeout(r)}}),[t,e]),a}}}]);
//# sourceMappingURL=../sourcemaps/913.126bd29cee5a06271d0702e90129dbbe.js.map