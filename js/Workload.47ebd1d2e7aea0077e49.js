(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[2339],{49872:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>re});var n=a(92950),r=a.n(n),l=a(89376),s=a(36001),i=a(42057),c=a(29572),o=a(34348),d=a(56276),u=a(49287),m=a(18038),p=a(81159),E=a(34023),f=a(35664),g=a(73845),h=a(62410),v=a(45697),b=a.n(v),y=function(e){var t,a=e.workloadData,n=e.namespaceId,l=e.clusterId,s=a.isUninitialized,i=a.isFetching,c=a.data;return r().createElement(u.r,{id:"workload-header",md:12,hasGutter:!0},r().createElement(m.P,{span:8},r().createElement(o.Dx,{size:"2xl",headingLevel:"h1",id:"cluster-header-title",ouiaId:"cluster-name"},s||i?r().createElement(r().Fragment,null,r().createElement(f.Z,{size:"sm"}),r().createElement(f.Z,{size:"sm"})):r().createElement(r().Fragment,null,r().createElement("p",null,c.cluster.display_name),r().createElement("p",null,c.namespace.name)))),r().createElement(m.P,null,r().createElement(p.K,null,r().createElement(E.v,{id:"workload-header-uuid"},r().createElement("span",null,"Cluster UUID:")," ",r().createElement("span",null,l)," ",r().createElement("span",null,"Namespace UUID:")," ",r().createElement("span",null,n)),r().createElement(E.v,{id:"workload-header-last-seen"},r().createElement("span",null,"Last seen: "),r().createElement("span",null,s||i?r().createElement(g.F,null):null!=c&&null!==(t=c.metadata)&&void 0!==t&&t.last_checked_at?r().createElement(h.Z,{date:c.metadata.last_checked_at,type:"exact"}):r().createElement(r().Fragment,null,"Unknown"))))))};y.propTypes={clusterId:b().string.isRequired,namespaceId:b().string.isRequired,workloadData:b().shape({isUninitialized:b().bool.isRequired,isFetching:b().bool.isRequired,data:b().shape({namespace:b().shape({uuid:b().string,name:b().string}),cluster:b().shape({uuid:b().string,display_name:b().string}),status:b().string})})};var k=a(62012),w=a(86362);const I=function(){var e=(0,k.useParams)(),t=e.namespaceId,a=e.clusterId,n=(0,w.k0)({namespaceId:t,clusterId:a});return r().createElement(y,{workloadData:n,namespaceId:t,clusterId:a})};var O=a(4942),C=a(42982),P=a(70885),_=a(15509),D=a(56021),j=a(59303),R=a(52661),T=a(51014),Z=a(90693),S=a(1792),q=a(31369),x=a(61088),F=a(6202),N=a(2095),U=a(85962),B=a(21015),z=a(95061),H=a(84556),L=a(55471),A=a.n(L),W="Object ID",K="Kind",G=function(e){var t=e.more_info,a=e.resolution,n=e.objects;return r().createElement(N.Card,{className:"ins-c-report-details",style:{boxShadow:"none"}},r().createElement(U.CardBody,null,r().createElement(p.K,{className:"ins-c-report-details__cards-stack","widget-type":"InsightsRulesCard",hasGutter:!0},r().createElement(E.v,null,r().createElement(N.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(S.ZP,{className:"ins-c-report-details__icon"}),r().createElement("strong",null,"Detected issues")),r().createElement(U.CardBody,null,"This should be a reason field and extradata should provide us an array of reasons to list here"))),r().createElement(H.Divider,null),r().createElement(E.v,null,r().createElement(N.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(x.ZP,{className:"ins-c-report-details__icon"}),r().createElement("strong",null,"Steps to resolve")),r().createElement(U.CardBody,null,r().createElement(A(),{template:a})))),r().createElement(_.Table,{borders:"compactBorderless"},r().createElement(_.Thead,null,r().createElement(_.Tr,null,r().createElement(_.Th,{modifier:"fitContent"},W),r().createElement(_.Th,{modifier:"fitContent"},K))),r().createElement(_.Tbody,null,n.slice(0,3).map((function(e,t){return r().createElement(_.Tr,{key:t},r().createElement(_.Td,{dataLabel:W},e.uid),r().createElement(_.Td,{dataLabel:K},e.kind))})))),r().createElement(F.Button,{variant:"link",isInline:!0},"View all objects"),r().createElement("br",null),r().createElement(B.CardHeader,null,r().createElement("strong",null,"Note:")),r().createElement(U.CardBody,null,"Red Hat avoids gathering and processing namespace and resource names as these may reveal confidential information. Namespaces and resources are identified by their UIDs instead. You can use in-cluster commands like the ones below to translate UIDs of affected resources to their names.",r().createElement(z.d,null,'oc get namespace -o jsonpath={range .items[*]}{.metadata.name}{"\t"}{.metadata.uid}{"\n"}{end}\n  oc -n <namespace> get <resourceKind> -o jsonpath={range .items[*]}{.metadata.name}{"\t"}{.metadata.uid}{"\n"}{end}')),r().createElement(r().Fragment,null,r().createElement(H.Divider,null),r().createElement(E.v,null,r().createElement(N.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(q.default,{className:"ins-c-report-details__icon"}),r().createElement("strong",null,"Additional info")),r().createElement(U.CardBody,null,t)))))))};const M=G;G.propTypes={extra_data:b().string.isRequired,more_info:b().string.isRequired,resolution:b().string.isRequired,objects:b().arrayOf({kind:b().string,uid:b().string})};var V=a(86706),J=a(28672),Y=a(76913),Q=a(29299);function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(Object(a),!0).forEach((function(t){(0,O.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ee=function(e){var t=e.workload,a=(0,V.useDispatch)(),l=t.isError,s=t.isUninitialized,i=t.isFetching,c=t.isSuccess,o=t.data,d=(null==o?void 0:o.recommendations)||[],u=l,m=c,p=(0,n.useState)(!1),E=(0,P.Z)(p,2),f=E[0],g=E[1],v=(0,n.useState)([]),b=(0,P.Z)(v,2),y=b[0],k=b[1],w=(0,n.useState)([]),I=(0,P.Z)(w,2),S=I[0],q=I[1],x=(0,n.useState)(!1),F=(0,P.Z)(x,2),N=F[0],U=F[1],B=(0,n.useState)(!1),z=(0,P.Z)(B,2),H=z[0],L=z[1],A=(0,n.useState)(!0),W=(0,P.Z)(A,2),K=W[0],G=W[1],X=s||i||!N,ee=(0,V.useSelector)((function(e){return e.filters.workloadsRecsListState})),te=function(e){return a((0,J.cH)(e))};(0,n.useEffect)((function(){k(le(d,ee))}),[o,ee]),(0,n.useEffect)((function(){q(re(y,ee.sortIndex,ee.sortDirection)),L((0,Q.wW)(ee)),U(!0)}),[y]);var ae,ne=(0,j.PL)(ee,(function(e,t){return G(!1),(0,Y.Lv)(ee,te,e,t)})),re=function(e,t,a){return e.flatMap((function(e,t){var a=(0,C.Z)(e);return K&&0===t&&(e[0].isOpen=!0),e[1].parent=2*t,a}))},le=function(e,t){U(!1);var a=(0,Q.wW)(t);return e.filter((function(e){return!a||(0,Y.y4)(e,t)})).map((function(e,t){return[{rule:e,isOpen:f,cells:[{title:e.details},{title:r().createElement("div",{key:t},r().createElement(Z.Z,{value:4,rest:{isCompact:!0}}))},{title:e.objects.length},{title:r().createElement("div",{key:t},r().createElement(h.Z,{date:e.modified,type:"relative"}))}]},{cells:[{title:r().createElement(M,{extra_data:e.extra_data,more_info:e.more_info,resolution:e.resolution,objects:e.objects})}]}]}))},se={showDeleteButton:!!H,deleteTitle:"Reset filters",filters:(ae=$({},ee),delete ae.sortIndex,delete ae.sortDirection,(0,Q.lM)(ae,j.Oq)),onDelete:function(e,t,a){a?(0,J.aw)(ee,J.J2,te):t.map((function(e){var t,a=(0,O.Z)({},e.urlParam,Array.isArray(ee[e.urlParam])?ee[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");a[e.urlParam].length>0?te($($({},ee),a)):(t=e.urlParam,(0,Y.oo)(ee,te,t))}))}};return r().createElement("div",{id:"workload-recs-list-table"},r().createElement(D.Z,{filterConfig:{items:ne,isDisabled:X||u||0===d.length},pagination:r().createElement("span",{className:"pf-u-font-weight-bold"},1===(null==d?void 0:d.length)?"".concat(d.length," Recommendation"):"".concat(d.length," Recommendations")),activeFiltersConfig:X||u||0===d.length?void 0:se}),r().createElement(_.Table,{"aria-label":"Workload recommendations table",ouiaId:"workload-recommendations",cells:j.x2,ouiaSafe:!X,onCollapse:function(e,t,a){void 0===t?(g(a),q(S.map((function(e){return $($({},e),Object.hasOwn(e,"parent")?null:{isOpen:a})})))):q(S.map((function(e,n){return n===t?$($({},e),{},{isOpen:a}):e})))},rows:u||X?[{fullWidth:!0,cells:[{props:{colSpan:j.x2.length+1},title:r().createElement(R.Z,null)}]}]:m?S:r().createElement(T.Te,null),variant:_.TableVariant.compact,isStickyHeader:!0,canCollapseAll:!0},r().createElement(_.TableHeader,null),r().createElement(_.TableBody,null)))};const te=ee;ee.propTypes={workload:b().shape({isUninitialized:b().bool.isRequired,isFetching:b().bool.isRequired,isError:b().bool.isRequired,isSuccess:b().bool.isRequired,error:b().object,data:b().shape({namespace:b().shape({uuid:b().string,name:b().string}),cluster:b().shape({uuid:b().string,display_name:b().string}),status:b().string,recommendations:b().arrayOf(b().shape({check:b().string,description:b().string,objects:b().arrayOf(b().shape({kind:b().string,uid:b().string})),remediation:b().string}))})})};var ae=function(e){var t,a=e.workload,n=e.namespaceId,u=e.clusterId;return r().createElement(r().Fragment,null,r().createElement(l.Z,{className:"pf-m-light ins-inventory-detail"},r().createElement(s.k,{direction:{default:"column"}},r().createElement(i.B,null,r().createElement(d.Z,{current:"ok"===(null==a||null===(t=a.data)||void 0===t?void 0:t.status)?"".concat(a.data.cluster.display_name," | ").concat(a.data.namespace.name):"".concat(u," | ").concat(n)}),r().createElement(I,null)))),r().createElement(c.NP,null,r().createElement(o.Dx,{className:"pf-u-mb-lg",headingLevel:"h3",size:"2xl"},"Recommendations"),r().createElement(te,{workload:a})))};ae.propTypes={clusterId:b().string.isRequired,namespaceId:b().string.isRequired,workload:b().shape({isUninitialized:b().bool.isRequired,isFetching:b().bool.isRequired,data:b().shape({namespace:b().shape({uuid:b().string,name:b().string}),cluster:b().shape({uuid:b().string,display_name:b().string}),status:b().string})})};var ne=a(55140);const re=function(){var e=(0,ne.Z)(),t=(0,k.useParams)(),a=t.namespaceId,l=t.clusterId,s=(0,w.k0)({namespaceId:a,clusterId:l});return(0,n.useEffect)((function(){s.refetch()}),[a,l]),(0,n.useEffect)((function(){var t,n,r,i="".concat("ok"===(null==s||null===(t=s.data)||void 0===t?void 0:t.status)?"".concat(null==s||null===(n=s.data)||void 0===n?void 0:n.cluster.display_name," | ").concat(null==s||null===(r=s.data)||void 0===r?void 0:r.namespace.name," - Workloads"):"".concat(l," | ").concat(a," - Workloads"));e.updateDocumentTitle("".concat(i," - OCP Advisor | Red Hat Insights"))}),[s,a,l]),r().createElement(ae,{workload:s,namespaceId:a,clusterId:l})}},71644:()=>{},28992:()=>{},92084:()=>{},72816:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Workload.ffa1754d1243d09cede1b13ecdd9124d.js.map