(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[619],{42146:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ce});var l=a(93264),n=a.n(l),r=a(86896),i=a(45697),o=a.n(i),s=a(58788),c=a(48794),u=a(48716),d=a(86350),m=a(36873);const p=(0,a(50049).vU)({documentTitle:{id:"documentTitle",defaultMessage:[{type:1,value:"subnav"},{type:0,value:" - OCP Advisor | Red Hat Insights"}]},clusters:{id:"clusters",defaultMessage:[{type:0,value:"Clusters"}]},added:{id:"added",defaultMessage:[{type:0,value:"Added"}]},loading:{id:"loading",defaultMessage:[{type:0,value:"Loading"}]},lastSeen:{id:"lastSeen",defaultMessage:[{type:0,value:"Last seen"}]},actions:{id:"actions",defaultMessage:[{type:0,value:"Actions"}]},name:{id:"name",defaultMessage:[{type:0,value:"Name"}]},filterBy:{id:"filterBy",defaultMessage:[{type:0,value:"Filter by name"}]},totalRisk:{id:"totalRisk",defaultMessage:[{type:0,value:"Total risk"}]},recommendation:{id:"recommendation",defaultMessage:[{type:0,value:"Recommendation"}]},recommendations:{id:"recommendations",defaultMessage:[{type:0,value:"Recommendations"}]},insightsHeader:{id:"insightsHeader",defaultMessage:[{type:0,value:"Advisor"}]},unknown:{id:"unknown",defaultMessage:[{type:0,value:"Unknown"}]},low:{id:"low",defaultMessage:[{type:0,value:"Low"}]},moderate:{id:"moderate",defaultMessage:[{type:0,value:"Moderate"}]},important:{id:"important",defaultMessage:[{type:0,value:"Important"}]},critical:{id:"critical",defaultMessage:[{type:0,value:"Critical"}]},veryLow:{id:"veryLow",defaultMessage:[{type:0,value:"Very Low"}]},medium:{id:"medium",defaultMessage:[{type:0,value:"Medium"}]},high:{id:"high",defaultMessage:[{type:0,value:"High"}]},availability:{id:"availability",defaultMessage:[{type:0,value:"Availability"}]},performance:{id:"performance",defaultMessage:[{type:0,value:"Performance"}]},stability:{id:"stability",defaultMessage:[{type:0,value:"Stability"}]},security:{id:"security",defaultMessage:[{type:0,value:"Security"}]},enabled:{id:"enabled",defaultMessage:[{type:0,value:"Enabled"}]},impact:{id:"impact",defaultMessage:[{type:0,value:"Impact"}]},impactLevel:{id:"impactLevel",defaultMessage:[{type:1,value:"level"},{type:0,value:" impact"}]},impactDescription:{id:"impactDescription",defaultMessage:[{type:0,value:"The impact of the problem would be "},{type:1,value:"level"},{type:0,value:" if it occurred."}]},category:{id:"category",defaultMessage:[{type:0,value:"Category"}]},likelihood:{id:"likelihood",defaultMessage:[{type:0,value:"Likelihood"}]},likelihoodLevel:{id:"likelihoodLevel",defaultMessage:[{type:1,value:"level"},{type:0,value:" likelihood"}]},likelihoodDescription:{id:"likelihoodDescription",defaultMessage:[{type:0,value:"The likelihood that this will be a problem is "},{type:1,value:"level"},{type:0,value:"."}]},all:{id:"all",defaultMessage:[{type:0,value:"All"}]},disabled:{id:"disabled",defaultMessage:[{type:0,value:"Disabled"}]},resetFilters:{id:"resetFilters",defaultMessage:[{type:0,value:"Reset filters"}]},noMatchingRecommendations:{id:"noMatchingRecommendations",defaultMessage:[{type:0,value:"No matching recommendations found"}]},noMatchingRecommendationsDesc:{id:"noMatchingRecommendationsDesc",defaultMessage:[{type:0,value:"This filter criteria matches no recommendations. Try changing your filter settings."}]},noRecommendations:{id:"noRecommendations",defaultMessage:[{type:0,value:"None of your connected systems are affected by any known recommendations."}]},noRecommendationsDesc:{id:"noRecommendationsDesc",defaultMessage:[{type:0,value:"No known recommendations affect this cluster."}]}});var f=function(e){var t=e.uuid,a=e.lastSeen,l=(0,r.Z)();return n().createElement(n().Fragment,null,n().createElement(s.Grid,{md:12,hasGutter:!0},n().createElement(s.GridItem,null,n().createElement(s.Title,{size:"2xl",headingLevel:"h1"},t)),n().createElement(s.GridItem,null,n().createElement(s.Stack,null,n().createElement(s.StackItem,null,n().createElement("span",null,"UUID: "),n().createElement("span",null,t||l.formatMessage(p.unknown))),n().createElement(s.StackItem,null,n().createElement("span",null,l.formatMessage(p.lastSeen),": "),n().createElement("span",null,a||l.formatMessage(p.unknown)))))))};f.propTypes={uuid:o().string.isRequired,lastSeen:o().string};const g=f;var v=a(96156),y=a(85061),h=a(28481),b=a(44535),M=a(26899),k=a(78216),E=a(94550),Z=a(57277),O=a(219),w=a(96733),P=a(74183),S=a(86728),_=a(34348),j=function(e){var t=e.className,a=e.children,l=e.icon,r=e.iconClass,i=e.iconStyle,o=e.text,s=e.title,c=e.variant;return n().createElement(O.ub,{className:t,variant:c},"none"!==l&&n().createElement(S.k,{className:r,style:i,icon:l}),n().createElement(_.Title,{headingLevel:"h5",size:"lg"},s),n().createElement(P.B,{style:{marginBottom:"16px"}},o),a)};j.propTypes={children:o().any,icon:o().any,iconClass:o().any,iconStyle:o().any,text:o().any,title:o().string,variant:o().any,className:o().string},j.defaultProps={icon:w.ZP,title:"",variant:O.IQ.full};const C=j;var T=a(82644),R=a(29558),D=a(13976),I=(0,T.Sn)(),x=navigator.language.slice(0,2),L=(0,R.d)({onError:console.error,locale:x},I),N={locale:x},F={1:(0,D.Z)(L.formatMessage(p.low),N),2:(0,D.Z)(L.formatMessage(p.medium),N),3:(0,D.Z)(L.formatMessage(p.high),N),4:(0,D.Z)(L.formatMessage(p.critical),N)},A={1:(0,D.Z)(L.formatMessage(p.low),N),2:(0,D.Z)(L.formatMessage(p.medium),N),3:(0,D.Z)(L.formatMessage(p.high),N),4:(0,D.Z)(L.formatMessage(p.critical),N)},B={1:(0,D.Z)(L.formatMessage(p.low),N),2:(0,D.Z)(L.formatMessage(p.moderate),N),3:(0,D.Z)(L.formatMessage(p.important),N),4:(0,D.Z)(L.formatMessage(p.critical),N)},G={1:(0,D.Z)(L.formatMessage(p.veryLow),N),2:(0,D.Z)(L.formatMessage(p.low),N),3:(0,D.Z)(L.formatMessage(p.moderate),N),4:(0,D.Z)(L.formatMessage(p.high),N)},H={total_risk:{type:"checkbox",title:"total risk",urlParam:"total_risk",values:[{label:B[4],value:"4"},{label:B[3],value:"3"},{label:B[2],value:"2"},{label:B[1],value:"1"}]},res_risk:{type:"checkbox",title:"risk of change",urlParam:"res_risk",values:[{label:G[4],value:"4"},{label:G[3],value:"3"},{label:G[2],value:"2"},{label:G[1],value:"1"}]},impact:{type:"checkbox",title:"impact",urlParam:"impact",values:[{label:A[4],value:"4"},{label:A[3],value:"3"},{label:A[2],value:"2"},{label:A[1],value:"1"}]},likelihood:{type:"checkbox",title:"likelihood",urlParam:"likelihood",values:[{label:F[4],value:"4"},{label:F[3],value:"3"},{label:F[2],value:"2"},{label:F[1],value:"1"}]},rule_status:{type:"radio",title:"status",urlParam:"rule_status",values:[{label:(0,D.Z)(L.formatMessage(p.all),N),value:"all"},{label:(0,D.Z)(L.formatMessage(p.enabled),N),value:"enabled"},{label:(0,D.Z)(L.formatMessage(p.disabled),N),value:"disabled"}]}},U=a(22663);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){(0,v.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var q=function(e){var t=e.report;return n().createElement("div",{className:"advisor"},n().createElement(U.Z,{appName:"advisor",module:"./AdvisorReportDetails",report:z(z({},t),{},{details:t.extra_data,resolution:{resolution:t.resolution}})}))};q.propTypes={report:o().object.isRequired};const W=q;function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){(0,v.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var K=function(e){var t=e.reports,a=(0,r.Z)(),i=(0,l.useState)([]),o=(0,h.Z)(i,2),c=o[0],u=o[1],d=(0,l.useState)({}),m=(0,h.Z)(d,2),f=m[0],g=m[1],O=(0,l.useState)({}),w=(0,h.Z)(O,2),P=w[0],S=w[1],_=(0,l.useState)(""),j=(0,h.Z)(_,2),T=j[0],R=j[1],D=(0,l.useState)(!1),I=(0,h.Z)(D,2),x=I[0],L=I[1],N=(0,l.useState)([]),B=(0,h.Z)(N,2),G=B[0],U=B[1],V=G?G.length/2:0,z=[{title:a.formatMessage(p.name),transforms:[E.sortable]},{title:a.formatMessage(p.added),transforms:[E.sortable,(0,E.cellWidth)(15)]},{title:a.formatMessage(p.totalRisk),transforms:[E.sortable,(0,E.cellWidth)(15)]}],q=function(e,t,a){var l=(0,y.Z)(G);l[t]=J(J({},l[t]),{},{isOpen:a}),U(l)},Q=function(e){var t="insights-expand-all"===e,a=(0,y.Z)(G);a.map((function(e,a){Object.prototype.hasOwnProperty.call(e,"isOpen")&&(e.isOpen=t,t&&q(0,a,t))})),U(a)},K=[{label:"Collapse all",onClick:function(){return Q("insights-collapse-all")}},{label:"Expand all",onClick:function(){return Q("insights-expand-all")}}],X=function(e,t,a){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=e.flatMap((function(e,r){var i=e,o=e.resolution,c=a.filter((function(e,t){return t%2==0&&e.rule.rule_id===i.rule_id&&e})),u=!!c.length&&c[0].selected,d=a.length?!!c.length&&c[0].isOpen:0===r,m=[{rule:i,resolution:o,isOpen:d,selected:u,cells:[{title:n().createElement("div",null," ",i.description)},{title:n().createElement("div",{key:r},n().createElement(M.Z,{date:i.created_at,type:"relative",tooltipProps:{position:s.TooltipPosition.bottom}}))},{title:n().createElement("div",{key:r,style:{verticalAlign:"top"}},n().createElement(s.Tooltip,{key:r,position:s.TooltipPosition.bottom,content:n().createElement("span",null,"The ",n().createElement("strong",null,"likelihood")," that this will be a problem is"," ",null!=i&&i.likelihood?F[null==i?void 0:i.likelihood]:"unknown",". The ",n().createElement("strong",null,"impact")," of the problem would be"," ",null!=i&&i.impact?A[null==i?void 0:i.impact]:"unknown"," ","if it occurred.")},n().createElement(k.Z,{value:i.total_risk})))}]},{parent:r,fullWidth:!0,cells:[{title:n().createElement(W,{key:"child-".concat(r),report:e})}]}],p=0===l.length||i.description.toLowerCase().includes(l.toLowerCase()),f=0===Object.keys(t).length||Object.keys(t).map((function(e){var a=t[e],l={created_at:i.created_at,total_risk:i.total_risk,tags:i.tags};return a.find((function(t){return String(t)===String(l[e])}))})).every((function(e){return e}));return p&&f?m:[]}));return r.forEach((function(e,t){return e.parent?e.parent=t-1:null})),r},Y=function(e){return e.filter((function(e){return e.selected}))}(G).length,$=function(e){L(e),U(X(c,P,G.map((function(t,a){return a%2==0?J(J({},t),{},{selected:e}):t})),T))},ee={items:[{title:"Select none",onClick:function(){return $(!1)}},{title:"Select all",onClick:function(){return $(!0)}}],count:Y,checked:x,onSelect:function(){return $(!x)}},te=function(e,t){var a=t.length>0?J(J({},P),(0,v.Z)({},e,t)):function(e){var t=J({},P);return delete t[e],t}(e);U(X(c,a,G,T)),S(a)},ae=[{label:"description",filterValues:{key:"text-filter",onChange:function(e,t){return function(e){var t=X(c,P,G,e);R(e),U(t)}(t)},value:T}},{label:H.total_risk.title,type:H.total_risk.type,id:H.total_risk.urlParam,value:"checkbox-".concat(H.total_risk.urlParam),filterValues:{key:"".concat(H.total_risk.urlParam,"-filter"),onChange:function(e,t){return te(H.total_risk.urlParam,t)},value:P.total_risk,items:H.total_risk.values}}],le={deleteTitle:a.formatMessage(p.resetFilters),filters:function(e){var t=Object.entries(e),a=e&&t.length>0?t.map((function(e){var t=H[e[0]],a=e[1].map((function(e){return{name:t.values.find((function(t){return t.value===String(e)})).label,value:e}}));return{category:(0,s.capitalize)(t.title),chips:a,urlParam:t.urlParam}})):[];return T.length>0&&a.push({category:"Name",chips:[{name:T,value:T}]}),a}(P),onDelete:function(e,t,a){a?(U(X(c,{},G,"")),S({}),R("")):t.map((function(e){"Name"===e.category?(U(X(c,P,G,"")),R("")):te(e.urlParam,P[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})))}))}};return(0,l.useEffect)((function(){var e=t;u(e),U(X(e,P,G,T))}),[]),n().createElement("div",null,n().createElement(Z.Z,{actionsConfig:{actions:K},bulkSelect:ee,filterConfig:{items:ae},pagination:n().createElement(n().Fragment,null,1===V?"".concat(V," ").concat(a.formatMessage(p.recommendation)):"".concat(V," ").concat(a.formatMessage(p.recommendations))),activeFiltersConfig:le}),c.length>0?n().createElement(n().Fragment,null,n().createElement(E.Table,{"aria-label":"Cluster recommendations table",onSelect:function(e,t,a){return U(X(c,P,G.map((function(e,l){return l===a?J(J({},e),{},{selected:t}):e})),T))},onCollapse:q,rows:G,cells:z,sortBy:f,canSelectAll:!1,onSort:function(e,t,a){var l={2:"description",3:"created_at",4:"total_risk"},n=function(){return c.concat().sort((function(e,a){return e[l[t]]>a[l[t]]?1:a[l[t]]>e[l[t]]?-1:0}))},r=a===E.SortByDirection.asc?n():n().reverse();u(r),g({index:t,direction:a}),U(X(r,P,G,T))},variant:E.TableVariant.compact,isStickyHeader:!0},n().createElement(E.TableHeader,null),n().createElement(E.TableBody,null)),0===V&&n().createElement(s.Card,null,n().createElement(s.CardBody,null,n().createElement(C,{title:a.formatMessage(p.noMatchingRecommendations),text:a.formatMessage(p.noMatchingRecommendationsDesc)})))):n().createElement(s.Card,null,n().createElement(s.CardBody,null,n().createElement(C,{icon:b.ZP,iconClass:"ins-c-insights__check",title:a.formatMessage(p.noRecommendations),text:a.formatMessage(p.noRecommendationsDesc)}))))};K.propTypes={reports:o().array.isRequired},K.defaultProps={reports:[]};const X=K;var Y=a(85991),$=a(49489),ee=a(74806),te=function(e){var t=e.current,a=e.match,r=e.intl,i=(0,l.useState)([]),o=(0,h.Z)(i,2),s=o[0],c=o[1],u=(0,l.useCallback)((function(){var e=[],t=a.url.split("/");e.push({title:"".concat(r.formatMessage(p.insightsHeader)," ").concat(t[1]),navigate:"/".concat(t[1])}),c(e)}),[r,a.params.clusterId,a.url]);return(0,l.useEffect)((function(){u()}),[u,a.params.clusterId,a.url]),n().createElement(n().Fragment,null,s.length>0&&n().createElement(Y.a,{ouiaId:"detail"},s.map((function(e,t){return n().createElement($.g,{key:t},n().createElement("span",null,e.title))})),n().createElement($.g,{isActive:!0},t)))};te.propTypes={current:o().string,match:o().object,intl:o().any};const ae=(0,ee.ZP)((0,m.Z)(te));var le=a(2095),ne=a(85962),re=a(24561);const ie=function(){return n().createElement(le.Zb,null,n().createElement(ne.e,null,n().createElement(re.aV,null)))};var oe=a(86362),se=function(e){var t,a=e.match,i=(0,oe.t)(a.params.clusterId),o=i.data,m=i.isUninitialized,f=i.isLoading,v=i.isFetching,y=i.isSuccess,h=i.isError,b=i.refetch,M=(0,r.Z)();return(0,l.useEffect)((function(){if(a.params.clusterId){var e="".concat(a.params.clusterId," - ").concat(M.formatMessage(p.clusters));document.title=M.formatMessage(p.documentTitle,{subnav:e})}b()}),[a.params.clusterId]),n().createElement(n().Fragment,null,n().createElement(u.Z,{className:"pf-m-light ins-inventory-detail"},n().createElement(ae,{current:a.params.clusterId,match:a}),n().createElement(g,{uuid:a.params.clusterId})),n().createElement(d.Z,null,n().createElement(n().Fragment,null,h&&n().createElement(C,{title:"No recommendations available",text:"There was an error fetching recommendations for this cluster. Refresh your page to try again.",icon:c.ZP}),(m||f||v)&&n().createElement(ie,null),y&&n().createElement(s.Grid,{hasGutter:!0},n().createElement(s.GridItem,{span:12},n().createElement(X,{reports:null==o||null===(t=o.report)||void 0===t?void 0:t.data}))))))};se.propTypes={history:o().object,match:o().any};const ce=(0,m.Z)(se)}}]);
//# sourceMappingURL=../sourcemaps/ClusterDetails.0d8e93f5ec15ff1ed443.js.map