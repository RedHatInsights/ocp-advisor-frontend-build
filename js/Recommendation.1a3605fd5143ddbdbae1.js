"use strict";(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[987],{52772:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ue});var r=n(93264),a=n.n(r),l=n(16530),c=n(15861),i=n(29439),o=n(87757),s=n.n(o),u=n(88931),m=n(86896),d=n(45697),f=n.n(d),p=n(56161),g=n(48716),b=n(39173),E=n(86350),v=n(62410),y=n(23218),h=n(34348),Z=n(71369),O=n(84564),P=n(7193),k=n(84785),w=n(96466),D=n(71355),C=n(6202),j=n(22910),I=n(96823),S=n(80765),x=n(36001),_=n(42057),M=n(56276),F=n(31728),N=n(59303),T=n(30893),R=n(1990),q=n(52661),B=n(4942);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,B.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=n(51957),H=n(86362),U=n(77572),V=n(48114),G=n(92223),J=n(32875),Q=n(7026),W=n(97530),Y=n(17335),K=n(12321),X=n(76),$=n(13877),ee=n(51014),te=n(28672);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,B.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){var t=e.query,n=t.isError,c=t.isUninitialized,o=t.isFetching,s=t.isSuccess,m=t.data,d=void 0===m?[]:m,f=(0,u.useDispatch)(),g=(0,u.useSelector)((function(e){return e.filters.affectedClustersState})),b=function(e){return f((0,te.BC)(e))},E=(0,r.useState)([]),v=(0,i.Z)(E,2),y=v[0],h=v[1],Z=(0,r.useState)([]),O=(0,i.Z)(Z,2),P=O[0],k=O[1],w=(0,r.useState)([]),D=(0,i.Z)(w,2),C=D[0],j=D[1],I=Number(g.limit),S=g.offset/g.limit+1,x={items:[{label:"Name",type:U.Yu.text,filterValues:{key:"name-filter",onChange:function(e,t){return function(e){var t=re(re({},g),{},{text:e,offset:0});b(t)}(t)},value:g.text}}],isDisabled:n||d&&0===d.length},_=function(e,t){var n=t*g.limit-g.limit;b(re(re({},g),{},{offset:n}))},M=function(e,t){b(re(re({},g),{},{limit:t}))};return(0,r.useEffect)((function(){var e=function(e,t){return e.filter((function(e){return null==e?void 0:e.cluster.includes(t.text)})).sort((function(e,n){return"asc"===t.sortDirection?null==e?void 0:e.cluster.localeCompare(null==n?void 0:n.cluster):null==n?void 0:n.cluster.localeCompare(null==e?void 0:e.cluster)}))}(d,g),t=function(e){return e.slice(I*(S-1),I*(S-1)+I)}(e),n=function(e,t){var n=e,r=n.findIndex((function(e){return"Name"===e.category}));return""===t?n.splice(r):-1===r?n.push({category:"Name",chips:[{name:t}]}):n[r]={category:"Name",chips:[{name:t}]},n}(C,g.text);h(e),k(t),j(n)}),[t,g]),a().createElement("div",{id:"affected-list-table"},a().createElement(V.Z,{filterConfig:x,pagination:{itemCount:y.length,page:S,perPage:I,onSetPage:_,onPerPageSelect:M},activeFiltersConfig:{filters:C,onDelete:function(){var e=re(re({},g),{},{text:""});b(e)}}}),(c||o)&&a().createElement(q.Z,null),n&&a().createElement(p.Card,null,a().createElement(p.CardBody,null,a().createElement(ee.Te,null))),s&&0===d.length&&a().createElement(p.Card,null,a().createElement(p.CardBody,null,a().createElement(ee.mi,null))),s&&d.length>0&&(y.length>0?a().createElement(W.i,{"aria-label":"Table of affected clusters",ouiaId:"affectedClustersTable",variant:"compact",cells:[{title:"Name",transforms:[Q.sortable]}],rows:P.map((function(e){return{cells:[a().createElement("span",{key:null==e?void 0:e.cluter},a().createElement(l.Link,{to:"/clusters/".concat(null==e?void 0:e.cluster)},null==e?void 0:e.cluster))]}})),sortBy:{index:g.sortIndex,direction:g.sortDirection},onSort:function(e,t,n){b(re(re({},g),{},{sortIndex:t,sortDirection:n}))}},a().createElement(K.x,null),a().createElement(Y.R,null)):a().createElement(G.Z,null,a().createElement(X.Bullseye,null,a().createElement(ee.VA,null)))),a().createElement(J.Z,{isFooter:!0,className:"ins-c-inventory__table--toolbar"},a().createElement($.Pagination,{variant:$.PaginationVariant.bottom,itemCount:y.length,page:S,perPage:I,onSetPage:_,onPerPageSelect:M,onPageInput:_})))};ae.propTypes={query:f().shape({isError:f().bool.isRequired,isUninitialized:f().bool.isRequired,isFetching:f().bool.isRequired,isSuccess:f().bool.isRequired,data:f().array})};const le=function(){var e=(0,H.tf)((0,l.useParams)().recommendationId);return a().createElement(ae,{query:e})};var ce=n(71094),ie=n(73451),oe=function(e){var t=e.rule,n=e.ack,l=e.match,o=(0,m.Z)(),d=(0,u.useDispatch)(),f=function(e){return d((0,D.wN)(e))},B=l.params.recommendationId,L=(0,r.useState)(!1),U=(0,i.Z)(L,2),V=U[0],G=U[1],J=(0,r.useState)(!1),Q=(0,i.Z)(J,2),W=Q[0],Y=Q[1],K=t.isError,X=t.isUninitialized,$=t.isLoading,ee=t.isFetching,te=t.isSuccess,ne=t.data,re=t.refetch,ae=n.data,oe=void 0===ae?{}:ae,se=n.isFetching,ue=n.refetch,me=te?function(e,t){var n,r=(null==e||null===(n=e.error_keys)||void 0===n?void 0:n[function(e){var t;return null===(t=e.split("|"))||void 0===t?void 0:t[1]}(t)])||{},a=z(z(z({},e),r),(null==r?void 0:r.metadata)||(null==e?void 0:e.metadata)||{});return a.impact={impact:a.impact},delete a.metadata,delete a.error_keys,a}(ne.content,B):void 0,de=function(){var e=(0,c.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:re(),ue();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(e){G(e)},pe=function(){var e=(0,c.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,ce.H)("".concat(H._n,"/ack/").concat(t.rule_id,"/"));case 3:f({variant:"success",timeout:!0,dismissable:!0,title:o.formatMessage(T.Z.recSuccessfullyEnabled)}),re(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),fe(!1),f({variant:"danger",dismissable:!0,title:o.formatMessage(T.Z.error),description:"".concat(e.t0)});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return a().createElement(a().Fragment,null,V&&a().createElement(ie.Z,{handleModalToggle:fe,isModalOpen:V,rule:me,afterFn:de}),a().createElement(g.Z,{className:"pageHeaderOverride"},a().createElement(M.Z,{current:(null==me?void 0:me.description)||B})),(X||$||ee)&&a().createElement(E.Z,null,a().createElement(q.Z,null)),K&&a().createElement(E.Z,null,a().createElement(A.Z,{title:o.formatMessage(T.Z.unableToConnect),text:o.formatMessage(T.Z.unableToConnectDesc),icon:O.default,iconStyle:{color:P.Q7.value}})),!(X||$||ee)&&te&&a().createElement(a().Fragment,null,a().createElement(E.Z,{className:"pf-m-light pf-u-pt-sm"},a().createElement(R.Z,{isOpenShift:!0,isDetailsPage:!0,rule:me,header:a().createElement(a().Fragment,null,a().createElement(b.Z,{title:a().createElement(a().Fragment,null,me.description," ",a().createElement(F.Z,{rule:me}))}),a().createElement("p",null,o.formatMessage(T.Z.rulesDetailsPubishdate,{date:a().createElement(v.Z,{date:new Date(me.publish_date),type:"onlyDate"})}),me.tags&&(Array.isArray(me.tags)?a().createElement(Z.LabelGroup,{className:"categoryLabels",numLabels:1},me.tags.reduce((function(e,t){return N.kT[t]&&e.push(a().createElement(y.Label,{key:"label-".concat(t),color:"blue"},N.W2.category.values[N.kT[t]-1].label)),e}),[])):a().createElement(y.Label,null,me.tags)))),onFeedbackChanged:function(){var e=(0,c.Z)(s().mark((function e(t,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ce.S)("".concat(H._n,"/v2/rating"),{},{rule:t,rating:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},a().createElement(x.k,null,a().createElement(_.B,{align:{default:"alignRight"}},a().createElement(j.Dropdown,{className:"ins-c-rec-details__actions_dropdown",onSelect:function(){return Y(!W)},position:"right",ouiaId:"actions",toggle:a().createElement(S.DropdownToggle,{onToggle:function(e){return Y(e)},toggleIndicator:w.default},o.formatMessage(T.Z.actions)),isOpen:W,dropdownItems:null!=me&&me.disabled?[a().createElement(I.DropdownItem,{key:"link",ouiaId:"enable",onClick:function(){pe(t)}},o.formatMessage(T.Z.enableRule))]:[a().createElement(I.DropdownItem,{key:"link",ouiaId:"disable",onClick:function(){fe(!0)}},o.formatMessage(T.Z.disableRule))]}))))),a().createElement(E.Z,null,a().createElement(a().Fragment,null,(null==me?void 0:me.disabled)&&a().createElement(p.Card,{className:"cardOverride"},a().createElement(p.CardHeader,null,a().createElement(h.Title,{headingLevel:"h4",size:"xl"},a().createElement(k.ZP,{size:"sm"})," ",o.formatMessage(T.Z.ruleIsDisabled))),a().createElement(p.CardBody,null,!se&&a().createElement(a().Fragment,null,o.formatMessage(T.Z.ruleIsDisabledJustification),a().createElement("i",null,oe.justification||o.formatMessage(T.Z.none)),(oe.updated_at||oe.created_at)&&a().createElement("span",null," ",a().createElement(v.Z,{date:new Date(oe.updated_at||oe.created_at),type:"onlyDate"})))),a().createElement(p.CardFooter,null,a().createElement(C.Button,{isInline:!0,variant:"link",onClick:function(){return pe(t)},ouiaId:"rule"},o.formatMessage(T.Z.enableRule)))),!(null!=me&&me.disabled)&&a().createElement(a().Fragment,null,a().createElement(h.Title,{className:"titleOverride",headingLevel:"h3",size:"2xl"},o.formatMessage(T.Z.affectedClusters)),a().createElement(le,null)),(null==me?void 0:me.disabled)&&a().createElement(A.Z,{icon:k.ZP,title:o.formatMessage(T.Z.ruleIsDisabled),text:o.formatMessage(T.Z.ruleIsDisabledBody)})))))};oe.propTypes={rule:f().object.isRequired,ack:f().object.isRequired,match:f().object.isRequired};var se=n(77647);const ue=function(){var e=(0,H.qv)((0,l.useParams)().recommendationId),t=(0,se.yr)({ruleId:(0,l.useParams)().recommendationId});return(0,r.useEffect)((function(){e.refetch()}),[(0,l.useParams)().recommendationId]),a().createElement(oe,{rule:e,ack:t,match:(0,l.useRouteMatch)()})}}}]);
//# sourceMappingURL=../sourcemaps/Recommendation.32fa2f7783d29f91484d45f2088bf237.js.map