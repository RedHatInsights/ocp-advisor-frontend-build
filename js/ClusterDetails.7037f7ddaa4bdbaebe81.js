(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[619],{81075:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>de});var l=a(93264),n=a.n(l),r=a(36873),i=a(86896),s=a(86362);const o=(0,a(50049).vU)({documentTitle:{id:"documentTitle",defaultMessage:[{type:1,value:"subnav"},{type:0,value:" - OCP Advisor | Red Hat Insights"}]},clusters:{id:"clusters",defaultMessage:[{type:0,value:"Clusters"}]},added:{id:"added",defaultMessage:[{type:0,value:"Added"}]},loading:{id:"loading",defaultMessage:[{type:0,value:"Loading"}]},lastSeen:{id:"lastSeen",defaultMessage:[{type:0,value:"Last seen"}]},actions:{id:"actions",defaultMessage:[{type:0,value:"Actions"}]},name:{id:"name",defaultMessage:[{type:0,value:"Name"}]},filterBy:{id:"filterBy",defaultMessage:[{type:0,value:"Filter by name"}]},totalRisk:{id:"totalRisk",defaultMessage:[{type:0,value:"Total risk"}]},recommendation:{id:"recommendation",defaultMessage:[{type:0,value:"Recommendation"}]},recommendations:{id:"recommendations",defaultMessage:[{type:0,value:"Recommendations"}]},insightsHeader:{id:"insightsHeader",defaultMessage:[{type:0,value:"Advisor"}]},unknown:{id:"unknown",defaultMessage:[{type:0,value:"Unknown"}]},low:{id:"low",defaultMessage:[{type:0,value:"Low"}]},moderate:{id:"moderate",defaultMessage:[{type:0,value:"Moderate"}]},important:{id:"important",defaultMessage:[{type:0,value:"Important"}]},critical:{id:"critical",defaultMessage:[{type:0,value:"Critical"}]},veryLow:{id:"veryLow",defaultMessage:[{type:0,value:"Very Low"}]},medium:{id:"medium",defaultMessage:[{type:0,value:"Medium"}]},high:{id:"high",defaultMessage:[{type:0,value:"High"}]},availability:{id:"availability",defaultMessage:[{type:0,value:"Availability"}]},performance:{id:"performance",defaultMessage:[{type:0,value:"Performance"}]},stability:{id:"stability",defaultMessage:[{type:0,value:"Stability"}]},security:{id:"security",defaultMessage:[{type:0,value:"Security"}]},enabled:{id:"enabled",defaultMessage:[{type:0,value:"Enabled"}]},impact:{id:"impact",defaultMessage:[{type:0,value:"Impact"}]},impactLevel:{id:"impactLevel",defaultMessage:[{type:1,value:"level"},{type:0,value:" impact"}]},impactDescription:{id:"impactDescription",defaultMessage:[{type:0,value:"The impact of the problem would be "},{type:1,value:"level"},{type:0,value:" if it occurred."}]},category:{id:"category",defaultMessage:[{type:0,value:"Category"}]},likelihood:{id:"likelihood",defaultMessage:[{type:0,value:"Likelihood"}]},likelihoodLevel:{id:"likelihoodLevel",defaultMessage:[{type:1,value:"level"},{type:0,value:" likelihood"}]},likelihoodDescription:{id:"likelihoodDescription",defaultMessage:[{type:0,value:"The likelihood that this will be a problem is "},{type:1,value:"level"},{type:0,value:"."}]},all:{id:"all",defaultMessage:[{type:0,value:"All"}]},disabled:{id:"disabled",defaultMessage:[{type:0,value:"Disabled"}]},resetFilters:{id:"resetFilters",defaultMessage:[{type:0,value:"Reset filters"}]},noMatchingRecommendations:{id:"noMatchingRecommendations",defaultMessage:[{type:0,value:"No matching recommendations found"}]},noMatchingRecommendationsDesc:{id:"noMatchingRecommendationsDesc",defaultMessage:[{type:0,value:"This filter criteria matches no recommendations. Try changing your filter settings."}]},noRecommendations:{id:"noRecommendations",defaultMessage:[{type:0,value:"None of your connected systems are affected by any known recommendations."}]},noRecommendationsDesc:{id:"noRecommendationsDesc",defaultMessage:[{type:0,value:"No known recommendations affect this cluster."}]}});var c=a(45697),u=a.n(c),d=a(58788),m=a(48794),p=a(48716),f=a(86350),g=a(44034),v=a(43),y=a(56455),h=function(e){var t=e.clusterId,a=e.lastSeen,l=e.displayName,r=(0,i.Z)(),s=l.isUninitialized,c=l.isLoading,u=l.isFetching,m=l.data;return n().createElement(n().Fragment,null,n().createElement(d.Grid,{md:12,hasGutter:!0},n().createElement(d.GridItem,null,s||c||u?n().createElement(y.Z,{size:"sm"}):n().createElement(d.Title,{size:"2xl",headingLevel:"h1"},m||t)),n().createElement(d.GridItem,null,n().createElement(d.Stack,null,n().createElement(d.StackItem,null,n().createElement("span",null,"UUID: "),n().createElement("span",null,t||r.formatMessage(o.unknown))),n().createElement(d.StackItem,null,n().createElement("span",null,r.formatMessage(o.lastSeen),": "),n().createElement("span",null,a||r.formatMessage(o.unknown)))))))};h.propTypes={clusterId:u().string.isRequired,displayName:u().object.isRequired,lastSeen:u().string};const b=(0,g.xp)((function(e){var t,a=e.match.params.clusterId,l=(0,v.u)(a),r=(0,s.y0)(a).data;return n().createElement(h,{clusterId:a,displayName:l,lastSeen:null==r||null===(t=r.report)||void 0===t?void 0:t.lastSeen})}));var M=a(96156),k=a(85061),E=a(28481),Z=a(44535),O=a(26899),w=a(78216),S=a(94550),P=a(57277),j=a(219),_=a(96733),C=a(74183),R=a(86728),T=a(34348),D=function(e){var t=e.className,a=e.children,l=e.icon,r=e.iconClass,i=e.iconStyle,s=e.text,o=e.title,c=e.variant;return n().createElement(j.ub,{className:t,variant:c},"none"!==l&&n().createElement(R.k,{className:r,style:i,icon:l}),n().createElement(T.Title,{headingLevel:"h5",size:"lg"},o),n().createElement(C.B,{style:{marginBottom:"16px"}},s),a)};D.propTypes={children:u().any,icon:u().any,iconClass:u().any,iconStyle:u().any,text:u().any,title:u().string,variant:u().any,className:u().string},D.defaultProps={icon:_.ZP,title:"",variant:j.IQ.full};const I=D;var x=a(82644),L=a(29558),N=a(13976),F=(0,x.Sn)(),A=navigator.language.slice(0,2),B=(0,L.d)({onError:console.error,locale:A},F),G={locale:A},H={1:(0,N.Z)(B.formatMessage(o.low),G),2:(0,N.Z)(B.formatMessage(o.medium),G),3:(0,N.Z)(B.formatMessage(o.high),G),4:(0,N.Z)(B.formatMessage(o.critical),G)},q={1:(0,N.Z)(B.formatMessage(o.low),G),2:(0,N.Z)(B.formatMessage(o.medium),G),3:(0,N.Z)(B.formatMessage(o.high),G),4:(0,N.Z)(B.formatMessage(o.critical),G)},z={1:(0,N.Z)(B.formatMessage(o.low),G),2:(0,N.Z)(B.formatMessage(o.moderate),G),3:(0,N.Z)(B.formatMessage(o.important),G),4:(0,N.Z)(B.formatMessage(o.critical),G)},U={1:(0,N.Z)(B.formatMessage(o.veryLow),G),2:(0,N.Z)(B.formatMessage(o.low),G),3:(0,N.Z)(B.formatMessage(o.moderate),G),4:(0,N.Z)(B.formatMessage(o.high),G)},V={total_risk:{type:"checkbox",title:"total risk",urlParam:"total_risk",values:[{label:z[4],value:"4"},{label:z[3],value:"3"},{label:z[2],value:"2"},{label:z[1],value:"1"}]},res_risk:{type:"checkbox",title:"risk of change",urlParam:"res_risk",values:[{label:U[4],value:"4"},{label:U[3],value:"3"},{label:U[2],value:"2"},{label:U[1],value:"1"}]},impact:{type:"checkbox",title:"impact",urlParam:"impact",values:[{label:q[4],value:"4"},{label:q[3],value:"3"},{label:q[2],value:"2"},{label:q[1],value:"1"}]},likelihood:{type:"checkbox",title:"likelihood",urlParam:"likelihood",values:[{label:H[4],value:"4"},{label:H[3],value:"3"},{label:H[2],value:"2"},{label:H[1],value:"1"}]},rule_status:{type:"radio",title:"status",urlParam:"rule_status",values:[{label:(0,N.Z)(B.formatMessage(o.all),G),value:"all"},{label:(0,N.Z)(B.formatMessage(o.enabled),G),value:"enabled"},{label:(0,N.Z)(B.formatMessage(o.disabled),G),value:"disabled"}]}},W=a(22663);function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){(0,M.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var K=function(e){var t=e.report;return n().createElement("div",{className:"advisor"},n().createElement(W.Z,{appName:"advisor",module:"./AdvisorReportDetails",report:J(J({},t),{},{details:t.extra_data,resolution:{resolution:t.resolution}})}))};K.propTypes={report:u().object.isRequired};const X=K;function Y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(a),!0).forEach((function(t){(0,M.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ee=function(e){var t=e.reports,a=(0,i.Z)(),r=(0,l.useState)([]),s=(0,E.Z)(r,2),c=s[0],u=s[1],m=(0,l.useState)({}),p=(0,E.Z)(m,2),f=p[0],g=p[1],v=(0,l.useState)({}),y=(0,E.Z)(v,2),h=y[0],b=y[1],j=(0,l.useState)(""),_=(0,E.Z)(j,2),C=_[0],R=_[1],T=(0,l.useState)(!1),D=(0,E.Z)(T,2),x=D[0],L=D[1],N=(0,l.useState)([]),F=(0,E.Z)(N,2),A=F[0],B=F[1],G=A?A.length/2:0,z=[{title:a.formatMessage(o.name),transforms:[S.sortable]},{title:a.formatMessage(o.added),transforms:[S.sortable,(0,S.cellWidth)(15)]},{title:a.formatMessage(o.totalRisk),transforms:[S.sortable,(0,S.cellWidth)(15)]}],U=function(e,t,a){var l=(0,k.Z)(A);l[t]=$($({},l[t]),{},{isOpen:a}),B(l)},W=function(e){var t="insights-expand-all"===e,a=(0,k.Z)(A);a.map((function(e,a){Object.prototype.hasOwnProperty.call(e,"isOpen")&&(e.isOpen=t,t&&U(0,a,t))})),B(a)},Q=[{label:"Collapse all",onClick:function(){return W("insights-collapse-all")}},{label:"Expand all",onClick:function(){return W("insights-expand-all")}}],J=function(e,t,a){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=e.flatMap((function(e,r){var i=e,s=e.resolution,o=a.filter((function(e,t){return t%2==0&&e.rule.rule_id===i.rule_id&&e})),c=!!o.length&&o[0].selected,u=a.length?!!o.length&&o[0].isOpen:0===r,m=[{rule:i,resolution:s,isOpen:u,selected:c,cells:[{title:n().createElement("div",null," ",i.description)},{title:n().createElement("div",{key:r},n().createElement(O.Z,{date:i.created_at,type:"relative",tooltipProps:{position:d.TooltipPosition.bottom}}))},{title:n().createElement("div",{key:r,style:{verticalAlign:"top"}},n().createElement(d.Tooltip,{key:r,position:d.TooltipPosition.bottom,content:n().createElement("span",null,"The ",n().createElement("strong",null,"likelihood")," that this will be a problem is"," ",null!=i&&i.likelihood?H[null==i?void 0:i.likelihood]:"unknown",". The ",n().createElement("strong",null,"impact")," of the problem would be"," ",null!=i&&i.impact?q[null==i?void 0:i.impact]:"unknown"," ","if it occurred.")},n().createElement(w.Z,{value:i.total_risk})))}]},{parent:r,fullWidth:!0,cells:[{title:n().createElement(X,{key:"child-".concat(r),report:e})}]}],p=0===l.length||i.description.toLowerCase().includes(l.toLowerCase()),f=0===Object.keys(t).length||Object.keys(t).map((function(e){var a=t[e],l={created_at:i.created_at,total_risk:i.total_risk,tags:i.tags};return a.find((function(t){return String(t)===String(l[e])}))})).every((function(e){return e}));return p&&f?m:[]}));return r.forEach((function(e,t){return e.parent?e.parent=t-1:null})),r},K=function(e){return e.filter((function(e){return e.selected}))}(A).length,Y=function(e){L(e),B(J(c,h,A.map((function(t,a){return a%2==0?$($({},t),{},{selected:e}):t})),C))},ee={items:[{title:"Select none",onClick:function(){return Y(!1)}},{title:"Select all",onClick:function(){return Y(!0)}}],count:K,checked:x,onSelect:function(){return Y(!x)}},te=function(e,t){var a=t.length>0?$($({},h),(0,M.Z)({},e,t)):function(e){var t=$({},h);return delete t[e],t}(e);B(J(c,a,A,C)),b(a)},ae=[{label:"description",filterValues:{key:"text-filter",onChange:function(e,t){return function(e){var t=J(c,h,A,e);R(e),B(t)}(t)},value:C}},{label:V.total_risk.title,type:V.total_risk.type,id:V.total_risk.urlParam,value:"checkbox-".concat(V.total_risk.urlParam),filterValues:{key:"".concat(V.total_risk.urlParam,"-filter"),onChange:function(e,t){return te(V.total_risk.urlParam,t)},value:h.total_risk,items:V.total_risk.values}}],le={deleteTitle:a.formatMessage(o.resetFilters),filters:function(e){var t=Object.entries(e),a=e&&t.length>0?t.map((function(e){var t=V[e[0]],a=e[1].map((function(e){return{name:t.values.find((function(t){return t.value===String(e)})).label,value:e}}));return{category:(0,d.capitalize)(t.title),chips:a,urlParam:t.urlParam}})):[];return C.length>0&&a.push({category:"Name",chips:[{name:C,value:C}]}),a}(h),onDelete:function(e,t,a){a?(B(J(c,{},A,"")),b({}),R("")):t.map((function(e){"Name"===e.category?(B(J(c,h,A,"")),R("")):te(e.urlParam,h[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})))}))}};return(0,l.useEffect)((function(){var e=t;u(e),B(J(e,h,A,C))}),[]),n().createElement("div",null,n().createElement(P.Z,{actionsConfig:{actions:Q},bulkSelect:ee,filterConfig:{items:ae},pagination:n().createElement(n().Fragment,null,1===G?"".concat(G," ").concat(a.formatMessage(o.recommendation)):"".concat(G," ").concat(a.formatMessage(o.recommendations))),activeFiltersConfig:le}),c.length>0?n().createElement(n().Fragment,null,n().createElement(S.Table,{"aria-label":"Cluster recommendations table",onSelect:function(e,t,a){return B(J(c,h,A.map((function(e,l){return l===a?$($({},e),{},{selected:t}):e})),C))},onCollapse:U,rows:A,cells:z,sortBy:f,canSelectAll:!1,onSort:function(e,t,a){var l={2:"description",3:"created_at",4:"total_risk"},n=function(){return c.concat().sort((function(e,a){return e[l[t]]>a[l[t]]?1:a[l[t]]>e[l[t]]?-1:0}))},r=a===S.SortByDirection.asc?n():n().reverse();u(r),g({index:t,direction:a}),B(J(r,h,A,C))},variant:S.TableVariant.compact,isStickyHeader:!0},n().createElement(S.TableHeader,null),n().createElement(S.TableBody,null)),0===G&&n().createElement(d.Card,null,n().createElement(d.CardBody,null,n().createElement(I,{title:a.formatMessage(o.noMatchingRecommendations),text:a.formatMessage(o.noMatchingRecommendationsDesc)})))):n().createElement(d.Card,null,n().createElement(d.CardBody,null,n().createElement(I,{icon:Z.ZP,iconClass:"ins-c-insights__check",title:a.formatMessage(o.noRecommendations),text:a.formatMessage(o.noRecommendationsDesc)}))))};ee.propTypes={reports:u().array.isRequired},ee.defaultProps={reports:[]};const te=ee;var ae=a(85991),le=a(49489),ne=function(e){var t=e.current,a=e.match,r=(0,i.Z)(),s=(0,l.useState)([]),c=(0,E.Z)(s,2),u=c[0],d=c[1],m=(0,l.useCallback)((function(){console.log("meow");var e=[],t=a.url.split("/");e.push({title:"".concat(r.formatMessage(o.insightsHeader)," ").concat(t[1]),navigate:"/".concat(t[1])}),d(e)}),[r,a.params.clusterId,a.url]);return(0,l.useEffect)((function(){m()}),[m,a.params.clusterId,a.url]),n().createElement(n().Fragment,null,u.length>0&&n().createElement(ae.a,{ouiaId:"detail"},u.map((function(e,t){return n().createElement(le.g,{key:t},n().createElement("span",null,e.title))})),n().createElement(le.g,{isActive:!0},t)))};ne.propTypes={current:u().string,match:u().object};const re=(0,r.Z)((function(e){var t=e.match,a=e.current;return n().createElement(ne,{current:a,match:t})}));var ie=a(2095),se=a(85962),oe=a(24561);const ce=function(){return n().createElement(ie.Zb,null,n().createElement(se.e,null,n().createElement(oe.aV,null)))};var ue=function(e){var t,a=e.cluster,l=e.match,r=a.isError,i=a.isUninitialized,s=a.isLoading,o=a.isFetching,c=a.isSuccess,u=a.data;return n().createElement(n().Fragment,null,n().createElement(p.Z,{className:"pf-m-light ins-inventory-detail"},n().createElement(re,{current:l.params.clusterId,match:l}),n().createElement(b,null)),n().createElement(f.Z,null,n().createElement(n().Fragment,null,r&&n().createElement(I,{title:"No recommendations available",text:"There was an error fetching recommendations for this cluster. Refresh your page to try again.",icon:m.ZP}),(i||s||o)&&n().createElement(ce,null),c&&n().createElement(d.Grid,{hasGutter:!0},n().createElement(d.GridItem,{span:12},n().createElement(te,{reports:(null==u||null===(t=u.report)||void 0===t?void 0:t.data)||[]}))))))};ue.propTypes={cluster:u().object.isRequired,match:u().object.isRequired};const de=(0,r.Z)((function(e){var t=e.match,a=(0,i.Z)(),r=(0,s.th)(t.params.clusterId);return(0,l.useEffect)((function(){r.refetch()}),[t.params.clusterId]),(0,l.useEffect)((function(){if(t.params.clusterId){var e="".concat(t.params.clusterId," - ").concat(a.formatMessage(o.clusters));document.title=a.formatMessage(o.documentTitle,{subnav:e})}}),[t.params.clusterId]),n().createElement(ue,{cluster:r,match:t})}))}}]);
//# sourceMappingURL=../sourcemaps/ClusterDetails.f2855163aa0a0bbb837a.js.map