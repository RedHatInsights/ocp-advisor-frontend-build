"use strict";(self.webpackChunkocp_advisor_frontend=self.webpackChunkocp_advisor_frontend||[]).push([[619],{39697:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Y});var a=r(93264),n=r.n(a),l=r(36873),o=r(86896),i=r(86362),c=r(30893),s=r(45697),u=r.n(s),m=r(57361),d=r(84564),p=r(31369),f=r(48716),g=r(86350),v=r(7193),y=r(28058),h=r(44034),E=r(43),b=r(88292),k=r(47778),Z=r(56455),O=function(e){var t=e.clusterId,r=e.lastSeen,a=e.displayName,l=(0,o.Z)(),i=a.isUninitialized,s=a.isLoading,u=a.isFetching,d=a.data;return n().createElement(m.Grid,{id:"cluster-header",md:12,hasGutter:!0},n().createElement(m.GridItem,null,i||s||u?n().createElement(Z.Z,{size:"sm"}):n().createElement(k.Title,{size:"2xl",headingLevel:"h1",id:"cluster-header-title"},d||t)),n().createElement(m.GridItem,null,n().createElement(b.Stack,null,n().createElement(b.StackItem,{id:"cluster-header-uuid"},n().createElement("span",null,"UUID: "),n().createElement("span",null,t||l.formatMessage(c.Z.unknown))),r&&n().createElement(b.StackItem,{id:"cluster-header-last-seen"},n().createElement("span",null,l.formatMessage(c.Z.lastSeen),": "),n().createElement("span",null,r||l.formatMessage(c.Z.unknown))))))};O.propTypes={clusterId:u().string.isRequired,displayName:u().object.isRequired,lastSeen:u().string};const P=(0,h.xp)((function(e){var t,r=e.match.params.clusterId,a=(0,E.u)(r),l=(0,i.y0)(r).data;return n().createElement(O,{clusterId:r,displayName:a,lastSeen:null==l||null===(t=l.report)||void 0===t?void 0:t.lastSeen})}));var _=r(4942),S=r(93433),j=r(29439),w=r(44535),W=r(26899),C=r(78216),I=r(94550),D=r(42319),M=r(56161),T=r(8045),R=r(48114),F=r(51957),x=r(59303),N=r(22663),V=r(52661);function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){(0,_.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var z=function(e){var t=e.report;return n().createElement("div",{className:"advisor"},n().createElement(N.Z,{appName:"advisor",module:"./AdvisorReportDetails",fallback:n().createElement(V.Z,null),report:G(G({},t),{},{details:t.extra_data,resolution:{resolution:t.resolution}})}))};z.propTypes={report:u().object.isRequired};const A=z;var B=r(31728),L=r(51014);function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){(0,_.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var J=function(e){var t,r,l=e.reports,i=(0,o.Z)(),s=(0,a.useState)([]),u=(0,j.Z)(s,2),m=u[0],d=u[1],p=(0,a.useState)({}),f=(0,j.Z)(p,2),g=f[0],v=f[1],y=(0,a.useState)(x.FV),h=(0,j.Z)(y,2),E=h[0],b=h[1],k=(0,a.useState)(""),Z=(0,j.Z)(k,2),O=Z[0],P=Z[1],N=(0,a.useState)([]),V=(0,j.Z)(N,2),q=V[0],G=V[1],z=q?q.length/2:0,U=[{title:i.formatMessage(c.Z.description),transforms:[I.sortable]},{title:i.formatMessage(c.Z.added),transforms:[I.sortable,(0,I.cellWidth)(15)]},{title:i.formatMessage(c.Z.totalRisk),transforms:[I.sortable,(0,I.cellWidth)(15)]}],J=function(e,t,r){var a=(0,S.Z)(q);a[t]=H(H({},a[t]),{},{isOpen:r}),G(a)},Q=function(e){var t="insights-expand-all"===e,r=(0,S.Z)(q);r.map((function(e,r){Object.prototype.hasOwnProperty.call(e,"isOpen")&&(e.isOpen=t,t&&J(0,r,t))})),G(r)},K=[{label:"Collapse all",onClick:function(){return Q("insights-collapse-all")}},{label:"Expand all",onClick:function(){return Q("insights-expand-all")}}],X=function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",l=e.flatMap((function(e,l){var o=e,i=e.resolution,c=r.filter((function(e,t){return t%2==0&&e.rule.rule_id===o.rule_id&&e})),s=r.length?!!c.length&&c[0].isOpen:0===l,u=[{rule:o,resolution:i,isOpen:s,cells:[{title:n().createElement("div",null,o.description," ",n().createElement(B.Z,{rule:e}))},{title:n().createElement("div",{key:l},n().createElement(W.Z,{date:o.created_at,type:"relative",tooltipProps:{position:T.TooltipPosition.bottom}}))},{title:n().createElement("div",{key:l,style:{verticalAlign:"top"}},null!=o&&o.likelihood&&null!=o&&o.impact?n().createElement(T.Tooltip,{key:l,position:T.TooltipPosition.bottom,content:n().createElement("span",null,"The ",n().createElement("strong",null,"likelihood")," that this will be a problem is"," ",o.likelihood?x.As[o.likelihood]:"unknown",". The ",n().createElement("strong",null,"impact")," of the problem would be"," ",o.impact?x.dz[o.impact]:"unknown"," ","if it occurred.")},n().createElement(C.Z,{value:o.total_risk})):n().createElement(C.Z,{value:o.total_risk}))}]},{parent:l,fullWidth:!0,cells:[{title:n().createElement(A,{key:"child-".concat(l),report:e})}]}],m=0===a.length||o.description.toLowerCase().includes(a.toLowerCase()),d=0===Object.keys(t).length||Object.keys(t).map((function(e){var r=t[e],a={created_at:o.created_at,total_risk:o.total_risk,category:o.tags,rule_status:o.disabled?"disabled":"enabled"};return"category"===e?a[e].find((function(e){return r.includes(String(x.kT[e]))})):"rule_status"===e?"all"===r||a[e]===r:r.find((function(t){return String(t)===String(a[e])}))})).every((function(e){return e}));return m&&d?u:[]}));return l.forEach((function(e,t){return e.parent?e.parent=t-1:null})),l},Y=function(e,t){var r=t.length>0?H(H({},E),(0,_.Z)({},e,t)):function(e){var t=H({},E);return delete t[e],t}(e);G(X(m,r,q,O)),b(r)},$=[{label:"description",filterValues:{key:"text-filter",onChange:function(e,t){return function(e){var t=X(m,E,q,e);P(e),G(t)}(t)},value:O}},{label:x.W2.total_risk.title,type:x.W2.total_risk.type,id:x.W2.total_risk.urlParam,value:"checkbox-".concat(x.W2.total_risk.urlParam),filterValues:{key:"".concat(x.W2.total_risk.urlParam,"-filter"),onChange:function(e,t){return Y(x.W2.total_risk.urlParam,t)},value:E.total_risk,items:x.W2.total_risk.values}},{label:x.W2.category.title,type:x.W2.category.type,id:x.W2.category.urlParam,value:"checkbox-".concat(x.W2.category.urlParam),filterValues:{key:"".concat(x.W2.category.urlParam,"-filter"),onChange:function(e,t){return Y(x.W2.category.urlParam,t)},value:E.category,items:x.W2.category.values}},{label:x.W2.rule_status.title,type:x.W2.rule_status.type,id:x.W2.rule_status.urlParam,value:"radio-".concat(x.W2.rule_status.urlParam),filterValues:{key:"".concat(x.W2.rule_status.urlParam,"-filter"),onChange:function(e,t){return r=t,a=H(H({},E),{},{rule_status:r}),G(X(m,a,q,O)),void b(a);var r,a},value:E.rule_status,items:x.W2.rule_status.values}}],ee={deleteTitle:i.formatMessage(c.Z.resetFilters),filters:(t=Object.entries(E),r=E&&t.length>0?t.map((function(e){var t=x.W2[e[0]],r=Array.isArray(e[1])?e[1].map((function(e){return{name:t.values.find((function(t){return t.value===String(e)})).label,value:e}})):[{name:t.values.find((function(t){return t.value===String(e[1])})).label,value:e[1]}];return{category:(0,D.capitalize)(t.title),chips:r,urlParam:t.urlParam}})):[],O.length>0&&r.push({category:"Description",chips:[{name:O,value:O}]}),r),onDelete:function(e,t,r){r?(G(X(m,x.FV,q,"")),b(x.FV),P("")):t.map((function(e){switch(e.category){case"Description":G(X(m,E,q,"")),P("");break;case"Status":Y(e.urlParam,[]);break;default:Y(e.urlParam,E[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})))}}))}};return(0,a.useEffect)((function(){var e=l;d(e),G(X(e,E,q,O))}),[]),n().createElement("div",{id:"cluster-recs-list-table"},n().createElement(R.Z,{actionsConfig:{actions:K},filterConfig:{items:$,isDisabled:0===m.length},pagination:n().createElement(n().Fragment,null,1===z?"".concat(z," ").concat(i.formatMessage(c.Z.recommendation)):"".concat(z," ").concat(i.formatMessage(c.Z.recommendations))),activeFiltersConfig:0===m.length?void 0:ee}),m.length>0?n().createElement(n().Fragment,null,n().createElement(I.Table,{"aria-label":"Cluster recommendations table",ouiaId:"cluster-recommendations",onCollapse:J,rows:q,cells:U,sortBy:g,onSort:function(e,t,r){var a={1:"description",2:"created_at",3:"total_risk"},n=function(){return m.concat().sort((function(e,r){return e[a[t]]>r[a[t]]?1:r[a[t]]>e[a[t]]?-1:0}))},l=r===I.SortByDirection.asc?n():n().reverse();d(l),v({index:t,direction:r}),G(X(l,E,q,O))},variant:I.TableVariant.compact,isStickyHeader:!0},n().createElement(I.TableHeader,null),n().createElement(I.TableBody,null)),0===z&&n().createElement(M.Card,{ouiaId:"empty-recommendations"},n().createElement(M.CardBody,null,n().createElement(L.A0,null)))):n().createElement(M.Card,null,n().createElement(M.CardBody,null,n().createElement(F.Z,{icon:w.default,iconClass:"ins-c-insights__check",title:i.formatMessage(c.Z.noRecommendations),text:i.formatMessage(c.Z.noRecommendationsDesc)}))))};J.propTypes={reports:u().array.isRequired},J.defaultProps={reports:[]};const Q=J;var K=r(56276),X=function(e){var t,r=e.cluster,a=e.displayName,l=e.match,i=(0,o.Z)(),s=r.isError,u=r.isUninitialized,h=r.isLoading,E=r.isFetching,b=r.isSuccess,k=r.data,Z=r.error,O=a.data;return n().createElement(n().Fragment,null,n().createElement(f.Z,{className:"pf-m-light ins-inventory-detail"},n().createElement(K.Z,{current:O||l.params.clusterId,match:l}),n().createElement(P,null)),(u||h||E)&&n().createElement(g.Z,{id:"loading-skeleton"},n().createElement(V.Z,null)),s&&(404===(null==Z?void 0:Z.status)?n().createElement(g.Z,null,n().createElement(F.Z,{title:i.formatMessage(c.Z.noRecsFoundError),text:n().createElement(n().Fragment,null,i.formatMessage(c.Z.noRecsFoundErrorDesc),n().createElement("a",{href:"https://docs.openshift.com/container-platform/latest/support/getting-support.html"}," ","OpenShift documentation.")),icon:p.ZP,iconStyle:{color:y.RJ.value},variant:"large"})):n().createElement(g.Z,null,n().createElement(F.Z,{title:i.formatMessage(c.Z.noRecsError),text:i.formatMessage(c.Z.noRecsErrorDesc),icon:d.default,iconStyle:{color:v.Q7.value}}))),b&&n().createElement(n().Fragment,null,n().createElement(g.Z,null,n().createElement(n().Fragment,null,n().createElement(m.Grid,{hasGutter:!0},n().createElement(m.GridItem,{span:12},n().createElement(Q,{reports:(null==k||null===(t=k.report)||void 0===t?void 0:t.data)||[]})))))))};X.propTypes={cluster:u().object.isRequired,displayName:u().object.isRequired,match:u().object.isRequired};const Y=(0,l.Z)((function(e){var t=e.match,r=(0,o.Z)(),l=(0,i.th)(t.params.clusterId),s=(0,E.u)(t.params.clusterId);return(0,a.useEffect)((function(){l.refetch()}),[t.params.clusterId]),(0,a.useEffect)((function(){if(t.params.clusterId){var e="".concat(t.params.clusterId," - ").concat(r.formatMessage(c.Z.clusters));document.title=r.formatMessage(c.Z.documentTitle,{subnav:e})}}),[t.params.clusterId]),n().createElement(X,{cluster:l,displayName:s,match:t})}))}}]);