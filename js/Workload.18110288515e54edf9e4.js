(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[2339],{56276:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var a=n(28416),r=n.n(a),l=n(45697),i=n.n(l),s=n(86896),o=n(62012),c=n(85991),u=n(49489),d=n(30893),m=function(e){var t=e.current,n=e.workloads,a=(0,s.Z)(),l=(0,o.useLocation)().pathname.split("/");return r().createElement("div",null,r().createElement(c.a,{ouiaId:"detail","data-testid":"breadcrumb-item"},r().createElement(u.g,{className:"breadcrumb-item"},r().createElement(o.Link,{to:n?"../..":"..",relative:"path"},"".concat(a.formatMessage(d.Z.insightsHeader)," ").concat(l[4]))),r().createElement(u.g,{className:"breadcrumb-item",isActive:!0},t)))};m.propTypes={current:i().string,workloads:i().boolean};const p=m},52661:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var a=n(28416),r=n.n(a),l=n(2095),i=n(85962),s=n(24561);const o=function(){return r().createElement(l.Card,{ouiaId:"loading-skeleton"},r().createElement(i.CardBody,null,r().createElement(s.aV,null)))}},95808:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>he});var a=n(28416),r=n.n(a),l=n(89376),i=n(36001),s=n(42057),o=n(29572),c=n(34348),u=n(56276),d=n(49287),m=n(18038),p=n(81159),f=n(34023),g=n(35664),E=n(73845),h=n(62410),b=n(45697),v=n.n(b),y=function(e){var t,n,a,l=e.workloadData,i=e.namespaceId,s=e.clusterId,o=l.isUninitialized,u=l.isFetching,b=l.data;return r().createElement(d.r,{id:"workload-header",md:12,hasGutter:!0},r().createElement(m.P,{span:8},r().createElement(c.Dx,{size:"2xl",headingLevel:"h1",id:"workloads-header-title",ouiaId:"workloads-name"},o||u?r().createElement(r().Fragment,null,r().createElement(g.Z,{size:"sm"}),r().createElement(g.Z,{size:"sm"})):r().createElement(r().Fragment,null,r().createElement("p",null,null==b||null===(t=b.cluster)||void 0===t?void 0:t.display_name),r().createElement("p",null,null==b||null===(n=b.namespace)||void 0===n?void 0:n.name)))),r().createElement(m.P,null,r().createElement(p.K,null,r().createElement(f.v,{id:"workload-header-uuid"},r().createElement("span",null,"Cluster UUID:")," ",r().createElement("span",null,s)," ",r().createElement("span",null,"Namespace UUID:")," ",r().createElement("span",null,i)),r().createElement(f.v,{id:"workload-header-last-seen"},r().createElement("span",null,"Last seen: "),r().createElement("span",null,o||u?r().createElement(E.F,null):null!=b&&null!==(a=b.metadata)&&void 0!==a&&a.last_checked_at?r().createElement(h.Z,{date:b.metadata.last_checked_at,type:"exact"}):r().createElement(r().Fragment,null,"Unknown"))))))};y.propTypes={clusterId:v().string.isRequired,namespaceId:v().string.isRequired,workloadData:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,data:v().shape({metadata:v().shape({last_checked_at:v().string}),namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string})})};var k=function(e){var t=e.workload,n=e.namespaceId,a=e.clusterId;return r().createElement(y,{workloadData:t,namespaceId:n,clusterId:a})};k.propTypes={clusterId:v().string.isRequired,namespaceId:v().string.isRequired,workload:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,data:v().shape({metadata:v().shape({last_checked_at:v().string}),namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string})})};const w=k;var O=n(4942),j=n(70885),I=n(34262),P=n(35981),S=n(49004),C=n(58027),_=n(56021),D=n(59303),Z=n(52661),R=n(51014),T=n(90693),x=n(1792),q=n(31369),N=n(61088),F=n(6202),M=n(2095),A=n(85962),B=n(21015),L=n(60738),U=n(95061),z=n(90156),V=n(9898),H=n(84556),W=n(21193),G=n(55471),J=n.n(G),K=n(78826),Q=n(86706),Y=n(28672),$=n(76913),X=n(13877),ee=n(29299);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){(0,O.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){var t,n=e.objects||[],l=(0,Q.useDispatch)(),i=(0,a.useState)(!1),s=(0,j.Z)(i,2),o=s[0],c=s[1],u=(0,a.useState)([]),d=(0,j.Z)(u,2),m=d[0],p=d[1],f=(0,a.useState)([]),g=(0,j.Z)(f,2),E=g[0],h=g[1],b=(0,a.useState)(!1),v=(0,j.Z)(b,2),y=v[0],k=v[1],w=(0,Q.useSelector)((function(e){return e.filters.workloadsObjectsListState})),P=Math.floor(w.offset/w.limit)+1,S=w.limit,C=function(e){return l((0,Y.u2)(e))},T=E.length>0,x=!y,q=[{label:"Object ID",type:"text",filterValues:{key:"object_id",onChange:function(e,t){return C(ne(ne({},w),{},{offset:0,object_id:t}))},value:w.object_id,placeholder:"Filter by Object ID"}}],N={showDeleteButton:o,deleteTitle:"Reset filters",filters:(t=ne({},w),delete t.sortIndex,delete t.sortDirection,(0,ee.lM)(t,{label:"Object ID",type:"text",title:"object ID",urlParam:"object_id"})),onDelete:function(e,t,n){n?(0,Y.aw)(w,Y.kG,C):t.map((function(e){var t,n=(0,O.Z)({},e.urlParam,Array.isArray(w[e.urlParam])?w[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");n[e.urlParam].length>0?C(ne(ne({},w),n)):(t=e.urlParam,(0,$.oo)(w,C,t))}))}};(0,a.useEffect)((function(){p(function(e,t){return e.filter((function(e){return(0,ee.Q$)(e,t)}))}(n,w))}),[n,w]),(0,a.useEffect)((function(){h(m.slice(S*(P-1),S*(P-1)+S)),c((0,ee.wW)(w)),k(!0)}),[m,w.limit,w.offset]);var F=function(e,t){var n=t*w.limit-w.limit;C(ne(ne({},w),{},{offset:n}))},M=function(e,t){t!==w.limit&&C(ne(ne({},w),{},{limit:t,offset:0}))};return r().createElement("div",{id:"objects-list-table"},r().createElement(_.Z,{pagination:{page:P,perPage:S,onSetPage:F,onPerPageSelect:M,isCompact:!0,ouiaId:"pager",itemCount:m.length},filterConfig:{items:q},activeFiltersConfig:N}),x?r().createElement(Z.Z,null):T?r().createElement("div",null,r().createElement(I.Table,{"aria-label":"Cell widths",variant:"compact"},r().createElement(I.Thead,null,r().createElement(I.Tr,null,r().createElement(I.Th,{width:60},D.VM.object),r().createElement(I.Th,{width:30},D.VM.kind))),r().createElement(I.Tbody,null,null==E?void 0:E.map((function(e,t){return r().createElement(I.Tr,{key:t},r().createElement(I.Td,{dataLabel:D.VM.object},e.uid),r().createElement(I.Td,{dataLabel:D.VM.kind},e.kind))})))),E.length>0?r().createElement(X.tl,{ouiaId:"pager",itemCount:m.length,page:P,perPage:S,onSetPage:F,onPerPageSelect:M,onPageInput:F,widgetId:"pagination-options-menu-bottom",variant:X.aM.bottom}):r().createElement(X.tl,{itemCount:0,perPage:!0,page:!0,onSetPage:!0,onPerPageSelect:!0,isDisabled:!0})):r().createElement(R.Ke,null))};ae.propTypes={objects:v().arrayOf(v().shape({kind:v().string,uid:v().string}))};var re=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,a=e.objects,l=(0,Q.useDispatch)(),i=(0,Q.useSelector)((function(e){return e.filters.workloadsObjectsListState})),s=function(e){return l((0,Y.u2)(e))};return r().createElement(K.u_,{isOpen:t,onClose:function(){return n(!1),void(0,Y.aw)(i,Y.kG,s)},variant:"medium",title:"Objects"},r().createElement(ae,{objects:a}))};const le=re;re.propTypes={isModalOpen:v().bool,setIsModalOpen:v().func,objects:v().arrayOf(v().shape({kind:v().string,uid:v().string}))};var ie=function(){var e,t='oc get namespace -o jsonpath=\'{range .items[*]}{.metadata.name}{"\\t"}{.metadata.uid}{"\\n"}{end}\'',n='oc -n <namespace> get <resourceKind> -o jsonpath=\'{range .items[*]}{.metadata.name}{"\\t"}{.metadata.uid}{"\\n"}{end}\'',a=r().useState(!1),l=(0,j.Z)(a,2),i=l[0],s=l[1];return r().createElement(r().Fragment,null,r().createElement(U.d,{actions:(e=t.concat("\n",n),r().createElement(r().Fragment,null,r().createElement(z.A,null,r().createElement(L.u,{id:"basic-copy-button",textId:"code-content","aria-label":"Copy to clipboard",onClick:function(t){return function(e,t){navigator.clipboard.writeText(t.toString())}(0,e),void s(!0)},exitDelay:i?1500:600,maxWidth:"110px",variant:"plain",onTooltipHidden:function(){return s(!1)}},i?"Successfully copied to clipboard!":"Copy to clipboard")))),className:"pf-v5-u-mt-md"},r().createElement(V.B,null,t),r().createElement(V.B,null,n)))},se=function(e){var t=e.more_info,n=e.resolution,l=e.objects,i=e.namespaceName,s=e.reason,o=e.extra_data,c=Array.isArray(l)&&l.length>0,u=t.length>0,d=(0,a.useState)(!1),m=(0,j.Z)(d,2),g=m[0],E=m[1];return r().createElement(M.Card,{className:"ins-c-report-details",style:{boxShadow:"none"}},r().createElement(A.CardBody,null,r().createElement(le,{isModalOpen:g,setIsModalOpen:E,objects:l}),r().createElement(p.K,{className:"ins-c-report-details__cards-stack","widget-type":"InsightsRulesCard",hasGutter:!0},r().createElement(f.v,null,r().createElement(M.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(W.J,null,r().createElement(x.ZP,{className:"ins-c-report-details__icon"})),r().createElement("strong",null,"Detected issues")),r().createElement(A.CardBody,null,r().createElement(J(),{template:s,definitions:o})))),c&&r().createElement(r().Fragment,null,r().createElement(H.iz,null),r().createElement(f.v,null,r().createElement(M.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(W.J,null,r().createElement(N.ZP,{className:"ins-c-report-details__icon"})),r().createElement("strong",null,"Steps to resolve")),r().createElement(A.CardBody,null,r().createElement(J(),{template:n,definitions:o}),r().createElement(I.Table,{borders:"compactBorderless","aria-label":"Objects table"},r().createElement(I.Thead,null,r().createElement(I.Tr,null,r().createElement(I.Th,{modifier:"fitContent"},D.VM.object),r().createElement(I.Th,{modifier:"fitContent"},D.VM.kind))),r().createElement(I.Tbody,null,l.slice(0,3).map((function(e,t){return r().createElement(I.Tr,{key:t},r().createElement(I.Td,{dataLabel:D.VM.object},e.uid),r().createElement(I.Td,{dataLabel:D.VM.kind},e.kind))})))),r().createElement(F.Button,{variant:"link",isInline:!0,onClick:function(){return E(!0)}},"View all objects"))))),!i&&r().createElement(r().Fragment,null,r().createElement(B.CardHeader,null,r().createElement("strong",null,"Note: "),"Red Hat avoids gathering and processing namespace and resource names as these may reveal confidential information. Namespaces and resources are identified by their UIDs instead. You can use in-cluster commands like the ones below to translate UIDs of affected resources to their names."),r().createElement(A.CardBody,null,r().createElement(ie,null))),u&&r().createElement(r().Fragment,null,r().createElement(H.iz,null),r().createElement(f.v,null,r().createElement(M.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(W.J,null,r().createElement(q.default,{className:"ins-c-report-details__icon"})),r().createElement("strong",null,"Additional info")),r().createElement(A.CardBody,null,r().createElement(J(),{template:t,definitions:o}))))))))};const oe=se;se.propTypes={more_info:v().string.isRequired,resolution:v().string.isRequired,objects:v().arrayOf({kind:v().string,uid:v().string}),extra_data:v().shape({check_name:v().string.isRequired,check_url:v().string.isRequired}),namespaceName:v().string.isRequired,reason:v().string.isRequired};var ce=n(62012);function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,O.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=function(e){var t=e.workload,n=e.namespaceName,l=(0,Q.useDispatch)(),i=t.isError,s=t.isUninitialized,o=t.isFetching,c=t.isSuccess,u=t.data,d=t.error,m=(null==u?void 0:u.recommendations)||[],p=i,f=c,g=f&&0===m.length,E=(0,a.useState)(!1),b=(0,j.Z)(E,2),v=b[0],y=b[1],k=(0,a.useState)([]),w=(0,j.Z)(k,2),x=w[0],q=w[1],N=(0,a.useState)(!0),F=(0,j.Z)(N,2),M=F[0],A=F[1],B=(0,a.useState)([]),L=(0,j.Z)(B,2),U=L[0],z=L[1],V=(0,a.useState)(!1),H=(0,j.Z)(V,2),W=H[0],G=H[1],J=(0,a.useState)(!1),K=(0,j.Z)(J,2),X=K[0],te=K[1],ne=(0,a.useState)(!0),ae=(0,j.Z)(ne,2),re=ae[0],le=ae[1],ie=s||o||!W,se=(0,ce.useLocation)().search,ue=(0,Q.useSelector)((function(e){return e.filters.workloadsRecsListState})),me=0===x.length,pe=function(e){return l((0,Y.cH)(e))};(0,a.useEffect)((function(){q(he(m,ue))}),[u,ue]),(0,a.useEffect)((function(){z(Ee(x,ue.sortIndex,ue.sortDirection)),te((0,ee.wW)(ue)),G(!0)}),[x]);var fe=(0,D.PL)(ue,(function(e,t){le(!1),(0,ee.sI)(ue,pe,e,t)}));(0,a.useEffect)((function(){if(se&&M){var e=(0,$.yG)(se);if(e.sort){var t=(0,$.Lg)(e.sort);e.sortIndex=D.Db.indexOf(t.description),e.sortDirection=t.direction}e.total_risk&&!Array.isArray(e.total_risk)&&(e.total_risk=["".concat(e.total_risk)]),pe(de(de({},ue),e))}A(!1)}),[]),(0,a.useEffect)((function(){M||(0,$.aM)(ue,D.Db)}),[ue,M]);var ge,Ee=function(e,t,n){var a=(0,ee.ke)(t,n,e);return(0,ee.l8)(a,re)},he=function(e,t){G(!1);var a=(0,ee.wW)(t),l=new Set(U.filter((function(e){return null==e?void 0:e.isOpen})).map((function(e){var t;return null==e||null===(t=e.rule)||void 0===t?void 0:t.details})));return e.filter((function(e){return!a||(0,ee.y4)(e,t)})).map((function(e,t){return[{rule:e,isOpen:v||(null==l?void 0:l.has(null==e?void 0:e.details)),cells:[{title:e.details},{title:r().createElement("div",{key:t},r().createElement(T.Z,{value:e.total_risk,rest:{isCompact:!0}}))},{title:e.objects.length},{title:r().createElement("div",{key:t},r().createElement(h.Z,{date:e.modified,type:"relative"}))}]},{cells:[{title:r().createElement(oe,{more_info:e.more_info,resolution:e.resolution,objects:e.objects,namespaceName:n,reason:e.reason,extra_data:e.extra_data})}],fullWidth:!0}]}))},be={showDeleteButton:X,deleteTitle:"Reset filters",filters:(ge=de({},ue),delete ge.sortIndex,delete ge.sortDirection,(0,ee.lM)(ge,D.Oq)),onDelete:function(e,t,n){n?(0,Y.aw)(ue,Y.J2,pe):t.map((function(e){var t,n=(0,O.Z)({},e.urlParam,Array.isArray(ue[e.urlParam])?ue[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");n[e.urlParam].length>0?pe(de(de({},ue),n)):(t=e.urlParam,(0,ee.p5)(ue,pe,t))}))}};return r().createElement("div",{id:"workload-recs-list-table"},r().createElement(_.Z,{filterConfig:{items:fe,isDisabled:ie||p||g||0===m.length},pagination:r().createElement("span",{className:"pf-u-font-weight-bold"},1===(null==x?void 0:x.length)?"".concat(x.length," Recommendation"):"".concat(x.length," Recommendations")),activeFiltersConfig:ie||p||g||0===m.length?void 0:be}),r().createElement(P.i,{"aria-label":"Workload recommendations table",ouiaId:"workload-recommendations",cells:D.x2,ouiaSafe:!ie,onCollapse:function(e,t,n){void 0===t?(y(n),z(U.map((function(e){return de(de({},e),Object.hasOwn(e,"parent")?null:{isOpen:n})})))):z(U.map((function(e,a){return a===t?de(de({},e),{},{isOpen:n}):e})))},rows:p||ie||g||me?[{fullWidth:!0,cells:[{props:{colSpan:D.x2.length+1},title:p?404===(null==d?void 0:d.status)?r().createElement(R.So,null):r().createElement(R.fe,null):ie?r().createElement(Z.Z,null):me?r().createElement(R.Be,null):r().createElement(R.So,null)}]}]:f?U:r().createElement(R.Te,null),variant:I.TableVariant.compact,isStickyHeader:!0,canCollapseAll:!0,sortBy:{index:ue.sortIndex,direction:ue.sortDirection},onSort:function(e,t,n){G(!1),le(!1),pe(de(de({},ue),{},{sortIndex:t,sortDirection:n}))}},r().createElement(S.x,null),r().createElement(C.R,null)))};const pe=me;me.propTypes={workload:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,isError:v().bool.isRequired,isSuccess:v().bool.isRequired,error:v().object,data:v().shape({namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string,recommendations:v().arrayOf(v().shape({check:v().string,description:v().string,objects:v().arrayOf(v().shape({kind:v().string,uid:v().string})),remediation:v().string}))})}),namespaceName:v().string.isRequired};var fe=function(e){var t,n,a=e.workload,d=e.namespaceId,m=e.clusterId;return r().createElement(r().Fragment,null,r().createElement(l.Z,{className:"pf-m-light ins-inventory-detail"},r().createElement(i.k,{direction:{default:"column"}},r().createElement(s.B,null,r().createElement(u.Z,{current:"ok"===(null==a||null===(t=a.data)||void 0===t?void 0:t.status)?"".concat(a.data.cluster.display_name," | ").concat(a.data.namespace.name):"".concat(m," | ").concat(d),workloads:"true"}),r().createElement(w,{workload:a,namespaceId:d,clusterId:m})))),r().createElement(o.NP,null,r().createElement(c.Dx,{className:"pf-u-mb-lg",headingLevel:"h3",size:"2xl"},"Recommendations"),r().createElement(pe,{workload:a,namespaceName:null==a||null===(n=a.data)||void 0===n||null===(n=n.namespace)||void 0===n?void 0:n.name})))};fe.propTypes={clusterId:v().string.isRequired,namespaceId:v().string.isRequired,workload:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,data:v().shape({namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string})})};var ge=n(86362),Ee=n(55140);const he=function(){var e=(0,Ee.Z)(),t=(0,ce.useParams)(),n=t.namespaceId,l=t.clusterId,i=(0,ge.k0)({namespaceId:n,clusterId:l});return(0,a.useEffect)((function(){i.refetch()}),[n,l]),(0,a.useEffect)((function(){var t,a,r,s="".concat("ok"===(null==i||null===(t=i.data)||void 0===t?void 0:t.status)?"".concat(null==i||null===(a=i.data)||void 0===a?void 0:a.cluster.display_name," | ").concat(null==i||null===(r=i.data)||void 0===r?void 0:r.namespace.name," - Workloads"):"".concat(l," | ").concat(n," - Workloads"));e.updateDocumentTitle("".concat(s," - OCP Advisor | Red Hat Insights"))}),[i,n,l]),r().createElement(fe,{workload:i,namespaceId:n,clusterId:l})}},73845:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});var a=n(28416),r=n.n(a),l=n(24561),i=function(){return r().createElement(l.ZP,{height:20},r().createElement("rect",{x:"0",y:"0",rx:"4",ry:"4",width:"300",height:"20"}))}},70347:()=>{},71644:()=>{},24620:()=>{},82014:()=>{},25238:()=>{},92084:()=>{},53336:()=>{},314:()=>{},38299:()=>{},72816:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Workload.373c32003dbd89fdcb38f7d1d460bd49.js.map