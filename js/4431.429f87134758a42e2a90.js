(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[4431,8299,4693,8024,9767],{57642:(e,t,r)=>{"use strict";r.d(t,{Lg:()=>h,Lv:()=>f,U1:()=>w,WL:()=>v,_:()=>b,_F:()=>u,aM:()=>g,im:()=>d,mt:()=>m,oo:()=>_,yG:()=>p});var a=r(48403),s=r.n(a),n=r(50361),o=r.n(n),l=(r(28416),r(81249)),i=r(81563),c=r(94608);const u=(e,t)=>Object.entries(t).every((([t,r])=>{switch(t){case"text":return e.description.toLowerCase().includes(r.toLowerCase());case i.W2.total_risk.urlParam:return r.includes(String(e.total_risk));case i.W2.category.urlParam:return e.tags.find((e=>r.includes(String(i.kT[e]))));case i.W2.impact.urlParam:return r.includes(String(e.impact));case i.W2.impacting.urlParam:return!(r.length>0)||r.some((t=>"true"===t?e.impacted_clusters_count>0:"false"===t?0===e.impacted_clusters_count:void 0));case i.W2.likelihood.urlParam:return r.includes(String(e.likelihood));case i.W2.rule_status.urlParam:return"all"===r||"disabled"===r&&e.disabled||"enabled"===r&&!e.disabled;case i.W2.res_risk.urlParam:return r.includes(String(e.resolution_risk));default:return!0}})),d=(e,t)=>Object.entries(t).every((([t,r])=>{switch(t){case"text":return(e.cluster_name||e.cluster_id).toLowerCase().includes(r.toLowerCase());case i.RT.hits.urlParam:return 0===r.length&&parseInt(e.total_hit_count)>0||r.includes("all")||r.some((t=>e.hits_by_total_risk[t]>0));case"version":return 0===r.length||r.includes(v(e.cluster_version));default:return!0}})),m=(e,t)=>{const r=o()(e);return delete r.sortIndex,delete r.sortDirection,delete r.sort,delete r.offset,delete r.limit,r?.hits&&0===r.hits.length&&delete r.hits,((e,t)=>Object.entries(e||{}).reduce(((e,r)=>{const[a,n]=r;if(t[a]){const r=t[a],o=Array.isArray(n)?n.map((e=>{const t=r.values.find((t=>t.value===String(e)));return t?{name:t.text||t.label,value:e}:{name:e,value:e}})):[{name:r.values.find((e=>e.value===String(n))).label,value:n}];return[...e,{category:s()(r.title),chips:o,urlParam:r.urlParam}]}return"text"===a?[...e,...n.length>0?[{category:"Name",chips:[{name:n,value:n}],urlParam:a}]:[]]:"version"===a?[...e,...n.length>0?[{category:"Version",chips:n.map((e=>({name:e,value:e}))),urlParam:a}]:[]]:"namespace_name"===a?[...e,...n.length>0?[{category:"Namespace name",chips:[{name:n,value:n}],urlParam:a}]:[]]:"cluster_name"===a?[...e,...n.length>0?[{category:"Cluster name",chips:[{name:n,value:n}],urlParam:a}]:[]]:void 0}),[]))(r,t)},p=e=>{const t=new URLSearchParams(e);return Array.from(t).reduce(((e,[t,r])=>({...e,[t]:["text","first","rule_status","sort","cluster_name","namespace_name","description","object_id","object_name"].includes(t)?r:"true"===r||"false"===r?JSON.parse(r):r.split(",")})),{})},h=e=>({name:e.substring(e.startsWith("-")?1:0),direction:e.startsWith("-")?"desc":"asc",description:e.substring(e.startsWith("-")?1:0),object_id:e.substring(e.startsWith("-")?1:0)}),g=(e={},t)=>{const r=new URL(window.location.origin+window.location.pathname);var a,s,n;r.searchParams.set("sort",(a=e.sortIndex,s=t,n=e.sortDirection,["desc","asc"].includes(n)||console.error("Invalid sort parameters (is not asc nor desc)"),`${"asc"===n?"":"-"}${s[a]}`)),Object.entries(e).forEach((([e,t])=>"sortIndex"!==e&&"sortDirection"!==e&&"sort"!==e&&""!==t&&!(Array.isArray(t)&&0===t.length)&&r.searchParams.set(e,t))),window.history.replaceState(null,null,r.href)},b=(e,t,r)=>r*(0,l.compare)(e,t),v=e=>(0,l.coerce)(void 0!==e&&(0,l.valid)((0,l.coerce)(e))?e:"0.0.0").version,_=(e,t,r)=>{const{[r]:a,...s}={...e,offset:0};t({...s,..."text"===r?{text:""}:"hits"===r?{hits:[]}:"version"===r?{version:[]}:"object_id"===r?{object_id:""}:{}})},f=(e,t,r,a)=>a.length>0?t({...e,offset:0,[r]:a}):_(e,t,r),w=(e,t)=>{const r=(0,c.Vs)(e.metadata.hits_by_severity,"general");return Object.entries(t).every((([a,s])=>{switch(a){case"cluster_name":return(e.cluster.display_name||e.cluster.uuid).toLowerCase().includes(s.toLowerCase());case"namespace_name":return(e.namespace.name||e.namespace.uuid).toLowerCase().includes(s.toLowerCase());case"severity":return 0===s.length||(0,c.mR)(r,t.severity);default:return!0}}))}},94608:(e,t,r)=>{"use strict";r.d(t,{Q$:()=>w,Vs:()=>d,ke:()=>_,l8:()=>f,lM:()=>b,mR:()=>m,og:()=>u,p5:()=>y,sI:()=>C,wW:()=>p,y4:()=>j});var a=r(48585),s=r(14176),n=r.n(s),o=r(50361),l=r.n(o),i=r(41609),c=r.n(i);const u=[{value:"critical",label:"Critical",iconColor:"var(--pf-global--danger-color--100)",textColor:"var(--pf-global--danger-color--100)",hasIcon:!0,indexNumber:4},{value:"important",label:"Important",iconColor:"var(--pf-global--palette--orange-300)",textColor:"var(--pf-global--palette--orange-400)",hasIcon:!0,indexNumber:3},{value:"moderate",label:"Moderate",iconColor:"var(--pf-global--warning-color--100)",textColor:"var(--pf-global--warning-color--200)",hasIcon:!0,indexNumber:2},{value:"low",label:"Low",iconColor:"var(--pf-global--Color--200)",textColor:"var(--pf-global--default-color--300)",hasIcon:!0,indexNumber:1}],d=(e,t)=>{const r={1:"low",2:"moderate",3:"important",4:"critical"};let a={};if("general"===t||"label"===t)for(const t in e)t in r&&(a[r[t]]=e[t]);else a=r[e];return a},m=(e,t)=>{for(const r of t)if(e[r]>0)return!0},p=e=>{const t=l()(e);return delete t.sortIndex,delete t.sortDirection,delete t.offset,delete t.limit,delete t.sort,!!Object.values(t).filter((e=>!c()(e))).length},h=e=>e?.charAt(0).toUpperCase()+e?.slice(1),g=(e,t)=>{if(e.values){const r=e.values.find((e=>e.value===String(t)));return r?{name:r.label||r.text,value:t}:{name:t,value:t}}return{name:t,value:t}},b=(e,t)=>Object.entries(e).reduce(((e,[r,a])=>{if(t[r]){const s=t[r];if(Array.isArray(a)&&a.length>0||"string"==typeof a&&""!==a.trim()){const t=Array.isArray(a)?a.map((e=>g(s,e))):[g(s,a)];e.push({category:h(s.label),chips:t,urlParam:s.urlParam})}}else"display_name"===r&&""!==a.trim()?e.push({category:h(r.replace("display_name","Name")),chips:[{name:a,value:a}],urlParam:"display_name"}):"description"!==r&&"object_id"!==r||""===a.trim()||e.push({category:h(r.replace("_"," ")),chips:[{name:a,value:a}],urlParam:r});return e}),[]),v=(e,t)=>{const r=t[0].rule;switch(e){case 1:return r.details;case 2:return r.total_risk;case 3:return r.objects.length;case 4:return r.modified}},_=(e,t,r)=>e>=1?[...r]?.sort(((r,s)=>{const n=t===a.B.asc?1:-1;return v(e,r)>v(e,s)?n:v(e,s)>v(e,r)?-n:0})):[...r],f=(e,t)=>e.flatMap(((e,r)=>{const a=[...e];return t&&0===r&&(e[0].isOpen=!0),e[1].parent=2*r,a})),w=(e,t)=>{const r=n()(l()(t),c());return Object.entries(r).every((([t,r])=>{switch(t){case"display_name":return r&&e?.display_name?.toLowerCase().includes(r.toLowerCase());case"object_id":return r&&e?.uid?.toLowerCase().includes(r.toLowerCase());default:return!0}}))},y=(e,t,r)=>{const{[r]:a,...s}={...e};t({...s,..."description"===r?{description:""}:"total_risk"===r?{total_risk:[]}:"object_id"===r?{object_id:""}:"object_name"===r?{object_name:""}:{}})},C=(e,t,r,a)=>a.length>0?t({...e,[r]:a}):y(e,t,r),j=(e,t)=>{const r=n()(l()(t),c());return Object.entries(r).every((([t,r])=>{switch(t){case"description":return r&&e.details.toLowerCase().includes(r.toLowerCase());case"object_id":return r&&e.objects.some((e=>e.uid.toLowerCase().includes(r.toLowerCase())));case"total_risk":return r&&r.includes(String(e.total_risk));case"object_name":return r&&e.objects.some((e=>e.display_name.toLowerCase().includes(r.toLowerCase())));default:return!0}}))}},65088:()=>{},36150:()=>{},63498:()=>{},36213:()=>{},81235:()=>{},81754:()=>{},16506:()=>{},43109:()=>{},70347:()=>{},12796:()=>{},95594:()=>{},15622:()=>{},58392:()=>{},10497:()=>{},80598:()=>{},32857:()=>{},1580:()=>{},94498:()=>{},37625:()=>{},71644:()=>{},23055:()=>{},54476:()=>{},27567:()=>{},28992:()=>{},90146:()=>{},80897:()=>{},30187:()=>{},40837:()=>{},50311:()=>{},90479:()=>{},78752:()=>{},71338:()=>{},11080:()=>{},44839:()=>{},21626:()=>{},74282:()=>{},67274:()=>{},24620:()=>{},82014:()=>{},90776:()=>{},88277:()=>{},97939:()=>{},8572:()=>{},98379:()=>{},25238:()=>{},61612:()=>{},33858:()=>{},66213:()=>{},77350:()=>{},69076:()=>{},70150:()=>{},92084:()=>{},46928:()=>{},1508:()=>{},91993:()=>{},84958:()=>{},37739:()=>{},99624:()=>{},43919:()=>{},91027:()=>{},53336:()=>{},16061:()=>{},27479:()=>{},93661:()=>{},56024:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},43390:()=>{},22143:()=>{},48223:()=>{},7064:()=>{},97853:()=>{},97236:()=>{},38024:()=>{},11489:()=>{},40209:()=>{},87234:()=>{},38299:()=>{},51934:()=>{},72816:()=>{},74181:()=>{},16166:()=>{}}]);
//# sourceMappingURL=../sourcemaps/4431.0d425dbd01cc5bbd96d62ee9955380bf.js.map