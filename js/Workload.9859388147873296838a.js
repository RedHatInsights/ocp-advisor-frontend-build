(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[2339],{56276:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var n=a(92950),r=a.n(n),l=a(45697),s=a.n(l),i=a(86896),c=a(62012),o=a(85991),d=a(49489),u=a(30893),m=function(e){var t=e.current,a=(0,i.Z)(),n=(0,c.useLocation)().pathname.split("/");return r().createElement("div",null,r().createElement(o.a,{ouiaId:"detail"},r().createElement(d.g,{className:"breadcrumb-item"},r().createElement(c.Link,{to:"..",relative:"path"},"".concat(a.formatMessage(u.Z.insightsHeader)," ").concat(n[4]))),r().createElement(d.g,{className:"breadcrumb-item",isActive:!0},t)))};m.propTypes={current:s().string};const p=m},52661:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var n=a(92950),r=a.n(n),l=a(2095),s=a(85962),i=a(24561);const c=function(){return r().createElement(l.Card,{ouiaId:"loading-skeleton"},r().createElement(s.CardBody,null,r().createElement(i.aV,null)))}},49872:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ne});var n=a(92950),r=a.n(n),l=a(89376),s=a(36001),i=a(42057),c=a(29572),o=a(34348),d=a(56276),u=a(49287),m=a(18038),p=a(81159),E=a(34023),f=a(35664),g=a(73845),h=a(62410),v=a(45697),b=a.n(v),y=function(e){var t,a=e.workloadData,n=e.namespaceId,l=e.clusterId,s=a.isUninitialized,i=a.isFetching,c=a.data;return r().createElement(u.r,{id:"workload-header",md:12,hasGutter:!0},r().createElement(m.P,{span:8},r().createElement(o.Dx,{size:"2xl",headingLevel:"h1",id:"cluster-header-title",ouiaId:"cluster-name"},s||i?r().createElement(r().Fragment,null,r().createElement(f.Z,{size:"sm"}),r().createElement(f.Z,{size:"sm"})):r().createElement(r().Fragment,null,r().createElement("p",null,c.cluster.display_name),r().createElement("p",null,c.namespace.name)))),r().createElement(m.P,null,r().createElement(p.K,null,r().createElement(E.v,{id:"workload-header-uuid"},r().createElement("span",null,"Cluster UUID:")," ",r().createElement("span",null,l)," ",r().createElement("span",null,"Namespace UUID:")," ",r().createElement("span",null,n)),r().createElement(E.v,{id:"workload-header-last-seen"},r().createElement("span",null,"Last seen: "),r().createElement("span",null,s||i?r().createElement(g.F,null):null!=c&&null!==(t=c.metadata)&&void 0!==t&&t.last_checked_at?r().createElement(h.Z,{date:c.metadata.last_checked_at,type:"exact"}):r().createElement(r().Fragment,null,"Unknown"))))))};y.propTypes={clusterId:b().string.isRequired,namespaceId:b().string.isRequired,workloadData:b().shape({isUninitialized:b().bool.isRequired,isFetching:b().bool.isRequired,data:b().shape({namespace:b().shape({uuid:b().string,name:b().string}),cluster:b().shape({uuid:b().string,display_name:b().string}),status:b().string})})};var k=a(62012),I=a(86362);const w=function(){var e=(0,k.useParams)(),t=e.namespaceId,a=e.clusterId,n=(0,I.k0)({namespaceId:t,clusterId:a});return r().createElement(y,{workloadData:n,namespaceId:t,clusterId:a})};var C=a(4942),D=a(70885),O=a(15509),_=a(56021),P=a(59303),Z=a(52661),j=a(51014),R=a(90693),S=a(1792),T=a(31369),x=a(61088),q=a(6202),N=a(2095),F=a(85962),B=a(21015),U=a(95061),L=a(84556),A=a(55471),H=a.n(A),z="Object ID",W="Kind",K=function(e){var t=e.more_info,a=e.resolution,n=e.objects;return r().createElement(N.Card,{className:"ins-c-report-details",style:{boxShadow:"none"}},r().createElement(F.CardBody,null,r().createElement(p.K,{className:"ins-c-report-details__cards-stack","widget-type":"InsightsRulesCard",hasGutter:!0},r().createElement(E.v,null,r().createElement(N.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(S.ZP,{className:"ins-c-report-details__icon"}),r().createElement("strong",null,"Detected issues")),r().createElement(F.CardBody,null,"This should be a reason field and extradata should provide us an array of reasons to list here"))),r().createElement(L.Divider,null),r().createElement(E.v,null,r().createElement(N.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(x.ZP,{className:"ins-c-report-details__icon"}),r().createElement("strong",null,"Steps to resolve")),r().createElement(F.CardBody,null,r().createElement(H(),{template:a})))),r().createElement(O.Table,{borders:"compactBorderless"},r().createElement(O.Thead,null,r().createElement(O.Tr,null,r().createElement(O.Th,{modifier:"fitContent"},z),r().createElement(O.Th,{modifier:"fitContent"},W))),r().createElement(O.Tbody,null,n.slice(0,3).map((function(e,t){return r().createElement(O.Tr,{key:t},r().createElement(O.Td,{dataLabel:z},e.uid),r().createElement(O.Td,{dataLabel:W},e.kind))})))),r().createElement(q.Button,{variant:"link",isInline:!0},"View all objects"),r().createElement("br",null),r().createElement(B.CardHeader,null,r().createElement("strong",null,"Note:")),r().createElement(F.CardBody,null,"Red Hat avoids gathering and processing namespace and resource names as these may reveal confidential information. Namespaces and resources are identified by their UIDs instead. You can use in-cluster commands like the ones below to translate UIDs of affected resources to their names.",r().createElement(U.d,null,'oc get namespace -o jsonpath={range .items[*]}{.metadata.name}{"\t"}{.metadata.uid}{"\n"}{end}\n  oc -n <namespace> get <resourceKind> -o jsonpath={range .items[*]}{.metadata.name}{"\t"}{.metadata.uid}{"\n"}{end}')),r().createElement(r().Fragment,null,r().createElement(L.Divider,null),r().createElement(E.v,null,r().createElement(N.Card,{isCompact:!0,isPlain:!0},r().createElement(B.CardHeader,null,r().createElement(T.default,{className:"ins-c-report-details__icon"}),r().createElement("strong",null,"Additional info")),r().createElement(F.CardBody,null,t)))))))};const G=K;K.propTypes={extra_data:b().string.isRequired,more_info:b().string.isRequired,resolution:b().string.isRequired,objects:b().arrayOf({kind:b().string,uid:b().string})};var M=a(86706),V=a(28672),J=a(76913),Y=a(29299);function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){(0,C.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $=function(e){var t=e.workload,a=(0,M.useDispatch)(),l=t.isError,s=t.isUninitialized,i=t.isFetching,c=t.isSuccess,o=t.data,d=(null==o?void 0:o.recommendations)||[],u=l,m=c,p=m&&0===d.length,E=(0,n.useState)(!1),f=(0,D.Z)(E,2),g=f[0],v=f[1],b=(0,n.useState)([]),y=(0,D.Z)(b,2),I=y[0],w=y[1],S=(0,n.useState)(!0),T=(0,D.Z)(S,2),x=T[0],q=T[1],N=(0,n.useState)([]),F=(0,D.Z)(N,2),B=F[0],U=F[1],L=(0,n.useState)(!1),A=(0,D.Z)(L,2),H=A[0],z=A[1],W=(0,n.useState)(!1),K=(0,D.Z)(W,2),Q=K[0],$=K[1],ee=(0,n.useState)(!0),te=(0,D.Z)(ee,2),ae=te[0],ne=te[1],re=s||i||!H,le=(0,k.useLocation)().search,se=(0,M.useSelector)((function(e){return e.filters.workloadsRecsListState})),ie=function(e){return a((0,V.cH)(e))};(0,n.useEffect)((function(){w(ue(d,se))}),[o,se]),(0,n.useEffect)((function(){U(de(I,se.sortIndex,se.sortDirection)),$((0,Y.wW)(se)),z(!0)}),[I]);var ce=(0,P.PL)(se,(function(e,t){ne(!1),(0,Y.sI)(se,ie,e,t)}));(0,n.useEffect)((function(){if(le&&x){var e=(0,J.yG)(le);if(e.sort){var t=(0,J.Lg)(e.sort);e.sortIndex=P.Db.indexOf(t.description),e.sortDirection=t.direction}e.total_risk&&!Array.isArray(e.total_risk)&&(e.total_risk=["".concat(e.total_risk)]),ie(X(X({},se),e))}q(!1)}),[]),(0,n.useEffect)((function(){x||(0,J.aM)(se,P.Db)}),[se,x]);var oe,de=function(e,t,a){var n=(0,Y.ke)(t,a,e);return(0,Y.l8)(n,ae)},ue=function(e,t){z(!1);var a=(0,Y.wW)(t);return e.filter((function(e){return!a||(0,J.y4)(e,t)})).map((function(e,t){return[{rule:e,isOpen:g,cells:[{title:e.details},{title:r().createElement("div",{key:t},r().createElement(R.Z,{value:4,rest:{isCompact:!0}}))},{title:e.objects.length},{title:r().createElement("div",{key:t},r().createElement(h.Z,{date:e.modified,type:"relative"}))}]},{cells:[{title:r().createElement(G,{extra_data:e.extra_data,more_info:e.more_info,resolution:e.resolution,objects:e.objects})}]}]}))},me={showDeleteButton:Q,deleteTitle:"Reset filters",filters:(oe=X({},se),delete oe.sortIndex,delete oe.sortDirection,(0,Y.lM)(oe,P.Oq)),onDelete:function(e,t,a){a?(0,V.aw)(se,V.J2,ie):t.map((function(e){var t,a=(0,C.Z)({},e.urlParam,Array.isArray(se[e.urlParam])?se[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");a[e.urlParam].length>0?ie(X(X({},se),a)):(t=e.urlParam,(0,Y.p5)(se,ie,t))}))}};return r().createElement("div",{id:"workload-recs-list-table"},r().createElement(_.Z,{filterConfig:{items:ce,isDisabled:re||u||p||0===d.length},pagination:r().createElement("span",{className:"pf-u-font-weight-bold"},1===(null==I?void 0:I.length)?"".concat(I.length," Recommendation"):"".concat(I.length," Recommendations")),activeFiltersConfig:re||u||p||0===d.length?void 0:me}),r().createElement(O.Table,{"aria-label":"Workload recommendations table",ouiaId:"workload-recommendations",cells:P.x2,ouiaSafe:!re,onCollapse:function(e,t,a){void 0===t?(v(a),U(B.map((function(e){return X(X({},e),Object.hasOwn(e,"parent")?null:{isOpen:a})})))):U(B.map((function(e,n){return n===t?X(X({},e),{},{isOpen:a}):e})))},rows:u||re||p?[{fullWidth:!0,cells:[{props:{colSpan:P.x2.length+1},title:u?r().createElement(j.fe,null):re?r().createElement(Z.Z,null):r().createElement(j.So,null)}]}]:m?B:r().createElement(j.Te,null),variant:O.TableVariant.compact,isStickyHeader:!0,canCollapseAll:!0,sortBy:{index:se.sortIndex,direction:se.sortDirection},onSort:function(e,t,a){z(!1),ne(!1),ie(X(X({},se),{},{sortIndex:t,sortDirection:a}))}},r().createElement(O.TableHeader,null),r().createElement(O.TableBody,null)))};const ee=$;$.propTypes={workload:b().shape({isUninitialized:b().bool.isRequired,isFetching:b().bool.isRequired,isError:b().bool.isRequired,isSuccess:b().bool.isRequired,error:b().object,data:b().shape({namespace:b().shape({uuid:b().string,name:b().string}),cluster:b().shape({uuid:b().string,display_name:b().string}),status:b().string,recommendations:b().arrayOf(b().shape({check:b().string,description:b().string,objects:b().arrayOf(b().shape({kind:b().string,uid:b().string})),remediation:b().string}))})})};var te=function(e){var t,a=e.workload,n=e.namespaceId,u=e.clusterId;return r().createElement(r().Fragment,null,r().createElement(l.Z,{className:"pf-m-light ins-inventory-detail"},r().createElement(s.k,{direction:{default:"column"}},r().createElement(i.B,null,r().createElement(d.Z,{current:"ok"===(null==a||null===(t=a.data)||void 0===t?void 0:t.status)?"".concat(a.data.cluster.display_name," | ").concat(a.data.namespace.name):"".concat(u," | ").concat(n)}),r().createElement(w,null)))),r().createElement(c.NP,null,r().createElement(o.Dx,{className:"pf-u-mb-lg",headingLevel:"h3",size:"2xl"},"Recommendations"),r().createElement(ee,{workload:a})))};te.propTypes={clusterId:b().string.isRequired,namespaceId:b().string.isRequired,workload:b().shape({isUninitialized:b().bool.isRequired,isFetching:b().bool.isRequired,data:b().shape({namespace:b().shape({uuid:b().string,name:b().string}),cluster:b().shape({uuid:b().string,display_name:b().string}),status:b().string})})};var ae=a(55140);const ne=function(){var e=(0,ae.Z)(),t=(0,k.useParams)(),a=t.namespaceId,l=t.clusterId,s=(0,I.k0)({namespaceId:a,clusterId:l});return(0,n.useEffect)((function(){s.refetch()}),[a,l]),(0,n.useEffect)((function(){var t,n,r,i="".concat("ok"===(null==s||null===(t=s.data)||void 0===t?void 0:t.status)?"".concat(null==s||null===(n=s.data)||void 0===n?void 0:n.cluster.display_name," | ").concat(null==s||null===(r=s.data)||void 0===r?void 0:r.namespace.name," - Workloads"):"".concat(l," | ").concat(a," - Workloads"));e.updateDocumentTitle("".concat(i," - OCP Advisor | Red Hat Insights"))}),[s,a,l]),r().createElement(te,{workload:s,namespaceId:a,clusterId:l})}},73845:(e,t,a)=>{"use strict";a.d(t,{F:()=>s});var n=a(92950),r=a.n(n),l=a(24561),s=function(){return r().createElement(l.ZP,{height:20},r().createElement("rect",{x:"0",y:"0",rx:"4",ry:"4",width:"300",height:"20"}))}},58392:()=>{},80598:()=>{},71644:()=>{},28992:()=>{},92084:()=>{},38299:()=>{},72816:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Workload.50835187e72b345b94f4b91667f319c4.js.map