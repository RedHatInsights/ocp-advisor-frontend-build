(self.webpackChunkocpAdvisor=self.webpackChunkocpAdvisor||[]).push([[2339],{56276:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var a=n(28416),r=n.n(a),l=n(45697),i=n.n(l),s=n(86896),c=n(62012),o=n(85991),u=n(49489),d=n(30893),m=function(e){var t=e.current,n=e.workloads,a=(0,s.Z)(),l=(0,c.useLocation)().pathname.split("/");return r().createElement("div",null,r().createElement(o.a,{ouiaId:"detail","data-testid":"breadcrumb-item"},r().createElement(u.g,{className:"breadcrumb-item"},r().createElement(c.Link,{to:n?"../..":"..",relative:"path"},"".concat(a.formatMessage(d.Z.insightsHeader)," ").concat(l[4]))),r().createElement(u.g,{className:"breadcrumb-item",isActive:!0},t)))};m.propTypes={current:i().string,workloads:i().boolean};const p=m},52661:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a=n(28416),r=n.n(a),l=n(2095),i=n(85962),s=n(24561);const c=function(){return r().createElement(l.Card,{ouiaId:"loading-skeleton"},r().createElement(i.CardBody,null,r().createElement(s.aV,null)))}},95808:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ge});var a=n(28416),r=n.n(a),l=n(89376),i=n(36001),s=n(42057),c=n(29572),o=n(34348),u=n(56276),d=n(49287),m=n(18038),p=n(81159),f=n(34023),E=n(35664),g=n(73845),b=n(62410),h=n(45697),v=n.n(h),y=function(e){var t,n,a,l=e.workloadData,i=e.namespaceId,s=e.clusterId,c=l.isUninitialized,u=l.isFetching,h=l.data;return r().createElement(d.r,{id:"workload-header",md:12,hasGutter:!0},r().createElement(m.P,{span:8},r().createElement(o.Dx,{size:"2xl",headingLevel:"h1",id:"workloads-header-title",ouiaId:"workloads-name"},c||u?r().createElement(r().Fragment,null,r().createElement(E.Z,{size:"sm"}),r().createElement(E.Z,{size:"sm"})):r().createElement(r().Fragment,null,r().createElement("p",null,null==h||null===(t=h.cluster)||void 0===t?void 0:t.display_name),r().createElement("p",null,null==h||null===(n=h.namespace)||void 0===n?void 0:n.name)))),r().createElement(m.P,null,r().createElement(p.K,null,r().createElement(f.v,{id:"workload-header-uuid"},r().createElement("span",null,"Cluster UUID:")," ",r().createElement("span",null,s)," ",r().createElement("span",null,"Namespace UUID:")," ",r().createElement("span",null,i)),r().createElement(f.v,{id:"workload-header-last-seen"},r().createElement("span",null,"Last seen: "),r().createElement("span",null,c||u?r().createElement(g.F,null):null!=h&&null!==(a=h.metadata)&&void 0!==a&&a.last_checked_at?r().createElement(b.Z,{date:h.metadata.last_checked_at,type:"exact"}):r().createElement(r().Fragment,null,"Unknown"))))))};y.propTypes={clusterId:v().string.isRequired,namespaceId:v().string.isRequired,workloadData:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,data:v().shape({metadata:v().shape({last_checked_at:v().string}),namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string})})};var k=n(62012),O=n(86362);const w=function(){var e=(0,k.useParams)(),t=e.namespaceId,n=e.clusterId,a=(0,O.k0)({namespaceId:t,clusterId:n});return r().createElement(y,{workloadData:a,namespaceId:t,clusterId:n})};var j=n(4942),P=n(70885),I=n(64420),C=n(35981),S=n(49004),D=n(58027),_=n(56021),Z=n(59303),T=n(52661),x=n(51014),R=n(90693),N=n(1792),q=n(31369),M=n(61088),F=n(6202),A=n(2095),B=n(85962),L=n(21015),U=n(60738),V=n(95061),z=n(90156),H=n(9898),W=n(84556),G=n(21193),J=n(55471),K=n.n(J),Q=n(78826),Y=n(86706),$=n(28672),X=n(76913),ee=n(13877),te=n(29299);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,j.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=function(e){var t,n=e.objects||[],l=(0,Y.useDispatch)(),i=(0,a.useState)(!1),s=(0,P.Z)(i,2),c=s[0],o=s[1],u=(0,a.useState)([]),d=(0,P.Z)(u,2),m=d[0],p=d[1],f=(0,a.useState)([]),E=(0,P.Z)(f,2),g=E[0],b=E[1],h=(0,a.useState)(!1),v=(0,P.Z)(h,2),y=v[0],k=v[1],O=(0,Y.useSelector)((function(e){return e.filters.workloadsObjectsListState})),w=Math.floor(O.offset/O.limit)+1,C=O.limit,S=function(e){return l((0,$.u2)(e))},D=g.length>0,R=!y,N=[{label:"Object ID",type:"text",filterValues:{key:"object_id",onChange:function(e,t){return S(ae(ae({},O),{},{offset:0,object_id:t}))},value:O.object_id,placeholder:"Filter by Object ID"}}],q={showDeleteButton:c,deleteTitle:"Reset filters",filters:(t=ae({},O),delete t.sortIndex,delete t.sortDirection,(0,te.lM)(t,{label:"Object ID",type:"text",title:"object ID",urlParam:"object_id"})),onDelete:function(e,t,n){n?(0,$.aw)(O,$.kG,S):t.map((function(e){var t,n=(0,j.Z)({},e.urlParam,Array.isArray(O[e.urlParam])?O[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");n[e.urlParam].length>0?S(ae(ae({},O),n)):(t=e.urlParam,(0,X.oo)(O,S,t))}))}};(0,a.useEffect)((function(){p(function(e,t){return e.filter((function(e){return(0,te.Q$)(e,t)}))}(n,O))}),[n,O]),(0,a.useEffect)((function(){b(m.slice(C*(w-1),C*(w-1)+C)),o((0,te.wW)(O)),k(!0)}),[m,O.limit,O.offset]);var M=function(e,t){var n=t*O.limit-O.limit;S(ae(ae({},O),{},{offset:n}))},F=function(e,t){t!==O.limit&&S(ae(ae({},O),{},{limit:t,offset:0}))};return r().createElement("div",{id:"objects-list-table"},r().createElement(_.Z,{pagination:{page:w,perPage:C,onSetPage:M,onPerPageSelect:F,isCompact:!0,ouiaId:"pager",itemCount:m.length},filterConfig:{items:N},activeFiltersConfig:q}),R?r().createElement(T.Z,null):D?r().createElement("div",null,r().createElement(I.Table,{"aria-label":"Cell widths",variant:"compact"},r().createElement(I.Thead,null,r().createElement(I.Tr,null,r().createElement(I.Th,{width:60},Z.VM.object),r().createElement(I.Th,{width:30},Z.VM.kind))),r().createElement(I.Tbody,null,null==g?void 0:g.map((function(e,t){return r().createElement(I.Tr,{key:t},r().createElement(I.Td,{dataLabel:Z.VM.object},e.uid),r().createElement(I.Td,{dataLabel:Z.VM.kind},e.kind))})))),g.length>0?r().createElement(ee.tl,{ouiaId:"pager",itemCount:m.length,page:w,perPage:C,onSetPage:M,onPerPageSelect:F,onPageInput:M,widgetId:"pagination-options-menu-bottom",variant:ee.aM.bottom}):r().createElement(ee.tl,{itemCount:0,perPage:!0,page:!0,onSetPage:!0,onPerPageSelect:!0,isDisabled:!0})):r().createElement(x.Ke,null))};re.propTypes={objects:v().arrayOf(v().shape({kind:v().string,uid:v().string}))};var le=function(e){var t=e.isModalOpen,n=e.setIsModalOpen,a=e.objects;return r().createElement(Q.u_,{isOpen:t,onClose:function(){return n(!1)},variant:"medium",title:"Objects"},r().createElement(re,{objects:a}))};const ie=le;le.propTypes={isModalOpen:v().bool,setIsModalOpen:v().func,objects:v().arrayOf(v().shape({kind:v().string,uid:v().string}))};var se=function(){var e,t='oc get namespace -o jsonpath=\'{range .items[*]}{.metadata.name}{"\\t"}{.metadata.uid}{"\\n"}{end}\'',n='oc -n <namespace> get <resourceKind> -o jsonpath=\'{range .items[*]}{.metadata.name}{"\\t"}{.metadata.uid}{"\\n"}{end}\'',a=r().useState(!1),l=(0,P.Z)(a,2),i=l[0],s=l[1];return r().createElement(r().Fragment,null,r().createElement(V.d,{actions:(e=t.concat("\n",n),r().createElement(r().Fragment,null,r().createElement(z.A,null,r().createElement(U.u,{id:"basic-copy-button",textId:"code-content","aria-label":"Copy to clipboard",onClick:function(t){return function(e,t){navigator.clipboard.writeText(t.toString())}(0,e),void s(!0)},exitDelay:i?1500:600,maxWidth:"110px",variant:"plain",onTooltipHidden:function(){return s(!1)}},i?"Successfully copied to clipboard!":"Copy to clipboard")))),className:"pf-v5-u-mt-md"},r().createElement(H.B,null,t),r().createElement(H.B,null,n)))},ce=function(e){var t=e.more_info,n=e.resolution,l=e.objects,i=e.namespaceName,s=e.reason,c=e.extra_data,o=Array.isArray(l)&&l.length>0,u=t.length>0,d=(0,a.useState)(!1),m=(0,P.Z)(d,2),E=m[0],g=m[1];return r().createElement(A.Card,{className:"ins-c-report-details",style:{boxShadow:"none"}},r().createElement(B.CardBody,null,r().createElement(ie,{isModalOpen:E,setIsModalOpen:g,objects:l}),r().createElement(p.K,{className:"ins-c-report-details__cards-stack","widget-type":"InsightsRulesCard",hasGutter:!0},r().createElement(f.v,null,r().createElement(A.Card,{isCompact:!0,isPlain:!0},r().createElement(L.CardHeader,null,r().createElement(G.J,null,r().createElement(N.ZP,{className:"ins-c-report-details__icon"})),r().createElement("strong",null,"Detected issues")),r().createElement(B.CardBody,null,r().createElement(K(),{template:s,definitions:c})))),o&&r().createElement(r().Fragment,null,r().createElement(W.iz,null),r().createElement(f.v,null,r().createElement(A.Card,{isCompact:!0,isPlain:!0},r().createElement(L.CardHeader,null,r().createElement(G.J,null,r().createElement(M.ZP,{className:"ins-c-report-details__icon"})),r().createElement("strong",null,"Steps to resolve")),r().createElement(B.CardBody,null,r().createElement(K(),{template:n,definitions:c}),r().createElement(I.Table,{borders:"compactBorderless","aria-label":"Objects table"},r().createElement(I.Thead,null,r().createElement(I.Tr,null,r().createElement(I.Th,{modifier:"fitContent"},Z.VM.object),r().createElement(I.Th,{modifier:"fitContent"},Z.VM.kind))),r().createElement(I.Tbody,null,l.slice(0,3).map((function(e,t){return r().createElement(I.Tr,{key:t},r().createElement(I.Td,{dataLabel:Z.VM.object},e.uid),r().createElement(I.Td,{dataLabel:Z.VM.kind},e.kind))})))),r().createElement(F.Button,{variant:"link",isInline:!0,onClick:function(){return g(!0)}},"View all objects"))))),!i&&r().createElement(r().Fragment,null,r().createElement(L.CardHeader,null,r().createElement("strong",null,"Note:")),r().createElement(B.CardBody,null,"Red Hat avoids gathering and processing namespace and resource names as these may reveal confidential information. Namespaces and resources are identified by their UIDs instead. You can use in-cluster commands like the ones below to translate UIDs of affected resources to their names.",r().createElement(se,null))),u&&r().createElement(r().Fragment,null,r().createElement(W.iz,null),r().createElement(f.v,null,r().createElement(A.Card,{isCompact:!0,isPlain:!0},r().createElement(L.CardHeader,null,r().createElement(G.J,null,r().createElement(q.default,{className:"ins-c-report-details__icon"})),r().createElement("strong",null,"Additional info")),r().createElement(B.CardBody,null,r().createElement(K(),{template:t,definitions:c}))))))))};const oe=ce;function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,j.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}ce.propTypes={more_info:v().string.isRequired,resolution:v().string.isRequired,objects:v().arrayOf({kind:v().string,uid:v().string}),extra_data:v().shape({check_name:v().string.isRequired,check_url:v().string.isRequired}),namespaceName:v().string.isRequired,reason:v().string.isRequired};var me=function(e){var t=e.workload,n=e.namespaceName,l=(0,Y.useDispatch)(),i=t.isError,s=t.isUninitialized,c=t.isFetching,o=t.isSuccess,u=t.data,d=(null==u?void 0:u.recommendations)||[],m=i,p=o,f=p&&0===d.length,E=(0,a.useState)(!1),g=(0,P.Z)(E,2),h=g[0],v=g[1],y=(0,a.useState)([]),O=(0,P.Z)(y,2),w=O[0],N=O[1],q=(0,a.useState)(!0),M=(0,P.Z)(q,2),F=M[0],A=M[1],B=(0,a.useState)([]),L=(0,P.Z)(B,2),U=L[0],V=L[1],z=(0,a.useState)(!1),H=(0,P.Z)(z,2),W=H[0],G=H[1],J=(0,a.useState)(!1),K=(0,P.Z)(J,2),Q=K[0],ee=K[1],ne=(0,a.useState)(!0),ae=(0,P.Z)(ne,2),re=ae[0],le=ae[1],ie=s||c||!W,se=(0,k.useLocation)().search,ce=(0,Y.useSelector)((function(e){return e.filters.workloadsRecsListState})),ue=0===w.length,me=function(e){return l((0,$.cH)(e))};(0,a.useEffect)((function(){N(ge(d,ce))}),[u,ce]),(0,a.useEffect)((function(){V(Ee(w,ce.sortIndex,ce.sortDirection)),ee((0,te.wW)(ce)),G(!0)}),[w]);var pe=(0,Z.PL)(ce,(function(e,t){le(!1),(0,te.sI)(ce,me,e,t)}));(0,a.useEffect)((function(){if(se&&F){var e=(0,X.yG)(se);if(e.sort){var t=(0,X.Lg)(e.sort);e.sortIndex=Z.Db.indexOf(t.description),e.sortDirection=t.direction}e.total_risk&&!Array.isArray(e.total_risk)&&(e.total_risk=["".concat(e.total_risk)]),me(de(de({},ce),e))}A(!1)}),[]),(0,a.useEffect)((function(){F||(0,X.aM)(ce,Z.Db)}),[ce,F]);var fe,Ee=function(e,t,n){var a=(0,te.ke)(t,n,e);return(0,te.l8)(a,re)},ge=function(e,t){G(!1);var a=(0,te.wW)(t),l=new Set(U.filter((function(e){return null==e?void 0:e.isOpen})).map((function(e){var t;return null==e||null===(t=e.rule)||void 0===t?void 0:t.details})));return e.filter((function(e){return!a||(0,te.y4)(e,t)})).map((function(e,t){return[{rule:e,isOpen:h||(null==l?void 0:l.has(null==e?void 0:e.details)),cells:[{title:e.details},{title:r().createElement("div",{key:t},r().createElement(R.Z,{value:e.total_risk,rest:{isCompact:!0}}))},{title:e.objects.length},{title:r().createElement("div",{key:t},r().createElement(b.Z,{date:e.modified,type:"relative"}))}]},{cells:[{title:r().createElement(oe,{more_info:e.more_info,resolution:e.resolution,objects:e.objects,namespaceName:n,reason:e.reason,extra_data:e.extra_data})}],fullWidth:!0}]}))},be={showDeleteButton:Q,deleteTitle:"Reset filters",filters:(fe=de({},ce),delete fe.sortIndex,delete fe.sortDirection,(0,te.lM)(fe,Z.Oq)),onDelete:function(e,t,n){n?(0,$.aw)(ce,$.J2,me):t.map((function(e){var t,n=(0,j.Z)({},e.urlParam,Array.isArray(ce[e.urlParam])?ce[e.urlParam].filter((function(t){return String(t)!==String(e.chips[0].value)})):"");n[e.urlParam].length>0?me(de(de({},ce),n)):(t=e.urlParam,(0,te.p5)(ce,me,t))}))}};return r().createElement("div",{id:"workload-recs-list-table"},r().createElement(_.Z,{filterConfig:{items:pe,isDisabled:ie||m||f||0===d.length},pagination:r().createElement("span",{className:"pf-u-font-weight-bold"},1===(null==w?void 0:w.length)?"".concat(w.length," Recommendation"):"".concat(w.length," Recommendations")),activeFiltersConfig:ie||m||f||0===d.length?void 0:be}),r().createElement(C.i,{"aria-label":"Workload recommendations table",ouiaId:"workload-recommendations",cells:Z.x2,ouiaSafe:!ie,onCollapse:function(e,t,n){void 0===t?(v(n),V(U.map((function(e){return de(de({},e),Object.hasOwn(e,"parent")?null:{isOpen:n})})))):V(U.map((function(e,a){return a===t?de(de({},e),{},{isOpen:n}):e})))},rows:m||ie||f||ue?[{fullWidth:!0,cells:[{props:{colSpan:Z.x2.length+1},title:m?r().createElement(x.fe,null):ie?r().createElement(T.Z,null):ue?r().createElement(x.Be,null):r().createElement(x.So,null)}]}]:p?U:r().createElement(x.Te,null),variant:I.TableVariant.compact,isStickyHeader:!0,canCollapseAll:!0,sortBy:{index:ce.sortIndex,direction:ce.sortDirection},onSort:function(e,t,n){G(!1),le(!1),me(de(de({},ce),{},{sortIndex:t,sortDirection:n}))}},r().createElement(S.x,null),r().createElement(D.R,null)))};const pe=me;me.propTypes={workload:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,isError:v().bool.isRequired,isSuccess:v().bool.isRequired,error:v().object,data:v().shape({namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string,recommendations:v().arrayOf(v().shape({check:v().string,description:v().string,objects:v().arrayOf(v().shape({kind:v().string,uid:v().string})),remediation:v().string}))})}),namespaceName:v().string.isRequired};var fe=function(e){var t,n,a=e.workload,d=e.namespaceId,m=e.clusterId;return r().createElement(r().Fragment,null,r().createElement(l.Z,{className:"pf-m-light ins-inventory-detail"},r().createElement(i.k,{direction:{default:"column"}},r().createElement(s.B,null,r().createElement(u.Z,{current:"ok"===(null==a||null===(t=a.data)||void 0===t?void 0:t.status)?"".concat(a.data.cluster.display_name," | ").concat(a.data.namespace.name):"".concat(m," | ").concat(d),workloads:"true"}),r().createElement(w,null)))),r().createElement(c.NP,null,r().createElement(o.Dx,{className:"pf-u-mb-lg",headingLevel:"h3",size:"2xl"},"Recommendations"),r().createElement(pe,{workload:a,namespaceName:null==a||null===(n=a.data)||void 0===n||null===(n=n.namespace)||void 0===n?void 0:n.name})))};fe.propTypes={clusterId:v().string.isRequired,namespaceId:v().string.isRequired,workload:v().shape({isUninitialized:v().bool.isRequired,isFetching:v().bool.isRequired,data:v().shape({namespace:v().shape({uuid:v().string,name:v().string}),cluster:v().shape({uuid:v().string,display_name:v().string}),status:v().string})})};var Ee=n(55140);const ge=function(){var e=(0,Ee.Z)(),t=(0,k.useParams)(),n=t.namespaceId,l=t.clusterId,i=(0,O.k0)({namespaceId:n,clusterId:l});return(0,a.useEffect)((function(){i.refetch()}),[n,l]),(0,a.useEffect)((function(){var t,a,r,s="".concat("ok"===(null==i||null===(t=i.data)||void 0===t?void 0:t.status)?"".concat(null==i||null===(a=i.data)||void 0===a?void 0:a.cluster.display_name," | ").concat(null==i||null===(r=i.data)||void 0===r?void 0:r.namespace.name," - Workloads"):"".concat(l," | ").concat(n," - Workloads"));e.updateDocumentTitle("".concat(s," - OCP Advisor | Red Hat Insights"))}),[i,n,l]),r().createElement(fe,{workload:i,namespaceId:n,clusterId:l})}},73845:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});var a=n(28416),r=n.n(a),l=n(24561),i=function(){return r().createElement(l.ZP,{height:20},r().createElement("rect",{x:"0",y:"0",rx:"4",ry:"4",width:"300",height:"20"}))}},70347:()=>{},71644:()=>{},24620:()=>{},82014:()=>{},25238:()=>{},92084:()=>{},53336:()=>{},314:()=>{},38299:()=>{},72816:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Workload.76f0fb4e4550b930af0847cf48e7226c.js.map